<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
<div id="TOC">
<h3>Table of Contents</h3>
<ul>
<li><a href="#geosonix-users-manual">Geosonix User’s Manual</a><ul>
<li><a href="#version-and-licensing">Version and Licensing</a></li>
<li><a href="#contact-information">Contact Information</a></li>
<li><a href="#quick-introduction-to-geosonix">Quick Introduction to Geosonix</a><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#geosonix-concepts">Geosonix Concepts</a></li>
</ul></li>
<li><a href="#user-interface">User Interface</a><ul>
<li><a href="#score-objects">Score Objects</a></li>
<li><a href="#inspector">The Inspector</a></li>
<li><a href="#inspector-object-properties-tab">Inspector Object Properties Tab</a><ul>
<li><a href="#trigger-properties-in-the-inspector">Trigger Properties in the Inspector</a></li>
<li><a href="#curve-properties-in-the-inspector">Curve Properties in the Inspector</a></li>
<li><a href="#cursor-properties-in-the-inspector">Cursor Properties in the Inspector</a></li>
<li><a href="#note-and-harmony-properties">Note and Harmony Properties</a></li>
</ul></li>
<li><a href="#inspector-scripts-tab">Inspector Scripts Tab</a></li>
<li><a href="#inspector-message-monitor-tab">Inspector Message Monitor Tab</a></li>
<li><a href="#the-transport">The Transport</a></li>
<li><a href="#using-the-toolbar">Using The Toolbar</a><ul>
<li><a href="#adding-objects-to-the-score">Adding Objects to the Score</a></li>
<li><a href="#filtering-the-selection-of-objects">Filtering the Selection of Objects</a></li>
<li><a href="#playing-selected-objects">Playing Selected Objects</a></li>
<li><a href="#grid-control-toolbar-buttons">Grid Control Toolbar Buttons</a></li>
<li><a href="#pan-and-rotate-toolbar-buttons">Pan and Rotate Toolbar Buttons</a></li>
<li><a href="#label-and-id-toolbar-buttons">Label and ID Toolbar Buttons</a></li>
<li><a href="#inspector-or-transport-hiding-toolbar-buttons">Inspector or Transport Hiding Toolbar Buttons</a></li>
<li><a href="#full-screen-mode">Full Screen Mode</a></li>
<li><a href="#help-tool">Help Tool</a></li>
</ul></li>
<li><a href="#mouse-and-keyboard-shortcuts-in-the-graphics-view">Mouse and Keyboard Shortcuts In the Graphics View</a></li>
</ul></li>
<li><a href="#in-depth-topics">In-Depth Topics</a><ul>
<li><a href="#time-durations-and-speeds">Time, Durations and Speeds</a><ul>
<li><a href="#set-the-global-speed-of-the-score">Set the Global Speed of the Score</a></li>
<li><a href="#set-the-local-speed-of-a-cursor-in-proportion-to-the-master-speed-of-the-score">Set the Local Speed of a Cursor in Proportion to the Master Speed of the Score</a></li>
<li><a href="#set-the-duration-of-a-cursor-traversing-its-curve">Set the Duration of a Cursor Traversing its Curve</a></li>
<li><a href="#define-a-pattern-of-speeds-for-successive-cycles-of-a-cursor">Define a Pattern of Speeds for Successive Cycles of a Cursor</a></li>
<li><a href="#define-the-number-times-a-cursor-should-cycle">Define the Number Times a Cursor Should Cycle</a></li>
<li><a href="#sync-time-to-midi-master">Sync Time To MIDI Master</a></li>
</ul></li>
<li><a href="#sending-midi-messages">Sending MIDI Messages</a></li>
<li><a href="#the-rhythm-processor">The Rhythm Processor</a><ul>
<li><a href="#message-functions">Message Functions</a></li>
<li><a href="#predefined-message-functions">Predefined Message Functions</a></li>
<li><a href="#automessage-interval">Automessage Interval</a></li>
<li><a href="#beat-points-on-curves">Beat Points on Curves</a></li>
<li><a href="#the-active-beats-field">The Active Beats Field</a></li>
<li><a href="#the-beat-strength-field">The Beat Strength Field</a></li>
<li><a href="#object-time-lag">Object Time Lag</a></li>
<li><a href="#attaching-a-trigger-to-a-beat-point">Attaching A Trigger to a Beat Point</a></li>
<li><a href="#object-midi-port-channel-note-and-controller">Object MIDI Port, Channel, Note and Controller</a></li>
<li><a href="#cursor-speeds">Cursor Speeds</a></li>
<li><a href="#the-structure-of-message-functions">The Structure of Message Functions</a></li>
<li><a href="#detecting-the-first-message-or-a-repeat-message">Detecting The First Message or a Repeat Message</a></li>
</ul></li>
<li><a href="#the-harmony-processor">The Harmony Processor</a><ul>
<li><a href="#harmony-properties">Harmony Properties</a></li>
<li><a href="#values-of-harmony-properties">Values of Harmony Properties</a></li>
<li><a href="#the-mapharmony-function">The mapHarmony Function</a></li>
<li><a href="#using-harmony-properties-in-scripts">Using Harmony Properties in Scripts</a></li>
<li><a href="#setting-the-score-and-object-harmony-properties">Setting the Score and Object Harmony Properties</a></li>
<li><a href="#moving-through-chord-progressions">Moving Through Chord Progressions</a></li>
<li><a href="#scripting-arpeggiators">Scripting Arpeggiators</a></li>
</ul></li>
<li><a href="#curve-drawing">Curve Drawing</a><ul>
<li><a href="#draw-a-path-of-line-segments">Draw a Path of Line Segments</a></li>
<li><a href="#draw-a-path-of-lines-with-curved-corners">Draw a Path of Lines With Curved Corners</a></li>
<li><a href="#draw-a-path-of-bezier-curves">Draw a Path of Bezier Curves</a></li>
<li><a href="#draw-a-path-from-text">Draw a Path From Text</a></li>
<li><a href="#resize-a-curve">Resize a Curve</a></li>
<li><a href="#format-a-curve-as-a-broken-line-with-dashes-and-spaces">Format a Curve as a Broken Line with Dashes and Spaces</a></li>
<li><a href="#set-the-thickness-of-a-curve-or-cursor">Set the Thickness of a Curve or Cursor</a></li>
<li><a href="#animation">Animation</a></li>
</ul></li>
<li><a href="#object-colors">Object Colors</a><ul>
<li><a href="#colors-in-the-property-inspector">Colors in the Property Inspector</a></li>
<li><a href="#setting-colors-with-scripting">Setting Colors With Scripting</a></li>
<li><a href="#registering-new-named-colors">Registering New Named Colors</a></li>
</ul></li>
<li><a href="#assigning-images-to-objects">Assigning Images to Objects</a><ul>
<li><a href="#registering-and-naming-an-image">Registering and Naming an Image</a></li>
<li><a href="#assigning-a-named-image-to-a-trigger">Assigning a Named Image to a Trigger</a></li>
</ul></li>
</ul></li>
<li><a href="#geosonics-scripting">Geosonics Scripting</a><ul>
<li><a href="#introduction-to-scripting">Introduction to Scripting</a></li>
<li><a href="#the-script-editor">The Script Editor</a></li>
<li><a href="#the-script-runtime-environment">The Script Runtime Environment</a></li>
<li><a href="#more-on-the-script-editor">More on The Script Editor</a></li>
<li><a href="#using-object-ids-in-scripting">Using Object IDs in Scripting</a></li>
<li><a href="#special-id-codes">Special ID Codes</a></li>
<li><a href="#score-objects-as-javascript-objects">Score Objects as Javascript Objects</a></li>
<li><a href="#score-callbacks">Score Callbacks</a></li>
</ul></li>
<li><a href="#scripting-commands">Scripting Commands</a><ul>
<li><a href="#obj">_obj</a></li>
<li><a href="#score">_score</a></li>
<li><a href="#this">this</a></li>
<li><a href="#setactive">setActive</a></li>
<li><a href="#setactivebeats">setActiveBeats</a></li>
<li><a href="#addcursor">addCursor</a></li>
<li><a href="#addcurve">addCurve</a></li>
<li><a href="#addellipse">addEllipse</a></li>
<li><a href="#addtrigger">addTrigger</a></li>
<li><a href="#setautobeatinterval">setAutoBeatInterval</a></li>
<li><a href="#setpopuplabel">setPopupLabel</a></li>
<li><a href="#autosize">autoSize</a></li>
<li><a href="#setbackground">setBackground</a></li>
<li><a href="#setbeatemphasis">setBeatEmphasis</a></li>
<li><a href="#setbeatinterval">setBeatInterval</a></li>
<li><a href="#setbeatpoints">setBeatPoints</a></li>
<li><a href="#setbeattrigger">setBeatTrigger</a></li>
<li><a href="#setbpm">setBPM</a></li>
<li><a href="#center">center</a></li>
<li><a href="#setchord">setChord</a></li>
<li><a href="#clear">clear</a></li>
<li><a href="#clearselection">clearSelection</a></li>
<li><a href="#setcolor">setColor</a></li>
<li><a href="#setcolor01">setColor01</a></li>
<li><a href="#setcoloractive">setColorActive</a></li>
<li><a href="#setcoloractivecurve">setColorActiveCurve</a></li>
<li><a href="#setcoloractivehue">setColorActiveHue</a></li>
<li><a href="#setcolorhue">setColorHue</a></li>
<li><a href="#constrain">constrain</a></li>
<li><a href="#setcursorheight">setCursorHeight</a></li>
<li><a href="#setcursorwidth">setCursorWidth</a></li>
<li><a href="#setcurve">setCurve</a></li>
<li><a href="#setcurvesize">setCurveSize</a></li>
<li><a href="#setcycles">setCycles</a></li>
<li><a href="#dist">dist</a></li>
<li><a href="#setduration">setDuration</a></li>
<li><a href="#setgroup">setGroup</a></li>
<li><a href="#sethidden">setHidden</a></li>
<li><a href="#sethideinactive">setHideInactive</a></li>
<li><a href="#setimage">setImage</a></li>
<li><a href="#setimageactive">setImageActive</a></li>
<li><a href="#setimageactivecurve">setImageActiveCurve</a></li>
<li><a href="#invert">invert</a></li>
<li><a href="#itoa">itoa</a></li>
<li><a href="#setlabel">setLabel</a></li>
<li><a href="#setline">setLine</a></li>
<li><a href="#setlinethickness">setLineThickness</a></li>
<li><a href="#map">map</a></li>
<li><a href="#maplist">mapList</a></li>
<li><a href="#mapchord">mapChord</a></li>
<li><a href="#mapharmony">mapHarmony</a></li>
<li><a href="#setmapnotesto">setMapNotesTo</a></li>
<li><a href="#mapscale">mapScale</a></li>
<li><a href="#mappingnotes">mappingNotes</a></li>
<li><a href="#midi.note">midi.note</a></li>
<li><a href="#midi.noteon">midi.noteOn</a></li>
<li><a href="#midi.cc">midi.cc</a></li>
<li><a href="#midi.cc01">midi.cc01</a></li>
<li><a href="#midi.bend">midi.bend</a></li>
<li><a href="#midi.bend01">midi.bend01</a></li>
<li><a href="#midi.programchange">midi.programchange</a></li>
<li><a href="#midi.channelpressure">midi.channelpressure</a></li>
<li><a href="#midi.channelpressure01">midi.channelpressure01</a></li>
<li><a href="#midi.aftertouch">midi.aftertouch</a></li>
<li><a href="#midi.aftertouch01">midi.aftertouch01</a></li>
<li><a href="#midi.system">midi.system</a></li>
<li><a href="#setmidiport">setMidiPort</a></li>
<li><a href="#setmidinote">setMidiNote</a></li>
<li><a href="#setmidicontroller">setMidiController</a></li>
<li><a href="#setmidichannel">setMidiChannel</a></li>
<li><a href="#osc.newmsg">osc.newMsg</a></li>
<li><a href="#osc.addstring">osc.addString</a></li>
<li><a href="#osc.addfloat">osc.addFloat</a></li>
<li><a href="#osc.msgsend">osc.msgSend</a></li>
<li><a href="#monitor">monitor</a></li>
<li><a href="#nearestinlist">nearestInList</a></li>
<li><a href="#nearestinscale">nearestInScale</a></li>
<li><a href="#newscore">newScore</a></li>
<li><a href="#norm">norm</a></li>
<li><a href="#setorigin">setOrigin</a></li>
<li><a href="#setpattern">setPattern</a></li>
<li><a href="#play">play</a></li>
<li><a href="#plot">plot</a></li>
<li><a href="#plotpolar">plotPolar</a></li>
<li><a href="#setpointat">setPointAt</a></li>
<li><a href="#setpointbezierat">setPointBezierAt</a></li>
<li><a href="#setpointsellipse">setPointsEllipse</a></li>
<li><a href="#setpointstxt">setPointsTxt</a></li>
<li><a href="#setposition">setPosition</a></li>
<li><a href="#print">print</a></li>
<li><a href="#random">random</a></li>
<li><a href="#rnd">_rnd</a></li>
<li><a href="#randomchoose">randomChoose</a></li>
<li><a href="#range">range</a></li>
<li><a href="#rangemid">rangeMid</a></li>
<li><a href="#registercolor">registerColor</a></li>
<li><a href="#registercolorhue">registerColorHue</a></li>
<li><a href="#registerimage">registerImage</a></li>
<li><a href="#remove">remove</a></li>
<li><a href="#reverse">reverse</a></li>
<li><a href="#rewind">rewind</a></li>
<li><a href="#rotate">rotate</a></li>
<li><a href="#setscorespeed">setScoreSpeed</a></li>
<li><a href="#setrange">setRange</a></li>
<li><a href="#setrangelow">setRangeLow</a></li>
<li><a href="#setroot">setRoot</a></li>
<li><a href="#setscale">setScale</a></li>
<li><a href="#setsmoothpointat">setSmoothPointAt</a></li>
<li><a href="#setspeedmultiplier">setSpeedMultiplier</a></li>
<li><a href="#stop">stop</a></li>
<li><a href="#settimelagmultiplier">setTimeLagMultiplier</a></li>
<li><a href="#settimelagnoteticks">setTimeLagNoteTicks</a></li>
<li><a href="#settonic">setTonic</a></li>
<li><a href="#settriggersize">setTriggerSize</a></li>
<li><a href="#settriggersync">setTriggerSync</a></li>
<li><a href="#zoom">zoom</a></li>
<li><a href="#math-functions">Math Functions</a><ul>
<li><a href="#abs">abs</a></li>
<li><a href="#acos">acos</a></li>
<li><a href="#asin">asin</a></li>
<li><a href="#atan">atan</a></li>
<li><a href="#atan2">atan2</a></li>
<li><a href="#ceil">ceil</a></li>
<li><a href="#cos">cos</a></li>
<li><a href="#exp">exp</a></li>
<li><a href="#floor">floor</a></li>
<li><a href="#log">log</a></li>
<li><a href="#min">min</a></li>
<li><a href="#max">max</a></li>
<li><a href="#pow">pow</a></li>
<li><a href="#radians">radians</a></li>
<li><a href="#round">round</a></li>
<li><a href="#sin">sin</a></li>
<li><a href="#sqrt">sqrt</a></li>
<li><a href="#sq">sq</a></li>
<li><a href="#tan">tan</a></li>
<li><a href="#degrees">degrees</a></li>
</ul></li>
</ul></li>
<li><a href="#object-properties-and-methods">Object Properties and Methods</a><ul>
<li><a href="#properties-shared-by-triggers-curves-and-cursors">Properties Shared by Triggers, Curves and Cursors</a></li>
<li><a href="#methods-shared-by-triggers-curves-and-cursors">Methods Shared by Triggers, Curves and Cursors</a></li>
<li><a href="#properties-of-trigger-objects">Properties of Trigger Objects</a></li>
<li><a href="#properties-curve-objects">Properties Curve Objects</a></li>
<li><a href="#methods-of-curve-objects">Methods of Curve Objects</a></li>
<li><a href="#properties-of-cursor-objects">Properties of Cursor Objects</a></li>
<li><a href="#properties-of-the-score">Properties of the Score</a></li>
<li><a href="#methods-of-the-score">Methods of the Score</a></li>
</ul></li>
<li><a href="#licenses-and-copyrights">Licenses and Copyrights</a><ul>
<li><a href="#geosonix-license">Geosonix License</a></li>
<li><a href="#iannix">IanniX</a></li>
<li><a href="#qscintilla-license">QScintilla License</a></li>
<li><a href="#rtmidi-license">RtMidi License</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<h1 id="geosonix-users-manual">Geosonix User’s Manual</h1>
<h3 id="version-and-licensing">Version and Licensing</h3>
<ul>
<li>Document Version: May 6, 2016 for Geosonix 2.91</li>
<li>Geosonix Licensing: <a href="#licenses-and-copyrights">Licenses and Copyrights</a></li>
</ul>
<h2 id="contact-information">Contact Information</h2>
<p>If you have questions or comments contact: geosonix@gmail.com A Geosonix forum will soon be available.</p>
<h2 id="quick-introduction-to-geosonix">Quick Introduction to Geosonix</h2>
<p><img src="../Common/img/Rosette.jpg" alt="Rosette" style="float:right;width:60%;margin:10 0px 40px 0"> <img src="../Common/img/Henon Map.jpg" alt="Henon Map" style="float:right;width:60%;margin:10 0px 40px 0"> <img src="../Common/img/Moving Object on Jazz Image.jpg" alt="Moving Object on Jazz Image" style="float:right;width:60%;margin:10 0px 40px 0"> <img src="../Common/img/Non-Rhythmic.jpg" alt="Non-Rhythmic" style="float:right;width:60%;margin:10 0px 0px 0"></p>
<p>GeoSonix is a graphical open-source music generator, non-traditional sequencer, and live performance environment.</p>
<p>At right are few of the many sample scores included with Geosonix.</p>
<p>Fast Tour of Geosonix:</p>
<ul>
<li>Use Geosonix to create, play, and perform graphical <strong>Scores</strong>.</li>
<li>Geosonix makes sound by sending MIDI or Open Sound Control messages to exteral software or hardware synthesizers.</li>
<li>A Geosonix composition is called a <strong>Score</strong>. It’s made up of objects called <strong>Curves</strong>, <strong>Cursors</strong> and <strong>Triggers</strong>.<br />
</li>
<li>Playing a score animates the objects, which interact and perform based on their properties, sometimes causing them to be <strong>triggered</strong>.</li>
<li>A <strong>triggered</strong> object calls a Javascript <strong>Message Function</strong> defined in the <strong>Script Editor</strong>.</li>
<li>You don’t have to write your own <strong>Message Functions</strong>. Geosonix auto-creates some very useful ones to get you started, and there are more in the many sample scores.</li>
<li>Message functions can do almost anything but often they send a MIDI or OSC message.</li>
<li>There is a <strong>Patchbay</strong> to route messages from Geosonix <strong>virtual ports</strong> to MIDI or OSC ports on your computer</li>
<li>There is a <strong>Property Inspector</strong> to edit object properties even as a score is playing.</li>
<li>There is a powerful built in a Javascript editor to view and edit <em>Message Functions</em> and other scripts, even as a score is playing.</li>
<li>The <strong>script editor</strong> includes context sensitive help for all Geosonix keywords. Put the cursor on a word and press F1.</li>
<li>You decide how object’s state is mapped into messages (e.g. x position might be mapped to MIDI note number and y to note velocity).</li>
<li>You can add a <strong>Background Image</strong> to the score. Properties of the image such as The pixel color behind an object at a given moment become available for use in message functions. e.g. The color might determine a MIDI note: red for pitch, green for velocity and blue for duration.</li>
<li>When you press the Play button in the <strong>Transport</strong>, objects in the score move and interact according to their properties. <strong>Collisions</strong> cause objects to be <strong>Triggered</strong> calling their message functions to send MIDI or OSC messages.<br />
</li>
<li>Objects can send <strong>autoMessages</strong> at a regular interval synced to the tempo. e.g. One message per quarter note.</li>
<li>You can “play” a score while it’s running: e.g. Change object properties, move objects in the score, change message functions, or drag in new images from anywhere on your system.</li>
<li>You can also control anything in Geosonix with an external MIDI or OSC controller. e.g. The 3D gestural <em>Leap Motion Controller</em>.</li>
</ul>
<div style="clear:both;">

</div>
<h3 id="installation">Installation</h3>
<p>GX2 is compatible with Mac OS X 10.6+ or higher (and in the future, Windows 7 though 10).</p>
<p>To install on a Mac:</p>
<ul>
<li>Download and open the Geosonix.dmg file from <em>here</em>.</li>
<li>Drag the Geosonix application into your Applications folder.</li>
<li>Double click the application to run it.</li>
<li>If you wish to keep it in the Dock right click on it and choose “Options - Keep in Dock”.</li>
<li>The first time you run Geosonix it will create a “GX Scores” folder in Documents directory.<br />
This will be the place where by default Geosonix stores score files.</li>
<li>Geosonix will also copy a few sample scores to the folder although many more are available in the Geosonix documentation and in the online score library.</li>
</ul>
<h3 id="geosonix-concepts">Geosonix Concepts</h3>
<p><strong>The Geosonix User Interface</strong> is much like other desktop applications:</p>
<ul>
<li>A main workspace where you view, build, modify, scores.</li>
<li>A File menu with commands such as <em>New</em>, <em>Open</em>, <em>Open Recent</em>, <em>Save</em>, <em>Save-As</em> and <em>Close</em>.</li>
<li>An Edit menu with commands such as <em>Cut</em>, <em>Copy</em>, <em>Paste</em>, <em>Duplicate</em>, <em>Undo</em>, and <em>Redo</em>.</li>
<li>A toolbar with buttons for creating and working with objects and the score.</li>
<li>A property inspector to the left of the workspace to view and edit properties of selected objects in the score.</li>
<li>A transport at the bottom of the Geosonix window is a transport control with controls to start, stop, rewind and change the playing speed of the score.</li>
</ul>
<p><strong>The Workspace</strong> is a 2D or 3D arrangment of the objects such as curves, cursors and triggers in the graphical view of the score application. The score file contains a snapshot of the objects and their properties that were in the graphical view when the score file was last saved.</p>
<p><strong>The Script</strong> is Javascript code in the script tab of the property inspector. A script can consist few or many lines of code which may include few or many function definitions - almost any type of Javascript code. The Script tab is not only a place to see scripts - it’s a syntax highlighting code editor. In the Script editor you can execute all or any part of the script. When you execute script code you will immediately see the results, possibly in the graphics view, or as response text below the editor.</p>
<p><strong>Geosonix Score Files</strong>:</p>
<ul>
<li>All Geosonix scores are saved in files of type “.score”.</li>
<li>Multiple scores can be open at a time and you can switch among them with tabs above the workspace.</li>
<li>Open scores do not interact in any way and one score can be playing at a time.</li>
<li>A .score file saves the location and properties of all objects in the score, the global properties of the score, and the script that is in the script tab.</li>
<li>By default the script is <em>evaluated</em> when a score is loaded. This causes any functions it contains to become defined in the global Javascript contex making them available to to the Geosoninx score playing engine.</li>
<li>You can prevent the script from being evaluated each time the score is loaded by entering \\noexec as the first line of the script.</li>
<li>Any commands that are <strong>not</strong> in functions are executed immediately on loading. This is useful, but be careful as it can change the workspace from the score was saved. For example if there is a clear() command in the script the entire score can appear blank when reloaded! More about this later.</li>
</ul>
<p><strong>Messages:</strong> Messages are generated by interactions among graphical objects. For example a cursor colliding with triggers can generate messages based on features like the location of the collision, which objects participated in the collision, the time of the collision, and the colors of the image pixel behind the collision point. Typical MIDI messages would be note-ons and note-offs, bend and continuous controllers. A typical OSC message may include score parameters such as the score time and the x, y, and z coordinates of a moving cursor.</p>
<p><strong>Generating Sound:</strong> Geosonix does not generate sound. Its messages are designed to trigger sound or effects in other audio applications or synthesizers. Message values such as MIDI note numbers, velocities and durations may be generated as a function of the parameters of the “score context” at the exact moment the message is generated. This provides an extremely rich source of sound patterns that you are unlikely to hear from any conventional sequencer. You define the messages and what aspects the score context they depend on, mapped using Javascript functions and code, and route them to an external music environment or synthesizer to generate sound.</p>
<p><strong>The GeoSonix Scripting Language:</strong> The scripting language is standard Javascript and includes large number of predefined functions and objects with which you can define the messages sent by objects, customize object behavior, and modify or build scores. The advantage of using a script to build a score is that you can automate steps that would be tedious by hand, difficult to coordinate the relationships between the parts, or build different versions based on changes in a few parameters. You can parameterize scripts so that you can easily explore variations on an idea without having to make careful manual modifications to copies of scores.</p>
<p><strong>Messages Are Javascript Functions:</strong> You can build almost all of a score without scripting, but a script functions must be used to define object messages. Messages are the way that objects make anything happen, musically such as playing notes, or graphically such as changing or moving other objects. One of the properties of an object is the name of a Javascript function that it calls when it’s triggered to send a message. Message functions are defined just like other Javascript functions in the script buffer with normal syntax (unlike GX1 which had a custom language for defining messages).</p>
<p>A advantage of messages as functions is that they can related to one or more objects by being named in each object as its message function. Multiple objects can share the same function making it much easier than in GX1 (and Iannix) to maintain consistent object behavior, and much easier to edit message functions while the score is playing, for example as way of experimenting with ideas and as a performance technique.</p>
<p>Another advantage of messages being real Javascript is that they can do far more, far more easily - almost anything you can do in Javascript. Yet another advantage of the new design is that all messages share the same execution environment, and the same environment as the script that may have built the score, opening up the potential for interaction among them that was exxtrememly difficult or impossible in GX1. For example the message of one object can access or alter properties of other objects, or alter shared properties that alter the behavior of an entire group of objects.</p>
<p><strong>The Script Editor:</strong> The editor is a syntax highlighting Javascript editor that is tightly integrated into the rest of Geosonix. It’s also what programmers would call a <em>REPL:</em> A read-evaluate-print-loop. This is a place where a you can type Geosonix commands, evaluate them, and immediately see any text output printed in a scrollable area below the editor.</p>
<p>You don’t have to execute all the script code every time. It can be executed a line at a time, a range of selected code, any single function, or the entire script. here are buttons just below the editor to execute these types of code blocks and keyboard shortcuts to quickly execute code as you write it. Button names include reminders of the keyboard shortcuts. The script is also auto executed when a score file is loaded.</p>
<p>The editor a great way to learn scripting or explore new Geosonix commands because evaluating a command will also immediately affect the score itself. You can enter commands and execute them one at a time, and immediately see the results. For example if you type a command to add or delete an object and execute that line, the object will instantly appear in the Score.</p>
<p>If you execute a command to print some object property the result will appear as as text in the output buffer below the script editor. Also, if you add a line to a message function, when the score plays the function will print the value of the property in the output area each time the object is <em>Triggered</em>. This is very useful for testing.</p>
<p>Another advantage of the REPL is that one or a more lines of script can be written and executed repeatedly to do complex things that would be a lot of work to do manually. If you have created useful fragments of script, they get saved with the score file and are available next time you open the score. The REPL is also great for debugging. Having live script editing with all of Javascript and all Geosonix objects and scripting commands at your fingertips allows you to enter diagnostics such as print statements to write intermediate results to the output buffer to see what’s happening, and immediately change it as needed. In the future a complete Javascript debugger may be available.</p>
<p>Finally, the REPL can allow Geosonix to be used as a live performance or “Live Coding” performance environment. For more on Live Coding look it up in Wikipedia or see the Toplap web site.</p>
<p><strong>Geosonix Scores as Performance Instruments:</strong> A Geosonix score is not just something where you press the play button and passively listen. You can alter scores as they play through the Geosonix user interface or though through external MIDI or OSC controllers such as Leap Motion, Microsoft Kinect, Monome, Ableton Push and many others. The output of a score may sound rich and complex, but it’s completely deterministic to its layout and inputs, and varying the inputs in real time can instantly vary the outputs in very interesting ways, not unlike playing a convertional musical instrument. You can in effect treat any given score as an instrument and with a little practise “play” or improvise on it for fun or in a performance.</p>
<h2 id="user-interface">User Interface</h2>
<!-- ![](../Common/img/Geosonixui2.png) -->
<p><img src="../Common/img/GeosonixUI.jpg" alt="Geosonix" style="float:right;width:100%;margin:0 0px 10px 0"></p>
<p>Features of the Geosonix window, starting at the upper left and moving clockwise:</p>
<ul>
<li>The <strong>Toolbar</strong> at the top of the window: From the left, there are four buttons for creating objects (triggers, and several types of curves); three buttons for filtering the types of object that can be selected in the workspace; one button for causing only selected objects to send messages; nine buttons for controlling the view and how you interact with it (more on this later); and one button on the far right for calling up the web based documentation. All the buttons have Tooltips indicating their use. In many cases the Tooltips also give a keyboard shortcut for the same command.</li>
<li><p>The <strong>Main Workspace</strong> below the toolbar on the right: Where you view, add, and interact with score objects. The workspace has a coordinate system and normally appears 2D but in fact is 3D. You can rotate it to see its three dimensional nature if you click on the 3D button in the toolbar and drag on the score background. You can rotate it in 3D. Double click on the background to return to a flat view and click the 3D button again to turn off 3D rotation mode. In fact you can do most of what’s interesting in Geosonix just working in 2 dimensions but the 3D nature of the workspace is there if you need it.</p>
<p>The above image shows three Triggers, four Curves and four Cursors, one on each curve. One of the curves is <em>selected</em>, which can be seen from the yellow <em>marquee</em> around it.</p>
There are tabs at the top of the Main Workspace, one tab for each score that is currently open. Multiple scores can be open and do not interact in any way. They have private versions of almost all score parameters, the score objects are separate, and each has its own Javascript environment. Only one score can be playing at a time, and if you switch tabs the score you left stops playing but retains all its information so it resumes in the same place if you press Play when you switch back to that tab.</li>
<li>The <strong>Transport</strong> is on the bottom edge of the window: The controls from left to right are: buttons to rewind and start or stop the score playing; a readout of the current time; a field to enter the playing speed in beats per minute and to move the speed up and down a little at a time; a field to enter the time signature; a menu to enable sync via MIDI Time Clock with an external master. Below the sync menu is a field that shows the update rate of the master clock in milliseconds and below it a field that shows the display refresh rate in frames per second. The more heavily loaded that Geosonix is, the higher the master clock refresh interval and the slower the frame rate. Below these two fields is a button that opens a menu with options to sync Geosonix’s clock to an external midi master using either midi clock or midi time code.</li>
<li>The green <strong>“G”</strong> at the far right at the bottom opens the Geosonix splash screen showing the version number and licensing information.</li>
<li><p>The <strong>Inspector</strong> occupies the left side of the Geosonix window. See below for a detailed description of the Inspector.</p></li>
</ul>
<div style="clear:both;">

</div>
<p>The <strong>Menu Bar</strong> on a Macintosh is:</p>
<p><img src="../Common/img/MenuBar.png" alt="MenuBar" style="float:left;width:50%;margin:0 10px 10px 0"></p>
<div style="clear:both;">

</div>
<p>In addition to the Geosonix app menu there is a <strong>File</strong> menu and <strong>Edit</strong> menu which are similar to those of many other applications you will have used and will be mostly self explanatory. The File menu also includes commands for loading an image file as a background image for the score, clearing the background image, and opening the default folder where score files are stored on your system. The File menu also includes a command to open the Patchbay, which is discussed below.</p>
<p>The <strong>Edit</strong> menu includes a command that copies the Javascript code to clipboard that would be required to reconstruct the object or objects selected in the score. If you paste this in the script editor it will be useful in understanding the necessary commands to create an object and set its non default properties. However this feature is a work in progress so you may find not all necessary commands are created, or the commands that are created are redundant. This will be improved in the future.</p>
<p>The <strong>Display</strong> and <strong>Playback</strong> menus mostly duplicate toolbar buttons or transport buttons so you will rarely use them. The equivalent commands will be discussed in the toolbar and transport documentation. You may find it useful to look in these menus for reminder of the keyboard shortcuts of some useful commands. They are:</p>
<ul>
<li>Toggle Full Screen Mode: Command+Option+f</li>
<li>Toggle Transport Visibility: t</li>
<li>Toggle Snap to Grid mode: Shift+g</li>
<li>Zoom In: +</li>
<li>Zoom Out: -</li>
<li>Return to 100% Zoom: =</li>
<li>Toggle Transport Play/Pause: Spacebar</li>
<li>Rewind Transport to time zero: r</li>
</ul>
<p>All these commands require the input focus to be on the score view, not the property inspector or script editor, otherwise they would be taken as text input. If necessary click on the score background or some object in the score to set the input focus to the score.</p>
<p><img src="../Common/img/patchbay.png" alt="Patchbay" style="float:right;width:50%;margin:0 0px 0px 0"></p>
<p>The <strong>Patchbay</strong> can be opened from the <em>File Edit-Patchbay</em> menu. It allows you to map the virtual port names, such as <em>vMidi1</em> used in messages to actual ports on your system. This allows you to change the MIDI or OSC address where a score’s messages are sent without without having to edit all messages in the score. It also lets you write scores that can be reused with different synths or on different system without having to change to the script. There is more about the Patchbay in section on scripting.</p>
<div style="clear:both;">

</div>
<h3 id="score-objects">Score Objects</h3>
<p>Scores are made up of three types of objects that can be added to the main workspace with toolbar buttons or with scripting commands. Every score object is assigned a unique id when it is created, integers ranging from 1 to 32767. IDs are not usually needed when creating scores with toolbar tools as IDs are assigned antomatically. However IDs are the way you uniquely refer to objects in scripts.</p>
<p><img src="../Common/img/Three Object Types.jpg" alt="Three Object Types" style="float:right;width:40%;margin:0 50px 0px 20"></p>
<p>Examples of Four Curves, Four Cursors and Three Triggers:</p>
<div style="clear:both;">

</div>
<ul>
<li><p><strong>Curves</strong> are lines in 2D or 3D space which can be circles, ellipses, curves made of straight line segments, curves made of curved segments (Bezier curves), and freeform curves. Curves may also have <strong>Beat Points</strong> defined on them which are shown as small tick marks across the curve. See the rightmost curve in the image below. When the curve’s cursor collides with a beat points it triggers the curve’s message function. Beat points may defined to be be at regular intervals along the curve or in patterns causing messages to be triggered at rhythmic intervals (e.g. Euclidean rhythms) as the cursor moves over them at a steady rate.</p></li>
<li><p><strong>Cursors</strong> are straight line segments attached to and perpendicular their curve. Cursors move along their curve, usually at a steady rate, when the score is played. Their velocity is propertional to the speed the score is playing based on a multiplier which is a property of that cursor. The cursor speed property can be used to mek it move faster or slower than the rate set by the score. A cursor on a curve with beat points is assigned a note type that defines its speed with respect to the score speed in beats per minute. For example if a quarter-note is assigned the cursor will encounter its curve’s beat points at the rate of quarter notes in terms of the master transport beats per minute. A curve can have only one cursor. (This may be increased in the future).</p></li>
<li><p><strong>Triggers</strong> are points in 2D or 3D space usually shown on the score as a small blue circle centered on the point although the appearance can be redefined. The most basic use of triggers is that they can trigger messages when collided with by a cursor. Unlike curve beat points which can only be triggered by that curve’s cursors, triggers can be triggered by a cursor of any curve. Triggers can also be “snapped” onto the beat points of a curve allowing them to be dragged or reshaped as a group by dragging or reshaping the curve. However even when snapped to some curve, triggers can still be triggered by collisions from the cursors of any curve.</p></li>
</ul>
<p>Note that in Geosonix we use the term “trigger” in two ways. First, a <strong>Trigger</strong> is a type of score object. Second, we say that some object has been <strong>triggered</strong> when some event has caused its message function to be called. In this sense any object can be triggered. For example when when a cursor collides with a curve beat point, or when any type of object calls its <em>AutoMessage</em> function, we also say it has been triggered.</p>
<h3 id="inspector">The Inspector</h3>
<p>The Inspector has three tabbed panels:</p>
<ul>
<li><p>The <strong>Object Properties Tab</strong> for viewing and editing the properties of score objects. The top part of the Property Inspector varies depending on the type of object currently selected: Trigger, Cursor or Curve. All fields are visible all the time, but fields that are not relevant to any selected object are greyed out and cannot be edited.</p>
<p>Note that it is usually advisable to ensure that only one type of object is selected at a time when properties are being edited. If necessary this can be accomplished using the selection filtering tools in the toolbar.</p>
<p>The bottom part of the Object Properties tab which is separated by some space from the top section is for editing note and harmony properties that either apply to the entire score or are the same for all types of objects. This section is the same no matter which type of objects are selected in the score.</p>
See below for more details on the Object Properties tab.</li>
<li>The <strong>Script Tab</strong> containing the script editor and other tools for interacting with scripts. See below for more details.</li>
<li><p>The <strong>Message Monitor Tab</strong> for real time monitoring of MIDI and OSC messages sent and received by Geosonix.</p></li>
</ul>
<h3 id="inspector-object-properties-tab">Inspector Object Properties Tab</h3>
<p>All property fields for all types of objects are always visible in the Properties Tab and always stay in the same place. Fields not applicable to any objects selected in the score are inactive and greyed. Once you learn what a field does and where it is you can count on it being where you remember, and if it’s not greyed you know it’s applicable to some selected object.</p>
<p>Having all the fields always visible is also very convenient when you are experimenting, improvising or performing with playing scores. Everything you need (except for the script editor which is in the next tab) is at your fingertips in the properties tab.</p>
<p>I’ve tried hard to give the fields titles that are self explanatory, and all fields have ToolTips with more information. You should be able to quickly get to the stage where you almost never need to refer to the documentation.</p>
<p>The fields are organized into related groups separated by horizontal dividers.</p>
<p>The top of the Object Properties Tab shows the type of object or objects selected in the score and the id of what we call the <em>Focus Object</em>. If you’ve only selected one object then this is the <em>Focus Object</em>. If you’ve selected multiple objects then the <em>Focus Object</em> is the first one you selected.</p>
<p>The Object Properties dialog shows just the properties of the <em>Focus Object</em> even if multiple objects are selected. However any property fields relevant to any type of selected object are active (ungreyed). If you change some property it’s applied to <strong>all selected objects</strong> that support that property. When editing properties be careful to only have selected objects that you really want to change, although you can back out of undesired changes with undo. To use undo on score objects, the focus cannot be on the property inspector. Click on the score background before trying to undoing (or redoing) property edits.</p>
<p>In most cases when changing properties it’s a good idea to have either a single object selected, or only one type of object selected at a time (e.g. just triggers or just curves). However there are legitimate reasons to select a mixture of object types to set some property such as when you want to assign them all to the same group, or give them all the same color.</p>
<p>At the top of the property inspector are counts of the number of currently selected objects or each type. This can be useful in confirming what’s in the selection.</p>
<p>
<h4 id="trigger-properties-in-the-inspector">Trigger Properties in the Inspector</h4>
<p><img src="../Common/img/inspector-trigger.jpg" alt="Inspector-Trigger" style="float:right;width:400px;margin:0 10px 10px 0"></p>
<p>When a Trigger is selected in the score you can edit trigger properties in top part of the Property Inspector tab. These include:</p>
<p><strong>Properties of All Objects</strong></p>
<ul>
<li><strong>Object ID</strong>: Integer from 1 to 32767 that uniquely identifies this object.</li>
<li><strong>Enable</strong> checkbox: Enable or disable the object from sending messages or colliding with other objects.</li>
<li><strong>Hide</strong> checkbox: Hide and show the object</li>
<li><strong>Group Name</strong>: Name of the group this object belongs to. Assign it to a different group by typing in a new name. If the group did not previously exist it will be created. Click on the down arrow for a list of all defined groups. Click on the name of a group in the list to select all objects in that group.</li>
<li><strong>Label</strong>: Text to display next to the object in the score. You can shown or hide the labels with the “Abc” toolbar button.</li>
<li><strong>Time Lag</strong>: See <a href="#the-rhythm-processor">The Rhythm Processor</a>.</li>
</ul>
<p><strong>Trigger Position and Appearance Properties</strong></p>
<ul>
<li><strong>Position</strong> in terms of the x, y, and z coordinates.</li>
<li><strong>Trigger Size</strong>: diameter</li>
<li><strong>Color to use when the trigger is active</strong> (i.e. enabled)</li>
<li><strong>Color to use when the trigger is inactive</strong> (i.e. not enabled)</li>
</ul>
<p><strong>Trigger Message Functions</strong></p>
<ul>
<li>See <a href="#message-functions">Message Functions</a>.</li>
</ul>
<p><strong>Trigger Automessage Interval</strong></p>
<ul>
<li>See <a href="#automessage-interval">Automessage Interval</a>.</li>
</ul>
<p><strong>Trigger Sync to Beat</strong></p>
<ul>
<li>This field is at the lower right next to the cursor speed properties. Triggers normally generate a message instantly when collided with by a cursor. If <strong>Trigger Sync to Beat</strong> is changed from Off to some note-value, trigger messages are delayed until the next even multiple of that beat with respect to the score time. See <a href="#the-rhythm-processor">The Rhythm Processor</a> for more details.</li>
</ul>
<p>
<h4 id="curve-properties-in-the-inspector">Curve Properties in the Inspector</h4>
<p><img src="../Common/img/inspector-curve.jpg" alt="Inspector-Curve" style="float:right;width:400px;margin:0 10px 10px 0"></p>
<p><strong>Properties of All Objects</strong></p>
<ul>
<li><strong>Object ID</strong>: Integer from 1 to 32767 that uniquely identifies this object.</li>
<li><strong>Enable</strong> checkbox: Enable or disable the object from sending messages or colliding with other objects.</li>
<li><strong>Hide</strong> checkbox: Hide and show the object</li>
<li><strong>Group Name</strong>: Name of the group this object belongs to. Assign it to a different group by typing in a new name. If the group did not previously exist it will be created. Click on the down arrow for a list of all defined groups. Click on the name of a group in the list to select all objects in that group.</li>
<li><strong>Label</strong>: Text to display next to the object in the score. You can show or hide the labels with the “Abc” toolbar button.</li>
<li><strong>Time Lag</strong>: See <a href="#the-rhythm-processor">The Rhythm Processor</a>.</li>
</ul>
<p><strong>Curve Position and Appearance Properties</strong></p>
<ul>
<li><strong>Position</strong> in terms of the x, y, and z coordinates. For an ellipse or circle this is the center. For segmented curves this usually the position of the first point. More generally the position of a curve is the point with respect to which the locations of its points are defined. For curves created with scripts the position may not correspond to any point on the curve.</li>
<li><strong>Curve Size</strong>: width and height. Can be used to re-size an existing curve.</li>
<li><strong>Curve Thickness</strong>: the thickness of the line</li>
<li>Cursor properties are also also available when a curve is selected because it’s usually easier to select a curve than a moving cursor. However see <a href="#cursor-properties-in-the-inspector">Cursor Properties in the Inspector</a> for cursor properties.</li>
<li><strong>Color to use when the curve is active</strong> (i.e. enabled)</li>
<li><strong>Color to use when the curve is inactive</strong> (i.e. not enabled)</li>
</ul>
<p><strong>Curve Message Functions</strong></p>
<ul>
<li>See <a href="#message-functions">Message Functions</a>.</li>
</ul>
<p><strong>Curve Automessage Interval</strong></p>
<ul>
<li>See <a href="#automessage-interval">Automessage Interval</a>.</li>
</ul>
<p><strong>Curve Beat Point Properties</strong></p>
<ul>
<li>See <a href="#beat-points-on-curves">Beat Points on Curves</a>.</li>
</ul>
<p><strong>Cursor Motion Properties</strong></p>
<p>These cursor properties are enabled when a cursor’s curve is selected because it’s often easier to select a curve than a moving cursor.</p>
<ul>
<li><strong>Cycle Speeds</strong></li>
<li><strong>Cycles</strong></li>
<li><strong>Cursor Speed</strong></li>
<li><strong>Duration</strong></li>
<li><strong>Lock Duration</strong></li>
</ul>
<p>For all these see <a href="#time-durations-and-speeds">Time, Durations and Speeds</a>.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="cursor-properties-in-the-inspector">Cursor Properties in the Inspector</h4>
<p><img src="../Common/img/inspector-cursor.jpg" alt="Inspector-Cursor" style="float:right;width:400px;margin:0 10px 10px 0"></p>
<p><strong>Properties of All Objects</strong></p>
<ul>
<li><strong>Object ID</strong>: Integer from 1 to 32767 that uniquely identifies this object.</li>
<li><strong>Enable</strong> checkbox: Enable or disable the object from sending messages or colliding with other objects.</li>
<li><strong>Hide</strong> checkbox: Hide and show the object</li>
<li><strong>Group Name</strong>: Name of the group this object belongs to. Assign it to a different group by typing in a new name. If the group did not previously exist it will be created. Click on the down arrow for a list of all defined groups. Click on the name of a group in the list to select all objects in that group.</li>
<li><strong>Label</strong>: Text to display next to the object in the score. You can shown or hide the labels with the “Abc” toolbar button.</li>
<li><strong>Time Lag</strong>: See <a href="#the-rhythm-processor">The Rhythm Processor</a>.</li>
</ul>
<p><strong>Cursor Position and Appearance Properties</strong></p>
<ul>
<li>Positioning options are not available because cursors are positioned with respect to their curve.</li>
<li><strong>Cursor Size</strong>: The length of the cursor. The length of the left and right side of the cursor can be set separately.</li>
<li><strong>Cursor Thickness</strong>: The thickness of the cursor line</li>
<li><strong>Color to use when the cursor is active</strong> (i.e. enabled)</li>
<li><strong>Color to use when the cursor is inactive</strong> (i.e. not enabled)</li>
</ul>
<p><strong>Cursor Message Functions</strong></p>
<ul>
<li>See <a href="#message-functions">Message Functions</a>.</li>
</ul>
<p><strong>Cursor Automessage Interval</strong></p>
<ul>
<li>See <a href="#automessage-interval">Automessage Interval</a>.</li>
</ul>
<p><strong>Cursor Motion Properties</strong></p>
<ul>
<li><strong>Cycle Speeds</strong></li>
<li><strong>Cycles</strong></li>
<li><strong>Cursor Speed</strong></li>
<li><strong>Duration</strong></li>
<li><strong>Lock Duration</strong></li>
</ul>
<p>For all these see <a href="#time-durations-and-speeds">Time, Durations and Speeds</a>.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="note-and-harmony-properties">Note and Harmony Properties</h4>
<p><img src="../Common/img/inspector-bottom.jpg" alt="Inspector-Bottom" style="float:right;width:400px;margin:0 10px 10px 0"></p>
<p>The bottom of the Object Properties tab shows Note and Harmony properties for the entire score and is visible even if no objects are selected. When an object is selected in the graphics view, the note harmony properties for that object are revealed above the score properties.</p>
<p>The names of the properties for the score and all objects are the same. They are the <em>Tonic</em> and <em>Scale Name</em> of the current scale, and the <em>Root</em> and <em>Chord Name</em> of the current chord. Below these is the range of notes to generate in terms of the <em>Lowest Note</em> and size of the <em>Range in Semitones</em>. There is also the “Map Notes To” property (called mapNotesTo in scripting) which determines whether note mapping should be into notes from the current scale or the current chord. All notes that are in the chord/scale, and that fall anywhere in the <em>Range in Semitones</em>, are available for mapping. i.e. If the range is more than an octave the chord or scale will be repeated as needed up to the top of the range.</p>
<p>By default objects inherit the equivalent score properties. This can be overridden for any object and any property. i.e. If an object’s message function uses an <strong>Object Harmony</strong> property that reads “Score” in the Property Inspector (or -1 in the case of Range), then the value of that property for <strong>Score Harmony</strong> is returned. All object harmony properties default to “Score”, so by default objects generate notes and harmony compatible with the score and with each other. In effect, this means that objects inherit the harmony properties of the score.</p>
<p>You can override the score properties for one or more objects by entering one or more specfic harmony properties. A use might be to force some objects to play different ranges of notes from others. Or you may set some objects to play chords and others to play notes from a scale compatible with the chords as is done in jazz improvisation.</p>
<p>See <a href="#the-harmony-processor">The Harmony Processor</a> for information on using all these fields to control harmony.</p>
<p>At the bottom of the Properties Tab are some fields with some useful general information:</p>
<ul>
<li>The x, y position of the mouse as it moves over the score.</li>
<li>Two fields giving the color of the pixel under the mouse pointer in terms of RGB and in terms of HSV color systems.</li>
</ul>
<p>This information can be helpful in writing message functions and understanding how message functions respond to the score.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h3 id="inspector-scripts-tab">Inspector Scripts Tab</h3>
<p><img src="../Common/img/Script Editor.png" alt="Script Tab" style="float:right;width:320px;margin:0px 10px 10px 0"></p>
<p>The script editor is in the Script tab of the property inspector. The main parts of the editor are:</p>
<ul>
<li>The actual editor is the large area with white-background that occupies most of the space. We also call the contents of the editor the <em>Script Buffer</em> because it contains the entire script for this score. In this example the script is just one trigger message function called triggerMessage. The editor highlights Javascript syntax making it easier understand the parts of the script.</li>
<li>Below the editor near the bottom is the <em>Output Area</em> which in this case contains “ok” which is the result of successfully evaluating the script that produced no other text output.</li>
<li>Below the output area are some buttons:
<ul>
<li>The <strong>Selection</strong> button evaluates exactly what is selected in the editor (i.e. what is highlighted) even just part of a line.</li>
<li>The <strong>Line</strong> button evaluates the entire line containing the text cursor</li>
<li>The <strong>Function</strong> button evaluates the entire function containing the text cursor. Note that this does not <strong>call</strong> the function. What it does is take the text definition in the editor and update the function definition in the live Javascript buffer.</li>
<li>The <strong>All</strong> button evaluates the entire script buffer.</li>
<li>The <strong>Clear Output</strong> button clears the output area.</li>
<li>The <strong>Stop Script</strong> button forces a script to stop. You should almost never need to use the stop script button unless you create and evaluate something like an infinite loop.</li>
</ul></li>
<li><p>Lines of the script that are too wide are wrapped to multiple lines. At the end of each wrapped lines is an arrow symbol showing that it continues on the next line. Even when a line of code has wrapped it’s still treated as a single line in Javascript.</p></li>
<li>Sometimes you may want to see lines unwrapped to appear on a single lines. You can widen the editor (and the entire Property Inspector) by dragging the right boundary with the mouse.<br />
</li>
<li><p>The graphical workspace shrinks as the inspector is widened but all objects in the view also shrink to remain visible and in proportion. Depending on what you are doing you may want to work with the editor larger and the view smaller, or adjust the boundary as needed while you work.</p></li>
</ul>
</p>
<div style="clear:both;">

</div>
<p>
<h3 id="inspector-message-monitor-tab">Inspector Message Monitor Tab</h3>
<p><img src="../Common/img/message-monitor.jpg" alt="Inspector-Message-Monitor" style="float:right;width:320px;margin:0 10px 10px 0"></p>
<p>This tab is where you can see MIDI or OSC messages that have been sent and received by Geosonix.</p>
<p>Note that by default message monitoring is turned off as it adds an significant load to your system. Therefore turn on monitoring with the <strong>Enable Logging</strong> checkbox when you need to see the flow of messages and be sure to turn it off again when you no longer need it.</p>
<p>Both lists scroll and have a capacity of the most recent 10000 messages. You can clear either list by clicking in the list and selecting all the text with Command + A and pressing the delete key on your keyboard. (When I have time I’ll add a button to clear each list.)</p>
<p>Also, although it’s not related to message monitoring there is a field at the bottom of this tab to set the Open Sound Control input port. This is the port you use to send messages to Geosonix on localhost or to your computer’s IP address over your LAN. If you use OSC you probably already know how to use this, but there will eventually be a tutorial on using OSC with more detail.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h3 id="the-transport">The Transport</h3>
<p><img src="../Common/img/transport.png" alt="Transport" style="width:500 px;margin:0 10px 10px 0"></p>
<p>The Transport controls starting and stopping the score playing, rewinding, showing the current playing time, setting the playing speed, and synchronizing Geosonix with an external clock using either MIDI Clock or MIDI Time Code. You should find this self explanatory if you’ve any used any other music sequencer or workstation.</p>
<p>Time is measured in beats, and playing speed is measured in beats per minute. Objects have internal rates that are synchronized to the master score rate. There are two ways to synch an cursor’s clock to to the master clock:</p>
<ul>
<li><p>If a cursor is on a curve that has not beat points defined, you can set a property called the <em>Cursor Speed</em>, which is a multiplier applied to the master rate. For example a multiplier of 0.5 causes the cursor to move at have the master rate, and a multiplier of 3.5 causes the cursor to move at 3.5 times the master rate. This type of synchronization is mostly useful for non rhythmic or ambient music.</p></li>
<li><p>If a cursor is on a curve with beat points defined then you set the rate by specifying the type of note one beat refers to. For example a curve might have 32 beat points, but in one case the cursor could be defined to synched to quarter notes at the master rate, and in another case the cursor might be assigned to by 1/16 notes, causing the cursor to run much faster.</p></li>
</ul>
<p>Another type of sync to the transport is <em>AutoMessages</em> which all types of objects can be set to generate. When enabled they are spontaneously generated at a regular interval whenever the score is playing. Similar to curve beat points, the interval for an object’s <em>AutoMessage</em> is set as a note duration such as a quarter note or a sixteenth note triplet.</p>
<p>This design allows objects to generate messages, all synchronized to the master clock even as the master rate changes, and the timing of the beats is synchronized across all objects.</p>
<p>It’s also possible to set any object’s internal timing to lead or lag the master clock by any multiple of a given note type. A simple example would be if you set two objects to generate messages (that play notes) at quarter note intervals, but then set one of them to lag by two quarter note triplets. This in effect gives a swing rhythm.</p>
<p>Many unusual effects are possible by mixing and matching these settings across a number of objects. It’s also possible to change any of these settings on the fly either manually or based on varying score properties as the score plays, and the results can be very interesting!</p>
</p>
<div style="clear:both;">

</div>
<h3 id="using-the-toolbar">Using The Toolbar</h3>
<p>
<h4 id="adding-objects-to-the-score">Adding Objects to the Score</h4>
<p><img src="../Common/img/Adding objects to the score.png" alt="Adding objects to the score" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
<p>From left to right the buttons to add objects are:</p>
<ul>
<li>The <strong>Add Trigger</strong> button: Click the toolbar button, then click on the score where you want to put the trigger.<br />
You can also double click on the button lock it down, allowing you to click repeatedly in the score to add multiple triggers. Click the button again to release it or press the Esc key.</li>
<li>The <strong>Add Ellipse</strong> button: Click the toolbar button, then mouse-down on the score where you want to put the ellipse and before releasing the mouse button drag to size the ellipse. If you click and release, a small ellipse is added that you can resize later. You can also double click the Add Ellipse button lock it down. In this mode you can add any number of small ellipses that you can resize later. Click the button again to release it or press the Esc key. A cursor will automatically be added to the curve.</li>
<li>The <strong>Draw Bezier Curve</strong> button: Click the button and then click at location in the score where you want to add points of this Bezier curve. You can also click and drag to draw a freehand curve. You can end drawing the curve in one of three ways: click the toolbar button again; or press the Esc key, or double click instead of clicking on the last desired point. A cursor will automatically be added to the curve.</li>
<li>The <strong>Draw Straight Line Curve</strong> button: Click the toolbar button and click on the score where you want the first point of the curve. Then repeatedly move the mouse and click to add each additional point. The point where you click will be connected by straight lines. You can end drawing the curve in one of three ways: click the toolbar button again; or press the Esc key, or double click instead of clicking on the last desired point. A cursor will automatically be added to the curve.</li>
</ul>
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="filtering-the-selection-of-objects">Filtering the Selection of Objects</h4>
<p><img src="../Common/img/Filtering the Selection of Objects.png" alt="Filtering the Selection of Objects" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
<p>These are the <strong>Filter Selection</strong> buttons. There is one for triggers, one for curves and one for cursors. But first an introduction to selecting objects:</p>
<p>When we talk of selecting an object in the score we mean clicking on it or dragging to encompass one or more objects with the selection rectangle. Selected objects are marked with a yellow rectangle that we call the <em>marquee</em>. Of course the reason we want to select an object is that this causes its properties to be visible in the property inspector. You can also mouse-down and drag on one of any number of selected objects, which moves them in the score. There is also a toolbar button that causes only selected object to send messages. More on this below.</p>
<p>You can add to the selection by Command-Clicking on each successive object, or by Command-Dragging to encompass more objects. Shift-Clicking on an object removes it from the selection. You can select all objects in the score by pressing Command+a on the keyboard.</p>
<p>By default all types of objects can be selected. It’s sometimes useful especially when selecting with the marquee to prevent some types of objects from being selected, for example if you just want to move a some triggers, or to rename their message function. Another use is dragging a marquee that selects cursors but not their curves. Selecting specific types of objects is the purpose of the selection filtering toolbar buttons.</p>
<p>By default no selection filtering buttons are pressed and in this mode you can select any type of object (triggers, curves and cursors).</p>
<p>When one or more of the selection filtering buttons are clicked to toggle them down (they become darker), only those types of objects can be selected and others are ignored. For example if you click the button with a picture of a trigger on it, only triggers can be selected. You can even use the Command+a shortcut to select all object in the score and in this case just triggers will be selected.</p>
<p>To return to being able to select all types of object, click on any “pressed” (darkened) buttons to toggle them off.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="playing-selected-objects">Playing Selected Objects</h4>
<p><img src="../Common/img/Playing Selected Objects.png" alt="Playing Selected Objects" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
<p>The <strong>Play Selected</strong> button is normally not pressed. When you click it to toggle it down, only selected objects are able to send messages of any kind. If a score is playing and you click this button with no objects selected the score will stop sending notes or any other type of MIDI or OSC messages. If you select some object it will be able send messages and you will hear it, assuming that its messages are sending MIDI notes. Any number of objects can be selected in this mode and all selected objects will be able to send messages and the others will be muted.</p>
<p>You will find the <em>Play Selected</em> button very useful for understanding what scores are doing. It can also be used in performance or improvisation. For example you may create a score where multiple objects would be sending messages, but then only play one or a few of them at a time in various groups to achieve variations in the performance.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="grid-control-toolbar-buttons">Grid Control Toolbar Buttons</h4>
<p><img src="../Common/img/GridTools.png" alt="Grid Tools" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
<p>The <strong>Grid Tool</strong> contains the image of a grid. Click on it to hide the grid. Click it again to reveal it.</p>
<p>You can also change the grid spacing with the <em>Grid setup</em> command in the Display menu. For historical reasons the units of grid spacing are time with the default spacing being “1 second”. Time time does not have a lot of meaning in the current version of Geosonix, but you can still use the commands to adjust the relative spacing. For example choose “500” milliseconds to have a spacing twice as close as the default.</p>
The <strong>Snap to Grid Tool</strong> enables snap to grid mode where the mouse operations on objects are constrained to conform to be aligned to the grid. Click on the grid tool to exit snap to grid mode. You can tell you are in snap to grid mode when the button appears pressed (darker).
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="pan-and-rotate-toolbar-buttons">Pan and Rotate Toolbar Buttons</h4>
<p><img src="../Common/img/ViewAdjustTools.png" alt="View Adjust Tools" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
<p>The <em>Pan Tool</em> looks like a hand. Clicking the Hand Tool allows you to pan the score left/right and up/down in the view by dragging with the mouse anywhere in the score. Click the Hand Tool again to return to normal mouse operations on the score.</p>
<p>Using the Hand Tool is equivalent to holding down the Shift key and dragging with the mouse.</p>
<p>The <strong>3D Rotate Tool</strong> which contains “3D”, allows you to rotate the score about the x axis and y axis to see the score tilted into the z dimension. Drag up/down to rotate about the x axis and dragging left/right to rotate about the y axis. While in this mode you can return the view to flat by double clicking on the score background.</p>
<p>Using the 3D Rotate Tool is equivalent to holding down the Command+Shift keys and dragging with the mouse. As with the tool you can restore the view to flat Command+Shift double click on the score background.</p>
<p>Note that while the is not flat <strong>you cannot select or drag object in the score</strong>. This means that having the view rotated is mainly for viewing and not for interacting with. Possilbly 3D interaction will be added in a future version of Geoxsonix.</p>
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="label-and-id-toolbar-buttons">Label and ID Toolbar Buttons</h4>
<p><img src="../Common/img/HideShowTagsTools.png" alt="HideShowTagsTools" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
<p>The icon of the <strong>Object ID Tool</strong> is “ID”. Clicking on it shows tags above each object with the ID of the object. The IDs are displayed in the color of the object. Click the button again to hide the IDs.</p>
<p>The icon of the <strong>Text Labels Tool</strong> icon is “Abc”. Click on it to reveal the text label (if any) above each object in the score. Labels are displayed in the color of the object. Click again to hide the labels. By default no objects have labels so you will only see labels if you have added them with the Object Label field in the property inspector, or with a script.</p>
</p>
<div style="clear:both;">

</div>
<p>It can be very useful to assign labels in the script especially for information that changes in message functions or script callbacks from Geosonix. For example the following is a trigger message function that sends a note when a cursor collides with the trigger. The line “this.label = note” inserts the note number in the label:</p>
<p>function triggerMessage() { note =mapHarmony(this.x,-16,16); //note number from x position vel = map(this.y,-12,12,20,127); //velocity from y position dur = map(this.cursor.angle,0,360,50,2500); //duration from this.label = note; //put note number in label midi.note(this.port,this.channel,note,vel,dur) }</p>
<p>Clicking the Text Labels button would now show above each trigger the trigger’s most recently sent MIDI note number.</p>
<p>
<img src="../Common/img/Note Numbers in Labels.png" alt="Note Numbers in Labels" style="float:right;height: 150px;margin:0 10px 10px 0"> The number is automatically converted to text. The labels will automatically show the number of the most recent note sent by each object. Here is how this would look in the score:
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="inspector-or-transport-hiding-toolbar-buttons">Inspector or Transport Hiding Toolbar Buttons</h4>
<p><img src="../Common/img/HideShowInspectorTransportTools.png" alt="HideShowInspectorTransportTools" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
The <strong>Hide Inspector Tool</strong> contains “i”. Click on it to hide and show the Property Inspector.<br />
The <strong>Hide Transport Tool</strong> contains “&gt;”. Click on it to hide and show the Transport.
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="full-screen-mode">Full Screen Mode</h4>
<p><img src="../Common/img/FullScreenTool.png" alt="FullScreenTool" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
The <strong>Full Screen Tool</strong> expands the graphical view of the score to fill the entire window. Leave this mode by pressing the Escape key. The ability to interact with the score in this mode is very limited so it’s currently only for viewing playing scores. Some ability to interact with the score in full screen mode may be added in the future.
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="help-tool">Help Tool</h4>
<p><img src="../Common/img/Help Button.png" alt="Help Button" style="float:left;height: 50px;margin:0 10px 10px 0"></p>
Press the <strong>Help Tool</strong> to open Geosonix online help in your default web browser. Help is currently only available online because it’s being frequently updated and improved. It’s possible that in the future offline help will also be included with Geosonix.
</p>
<div style="clear:both;">

</div>
<h3 id="mouse-and-keyboard-shortcuts-in-the-graphics-view">Mouse and Keyboard Shortcuts In the Graphics View</h3>
<ul>
<li>Click on a score object to select the object.</li>
<li>Command+Click on a score object adds object to selection.</li>
<li>Drag over objects starting on score background* selects all objects dragged over.</li>
<li>Command+Drag on the score background adds objects to selection.</li>
<li>Mouse-Wheel over score zoom the score.</li>
<li>Shift+Mouse-Wheel on score: Faster zoom.</li>
<li>Escape-Key: Cancels the selection or exits fullscreen display.</li>
<li>Shift+Drag on score background: Reposition the score in the display.</li>
<li>Command+Shift+Drag, on score background rotates or tilt the view in 3D.</li>
<li>Command+Shift+DoubleClick on score background removes all 3D rotation.</li>
<li>Command+Shift+Drag on score background rotates or tilts the view in 3D.<br />
</li>
<li>Shift+Double-Click on a curve adds a control point to the curve.</li>
<li>Shift+Double-Click on a curve control point toggles the point between Bezier and straight line.</li>
<li>Command+Shift+Double-Click on a curve control point removes the control point.</li>
<li>Command+Double-Click on a trigger or cursor sends that object’s message. (Useful for MIDI learn in an external synth)</li>
<li>Command+delete clears the score. This also works in the script editor.</li>
<li>Command+a selects all objects in the score</li>
</ul>
<h2 id="in-depth-topics">In-Depth Topics</h2>
<h3 id="time-durations-and-speeds">Time, Durations and Speeds</h3>
<h4 id="set-the-global-speed-of-the-score">Set the Global Speed of the Score</h4>
<pre><code>setBPM(bpm);</code></pre>
<p>Sets the global speed of the score in beats per minute. It some time has elapsed on the transport, it’s possible to enter aa negative score speed which will cause time (and all score activity) to run in reverse. When running in reverse the transport will stop when the time reaches zero. It’s not possible for time to become negative.</p>
<p>The score speed is combined with the speed factor or duration parameter of each cursor to determine the speed, or more intuitively the transit time of the cursor on its curve. If the cursor speed was specified in terms of a note duration per beat (if on a beat curve) then those beats are synched to the master transport. If the cursor is on a curve without beat points then its speed is specified as a multiplier times the master rate, or as a duration to travel around the curve.</p>
<p>Example:</p>
<pre><code>setBPM(120);</code></pre>
<h4 id="set-the-local-speed-of-a-cursor-in-proportion-to-the-master-speed-of-the-score">Set the Local Speed of a Cursor in Proportion to the Master Speed of the Score</h4>
<pre><code>setSpeedMultiplier(objectID, localSpeed);</code></pre>
<p>This is how cursor speed is specified if it’s not on a curve with beat points.</p>
<p>Cursors have a speed independent of each other, but that is related to the global speed. The cursor can move in the negative direction if the its speed factor is negative (and the global speed is positive).</p>
<p>Cursor speed is best understood by thinking in terms of the time duration required for a given cursor to traverse its path one time. If the master speed of the transport is set to 1.0 (with the “setScoreSpeed” command or the transport slider), and a cursor’s time is set to say 10.0 seconds, the cursor will take 10 seconds to traverse the curve once. Doubling the master speed to 2 would cut the transit time of this cursor to 5.0 seconds.Thus each cursor can have it’s own transit time (or inversely, speed), proportional to the master speed of the score.</p>
<p>This example sets the speed of cursor 9 to be five times the global speed.</p>
<pre><code>setSpeedMultiplier(9,5);</code></pre>
<h4 id="set-the-duration-of-a-cursor-traversing-its-curve">Set the Duration of a Cursor Traversing its Curve</h4>
<pre><code>setDuration(objectID, durationInSeconds);</code></pre>
<p>SetDuration automatically sets the speed of a cursor so that it will traverse its curve once in the specified amount of time. This command also automatically causes the LockDuration option to be set, which maintains the given duration even if the curve is resized by dragging its points with the mouse or with the resize command. This makes it easier for you to create scores that maintain the timing relationship between cursors on different curves even when you adjust the shape of the curves. Note that if you need to clear the LockDuration at any time, this can be done with the checkbox in the inspector, and is also automatically cleared if a different speed is directly entered into the Inspector.</p>
<p>This example sets the cursor 99 to traverse its curve in 23 seconds:</p>
<pre><code>setDuration(99, 23);</code></pre>
<h4 id="define-a-pattern-of-speeds-for-successive-cycles-of-a-cursor">Define a Pattern of Speeds for Successive Cycles of a Cursor</h4>
<pre><code>setPattern(objectID, patternString);</code></pre>
<p>This parameter is text string that is a list of numbers where each successive number provides a speed multiplier each successive cycle. (First number = first cycle, second number = second cycle, etc.)</p>
<p>As the number cycles exceeds the length of the list, the list is cycled to continue to supply numbers. For example the list “1 -1” would provide a factors of 1, -1, 1 -1 in successsion.</p>
<p>The following example sets cursor 99 with a pattern that causes the cursor to run one cycle at the normal speed, one at 0.7 times the speed, one loop at 0.5 times the speed, one loop at 0.3 times the speed, then cycling back to 1 … if needed:</p>
<pre><code>setPattern(99, &quot;1 0.7 0.5 0.3&quot;);</code></pre>
<h4 id="define-the-number-times-a-cursor-should-cycle">Define the Number Times a Cursor Should Cycle</h4>
<p>The <strong>Cycles</strong> field to the right of the Cycle Speeds field in the Inspector allows you to set how many times a cursor should loop before stopping. A value of -1 causes the cursor to run without stopping. Any other number in the range 1 .. 9999 set a limit. For example a value of 1 will cause the cursor to cycle once and stop. If there were more than one speed defined in the Cycles Speeds field, only the first would be used.</p>
<h4 id="sync-time-to-midi-master">Sync Time To MIDI Master</h4>
<p>Geosonix can be synced to a master using MIDI Clock. Click on the “Slave” menu button next to the beats per minute display. There are options to Sync to MIDI Clock and to disable sync. Geosonix automatically adjusts its internal clock even as the tempo changes. Song position pointer is also accepted so for hosts the support it Geosonix rewinds and repositions the transport based on changes in the host.</p>
<p>When Geosonix is synced its transport controls are locked. Tempo must be set on the host and the host transport must be used for start, stop and rewind.</p>
<h3 id="sending-midi-messages">Sending MIDI Messages</h3>
<p>Use methods on the predefined <strong>midi</strong> Javascript object to send midi messages. Here is a simple script that might be used in a message function to send a midi note:</p>
<pre><code>note = 60;
velocity = 100;
duration = 1000;
midi.note(this.port,this.channel,note,velocity,duration);  //Sends the message`</code></pre>
<p>This can be shortened as:</p>
<pre><code>midi.note(this.port,this.channel,60,100,1000);</code></pre>
<p>The arguments this.port and this.channel refer to the port and channel properties (in the property inspector) set for “this” object. By default this.port has the value “vMidi1” and this.channel has the value 1. You could also have entered the port and channel as their literal values as in the examples below.</p>
<p>The port property defaults to “vMidi1” which is the name of the first of the four virtual midi ports than can be defined in the patchbay. To see the Patchbay use the File-Edit Patchbay menu. In the patchbay you can define which midi ports on your system is sent to by each of the four available virtual midi ports vMidi1….vMidi4.</p>
<p>Here is an example of a midi message that sends pitch bend. It would bend all notes played on channel 1 of the port “vMidi1” slightly upward (sharp):</p>
<pre><code>midi.bend01(&quot;vMidi1&quot;, 1, 1.1); //The 1.1 is the bend.  A bend of 1.0 would be no bend.</code></pre>
<p>Here is another example that sends a pitch bend message, bending notes played on channel 1 as far as possible downward:</p>
<pre><code>midi.bend01(&quot;vMidi1&quot;, 1, -1.0);</code></pre>
<p>Most often midi messages are used in message functions as the way the function sends a MIDI message. However they can be used outside of functions. For example you might define this message somewhere in a script:</p>
<pre><code>midi.cc(&quot;vMidi1&quot;, 1, 1, 127);</code></pre>
<p>Whenever executed as a single line with Command+. this will send a midi cc 1 (mod wheel) with value 127 to channel 1 on port “vMidi1. This can be useful as a way to send a specific controller to a synth to accomplish a”MIDI learn“. In this case if the synth were put into learn mode on some parameter, say a VCO level, then when this message is sent the mod wheel controller would be assigned to that parameter.</p>
<p>Another useful one might be:</p>
<pre><code>midi.cc(&quot;vMidi1&quot;, 1, 123, 0);</code></pre>
<p>… which sends an All Notes Off message when this line is executed.</p>
<p>There are predefined functions for sending every type of MIDI message. See any of <a href="#midi.note">midi.note</a>, <a href="#midi.noteon">midi.noteOn</a>, <a href="#midi.cc">midi.cc</a>, <a href="#midi.cc01">midi.cc01</a>, <a href="#midi.bend">midi.bend</a>, <a href="#midi.bend01">midi.bend01</a>, <a href="#midi.programchange">midi.programchange</a>, <a href="#midi.channelpressure">midi.channelpressure</a>, <a href="#midi.channelpressure01">midi.channelpressure01</a>, <a href="#midi.aftertouch">midi.aftertouch</a>, <a href="#midi.aftertouch01">midi.aftertouch01</a> and <a href="#midi.system">midi.system</a> in the function reference.</p>
<p>See the scripts of of the sample scores for more examples of sending MIDI messages.</p>
<h3 id="the-rhythm-processor">The Rhythm Processor</h3>
<div id="curveautomessage">

</div>
<div id="curvemessage">

</div>
<div id="triggerautomessage">

</div>
<div id="triggermessage">

</div>
<div id="cursorautomessage">

</div>
<p>
<h4 id="message-functions">Message Functions</h4>
<img src="../Common/img/Message Functions.png" alt="Message Functions" style="float:right;width:400px;margin:0 10px 10px 0">
</p>
<p>Message functions are how the rhythm processor makes anything happen such as sending MIDI notes, sending MIDI controllers or anything else. In fact message functions can do a lot which is not really related to rhythm but we document them here because this is their most important use.</p>
<p>There are several ways objects can create “beats”, but when any beat happens, one of the object’s message functions is called in the script, if that function exists (otherwise nothing happens). What the function does can be anything you can do with Javascript and Geosonix commands. Often it sends a MIDI (or OSC) message with values mapped from on the state of the object and/or score at the moment the beat was triggered.</p>
<p>A new score’s script contains no message functions. An object might create beats in this state but nothing will happen until a message function has been defined in the script with a name that matches the message name in the object generating the messages.</p>
<p>The property inspector has places for the names of two types of message functions, one for beat or trigger messages and another for “automessages”. There are places for both so that both types of messages can be being used at the same time with functions that do different things.</p>
<p>These are the main things that make objects call message functions:</p>
<ul>
<li>All three types of objects can generate automessages.</li>
<li>Triggers generate “trigger” messages when a moving cursor collides with them.</li>
<li>Curves generate “beat” messages when a cursor moving on the curve collides with a beat point on the curve.</li>
<li>Cursors only generate automessages.</li>
</ul>
<p>There are two fields (see above image) to define message function names:</p>
<ul>
<li><strong>Beat or Trigger Messages</strong>: The name of a Javascript function called when the trigger or curve generates a “normal” message. Defining the name of the function has no effect unless there is function with this name in the script.</li>
<li><strong>Automessages</strong>: The name of a Javascript function called when this object’s automessages are triggered. Defining the name of the function has no effect unless there is function with this name in the script.</li>
</ul>
<p>The above image happens to show the message function names for a trigger, but each type of object prefixes its message functions with its type.</p>
<p>There are also two buttons next to the function names that show that function in the script, and offer to create a function if non exists yet:</p>
<ul>
<li>A <strong>Create</strong> button for the normal message function: Automatically creates a message function with this name the script editor. If a function with this name already exists it is shown in the editor.</li>
<li>A <strong>Create</strong> button for the curve Auto-Message function: Automatically creates a message function with this name the script editor. If a function with this name already exists it is shown in the editor.</li>
</ul>
<p>The auto-created funtions are quite versatile. They normally generate MIDI note messages based on the position of the object, but if an image has been added to the score background they use the colors in the image to generate the notes. Also, if you change the <a href="#object-midi-port-channel-note-and-controller">Object MIDI Port or Channel</a> the message function uses the new settings, and if you enter a non zero note into the <a href="#object-midi-port-channel-note-and-controller">note</a> field the message sends only that note, which is useful for drum programming.</p>
<p>A very important feature of message functions is that objects can share them. In fact by default all triggers call a function named <em>triggerMessage</em> when a cursor collides with them and a function called <em>triggerAutoMessage</em> for automessages. All curves call <em>curveMessage</em> when their cursor collides with a beat point, and so on. This is convenient because you often want all objects of a given type to do the same thing, and if you want to change what all objects of that type do, you only need to change one function.</p>
<p>However you are free to give some object or objects any message functions name you want and as long as you define a function with that name in the script those object will call it. This allows some objects to one thing and others to do something different.</p>
<div style="clear:both;">

</div>
<h4 id="predefined-message-functions">Predefined Message Functions</h4>
<p>Functions created with the Create button are versatile enough that you could create scores entirely without scripting. They send MIDI messages that vary based on the position of the object in the score, but if there is a background image they automatically switch to creating MIDI messages based on the colors in the image. Also they normally generate note pitches matching the current score harmony, based either on object position or background color. However if you set a non zero note number in the MIDI Object Note field the object automatically switches to sending that that note. This could be used, for example, to have each object send a different note number to a drum synthesizer, triggering different percussion instruments.</p>
<p>You can also use auto-created functions as a starting point for your own functions. You should be quickly able to learn to tweak the mappings in small but significant ways. As you learn more you will be able to be more adventurous in your changes, working up to creating your own functions.</p>
<p>See <a href="#the-structure-of-message-functions">The Structure of Message Functions</a> for a better understanding of how message functions work.</p>
<p>
<h4 id="automessage-interval">Automessage Interval</h4>
<p><img src="../Common/img/AutoMessage Intervals.png" alt="AutoMessage Intervals" style="float:right;width:400px;margin:0 10px 10px 0"></p>
<p>Each type of object has an <strong>Automessage Interval</strong> field to define how frequently it sends automessages. They can also be turned off which is the default.</p>
<p>The <strong>Automessage Interval</strong> is the interval between calls to an object’s auto message function. Calls to the function also only occur when the transport is running. Choose the interval from the popup menu, for the appropriate type of object, which are only enabled if that type of object is selected in the score. Values can range from a 384th note up to four whole notes.</p>
<p>Defining the interval in terms of a note length allows the message rate to vary with the speed the transport is running. Remember that these messages are sent by calling a function in your script with the same name as defined in the Automessages property field for this object. No messages will be sent if this function does not exist or has a different name.</p>
<p>Intervals as short as a 384th note may seem excessively short but they are useful if the beats are trigging the sending of a MIDI continuous controller or an OSC message in which case you may want very frequent messages to simulate smoothly changing values.</p>
Note that although basic automessages are sent at regular intervals it can be very interesting to script automessage intervals to change as the score plays. For an example open and play the score “Varying Intervals for AutoMessage Improvisation.score”. Unique rhythm textures can be automatically generated.
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="beat-points-on-curves">Beat Points on Curves</h4>
<p><img src="../Common/img/Curve Beat Points None.png" alt="Curve No Beat Points" style="float:right;width:50%;margin:0 10px 10px 0"> <img src="../Common/img/Curve Beat Points Normal.png" alt="Curve Beat Points - Normal" style="float:right;width:50%;margin:0 10px 10px 0"> <img src="../Common/img/Curve Beat Points Euclidean.png" alt="Curve Beat Points - Euclidean" style="float:right;width:50%;margin:0 10px 10px 0"> <img src="../Common/img/Cursor Speeds - No Beats.png" alt="Cursor Speeds" style="float:right;width:50%;margin:0 10px 10px 0"></p>
<p>Beat Points which look like small tick marks can be added to a curve with the “Curve Beat Points” drop down menu button in the property inspector. See right.</p>
<p>The menu contains three options:</p>
<ul>
<li><strong>None</strong>: which means no beat points. In this case there are no additional options to choose and the <em>Active Beats</em> and <em>Beat Strength</em> fields are inactive. Because there are no beats, the cursor runs at a rate that is independent of the transport speed, and cursor property fields are enabled to configure cursor motion: <em>Cursor Speed</em>, <em>Duration</em> and <em>Lock Duration</em>. See <a href="#time-durations-and-speeds">Time, Durations and Speeds</a>.</li>
<li><strong>Normal</strong>: Which adds beat points at regular equal intervals. In this case additional fields appear to define the number of beats around the curve, the note type defining the beat rate vs the master BPM, and the number of beats per bar. <a href="#the-active-beats-field">The Active Beats Field</a> and <a href="#the-beat-strength-field">The Beat Strength Field</a> are also made available allow you to manually define which beats are active and the relative strength of the beats.</li>
<li><strong>Euclidean</strong>: Which adds beat points at irregular intervals based on an <a href="https://charlesrthompson.com/2015/02/25/using-euclidean-rhythms-to-create-new-beat-patterns/">Euclidean rhythm</a>. In this case additional fields appear to define the number of beat positions around the curve, the note type defining the beat rate vs the master BPM as above, and also the number of active beats, an amount to optionally shift the beats, and the number of times to repeat the pattern. <a href="#the-active-beats-field">The Active Beats Field</a> is disabled because this is set by the Euclidean rhythm options, but the <a href="#the-beat-strength-field">The Beat Strength Field</a> remains available to allow you to manually enter the relative strength of the beats.</li>
</ul>
<p>If <strong>Normal</strong> or <strong>Euclidean</strong> are chosen then the cursor speed is synced to the transport speed so that the beats are synced to the master BPM. Use the <strong>Beats/Cycle</strong> field to enter the number of beat points to place on the curve. Use the <strong>Beat Interval</strong> control to choose the length of a beat from a dropdown menu with note types ranging from a 384th note to four whole notes.</p>
<p>There are two other cursor settings that are available no matter which beat point option is chosen:</p>
<ul>
<li><strong>Cycle Speed</strong>: See <a href="#define-a-pattern-of-speeds-for-successive-cycles-of-a-cursor">Define a Pattern of Speeds for Successive Cycles of a Cursor</a></li>
<li><strong>Cycles</strong>: See: <a href="#define-the-number-times-a-cursor-should-cycle">Define the Number Times a Cursor Should Cycle</a></li>
</ul>
</p>
<div style="clear:both;">

</div>
<p>Beat points can be used for a number of things:</p>
<ul>
<li><p>If a message function is defined for a curve, the message is sent each time a cursor crosses an active beat point, similar to a cursor colliding with a trigger. However the beats are synchronized to the transport and thus to the beats of other objects. For more details on active and inactive beat points, see below.</p></li>
<li><p>In curve a message function called by a beat point event you can get the number of the beat point with the “this.beatNumber” property. You can also get the total number of beat points with the “this.nBeats” property. This allows you to use a cursor’s motion along a curve to perform all sorts of sequential actions synched to the transport. The actions may be slow or fast depending on the speed of the cursor.</p>
<p>An important example of this is using a slowly moving cursor to step a score through chord changes, where the a given sequence of chords and chord root notes are stored in an array indexed by the beat number. There are several examples of this in the sample scores. For example see the score called “Chord Changer.score”.</p></li>
<li><p>Triggers can be dragged and dropped onto beat points and they remain attached to the curve even if it is dragged, resized or reshaped. Triggers that are snapped to curves act like normal triggers in other respects in that they can have messages that are sent when they are collided with by any cursor, either a cursor on their curve or a cursor on some other curve. Snapping triggers onto curves can provide a useful way of moving them around as a group or arranging them in patterns.</p></li>
</ul>
<h4 id="the-active-beats-field">The Active Beats Field</h4>
<p>The Active Beats Field is used to specify which beat marks on the curve actually trigger messages. Typical usage is to specify a usually number of beat points (say 32) and then mark some of them as active in a pattern to create a rhythm. Details:</p>
<ul>
<li><p>Enter active beats as an “x” and inactive beats as a period “.” for inactive beats, with no spaces between them. For example “x.x.” sets every second beat active. If you specified bar lines (i.e. “b 16 4”) then vertical lines are automatically entered into the active beat display at that interval. For example if the beats are “b 16 4” and you enter “.x…x..x…x..x” as active beats, when you press the “Save Changes” button, the Active Beats field will display “.x..|.x..|x…|x..x|”</p></li>
<li>Active beat tick marks are larger than inactive beats on the actual curve.</li>
<li>Active beats cause the curve’s message function to be called when the cursor collides with them and inactive beats do not.</li>
<li>If the active beats string is shorter than the number of beats specified in the “Curve Beat Pattern” field, then the active-beat string is recycled as needed.</li>
<li>When a beat point calls the curve’s message function the beat point is highlighted with the cursor color. This works best for MIDI notes in that when the note-off occurs the beat point highlighting is removed. For non-midi messages or if the curve has not message function then the tick marks remain highlighted the first time they are hit but the cursor. (Non midi message handling be improved in future versions of Geosonix).</li>
<li>The bar divisions are just a data entry guide. They have no effect on the musical results. Only the location of the beat characters actually determines which beats are active.</li>
<li><p>The on-curve tick marks of active beats are identifiable as being slightly thicker and longer than normal tick marks.</p></li>
<li><p>See <a href="#setactivebeats">setActiveBeats</a> for the scripting command to set this property.</p></li>
</ul>
<h4 id="the-beat-strength-field">The Beat Strength Field</h4>
<p>The Beat Strength Field is used to modify the velocity of midi notes produced by active beats according to some repeating pattern.</p>
<ul>
<li>Note velocity is available in a message function as the value of the “this.beat” property of the calling object, set just before the message function is called, using the current position in the cycle though this object’s list of beat strengths. The this.beat property is usually used in computing the note velocity to send to the midi.note function, possibly combined with some other method of setting the velocity such as the colors of the image background. The maximum strength beat property defaults to 127 when triggered producing a maximum velocity midi note if used without further modification. See the sample scores for examples.</li>
<li>Beat emphasis values are entered as a list of numbers each of which must be in the range of 0 to 9. A value of 9 in a position results in a velocity of 127 and a value of 0 in a position results in a velocity of zero. Intermediate values are scaled accordingly.</li>
<li>Beat emphasis values are paired sequentially with beats. All active or inactive beats are included in the pairing. If there are fewer beat emphasis values defined than the number of beat points, the beat emphasis values are recycled as needed. So in the example the “9868” pattern will repeat for the second bar and indefinitely as the beat pattern is repeated.</li>
<li>If a given beat is inactive no message is sent (as usual for an inactive beat) and that number position in the beat emphasis list is skipped.</li>
<li><p>For example suppose the curve has eight beat points and the active beats pattern is “xx.xx.xx”. So there are eight beats and all are active except for beats 3 and 6. If you enter “9868” into the Beat Emphasis field the first beat will be sent a triggered value 127, the next will be sent a value of ((8/9)<em>127), the third will not be sent because it is not active, the fourth will be sent as ((6/9)</em>127), etc.</p></li>
<li><p>See <a href="#setbeatemphasis">setBeatEmphasis</a> for the scripting commands to set this property.</p></li>
</ul>
<p>
<h4 id="object-time-lag">Object Time Lag</h4>
<p><img src="../Common/img/Fundamental Properties.png" alt="Fundamental Properties" style="float:right;width:400px;margin:0 10px 10px 0"></p>
<p>You can set the time in an object to be delayed with respect to the score time on the transport. This affects the start time of the object’s automessages and beat point messages, lagging their onset with respect to other objects in the score.</p>
<p>The object’s events will occur later than would normally have been set by the master transport.</p>
<p>The fields for time lag are:</p>
<ul>
<li>Time Lag Multiplier: The number of time lag units that time is lagged for this object. This, multiplied by the duration of</li>
<li>Time Lag Note Type: determines the amount the sending of messages is delayed. The object will not start sending messages until this amount of time has passed from the score start time.</li>
<li>Time Lag Unit Size: The note size in which time lag for this object is measured. This is entered as a note type ranging from a 384th note up to four whole notes.</li>
</ul>
<p>Among the uses for time lag are:</p>
<ul>
<li>Creating irregular and swing rhythms by having one object’s messages be lagged with respect to those of other objects. For example suppose an object is has its automessage interval set to send a note every quarter note with no time lag. If another object is also sending at quarter note intervals but lagged by two quarter note triplets the result would have the feel of a swing rhythm with respect to note that is “on” the beat.</li>
<li><p>Delaying when an object starts sending messages. Time lag can be up to 9999 times four whole notes so the delay can be very long if needed.</p></li>
<li><p>The scripting commands to set time lag are <a href="#settimelagmultiplier">setTimeLagMultiplier</a> and <a href="#settimelagnoteticks">setTimeLagNoteTicks</a>.</p></li>
</ul>
</p>
<div style="clear:both;">

</div>
<h4 id="attaching-a-trigger-to-a-beat-point">Attaching A Trigger to a Beat Point</h4>
<p>Sometimes it is useful to attach triggers to the beat points on a curve. In the score this is possible dragging and dropping them on a beat point. It is also possible to attach trigger to beat points with a script.</p>
<p>Scripting command:</p>
<pre><code>setBeatTrigger(triggerId, curveId, beatPoint);</code></pre>
<p>Sets the trigger with ID triggerID to the curve with ID curveID. The argument beatPoint give the number of the point to which it should be attached. The first point on the curve is numbered 0. Example:</p>
<pre><code>setBeatTrigger(12, 99, 5);</code></pre>
<p>Attaches trigger number 12 to point number 5 of curve number 99.</p>
<p>For a fun example of triggers snapped to a moving curve see the sample score “Pulsating Ellipse with Triggers.score”.</p>
<p>
<h4 id="object-midi-port-channel-note-and-controller">Object MIDI Port, Channel, Note and Controller</h4>
<p><img src="../Common/img/Object Port Channel Note and Controller.png" alt="Object Port Channel Note and Controller.png" style="float:right;width:400px;margin:0 10px 10px 0"> The this.port and this.channel in the messages of most sample scores refer to the “port” and “channel” fields in the property inspector (above). They enable you to write more versatile message functions by allowing different objects to use the same message function but, for example, send on different channels.</p>
<p>Similarly if you use this.port in a message function you can change the midi port it’s sending on without having to edit the message function. You could redirect that object’s messages to a synth on a different port simply by changing what’s in the Port in the property sheet, say from “vMidi1” to “vMidi3”. Other objects using that function would still be using it to send to “vMidi1”.</p>
You could also use “this.note” in place of “note” in a message function and it would switch to sending just the particular note number set in the Note field of the property sheet. This can be very useful in drum machine programming where a particular note number is a particular percucussion sound. So you could write one message function that sends percussion beats and then customize what sound it makes when called, say by different triggers, by setting a different note number in the note field of each trigger.
</p>
<div style="clear:both;">

</div>
<p>
<h4 id="cursor-speeds">Cursor Speeds</h4>
<img src="../Common/img/Cursor Speeds - No Beats.png" alt="Cursor Speeds - No Beats" style="float:right;width:400px;margin:0 10px 10px 0"> See <a href="#define-a-pattern-of-speeds-for-successive-cycles-of-a-cursor">Define a Pattern of Speeds for Successive Cycles of a Cursor</a>.
</p>
<div style="clear:both;">

</div>
<h4 id="the-structure-of-message-functions">The Structure of Message Functions</h4>
<p>This is a simple message function:</p>
<pre><code>function triggerMessage() {
    note = mapHarmony(this.cursor.x,-4,4);
    velocity = map(this.cursor.x,-4,4,50,127);
    duration = map(this.cursor.y,-4,4,100,400);
    midi.note(this.port,this.channel,note,velocity,duration)
}</code></pre>
<p>This is a function that is called whenever a cursor collides with any trigger that has “triggerMessage” defined as the name of its message function. Each time it’s called it uses this.cursor.x to fetch the x position of the cursor when it collided with the trigger and uses it in the mapHarmony function to convert the position (assumed to be in the range -4 .. 4) in the mapHarmony function to get a note compatible with the currently defined score harmony. For more on how harmony works see <a href="#the-harmony-processor">The Harmony Processor</a>.</p>
<p>In Javascript we use the “.” (dot) operator to refer a property (or method) of a object. The “this” keyword in a message function always refers to the Geosonix score object that called the function, in this case a trigger. Then using the dot operator “this.cursor” refers to the cursor that collided with the trigger this time, and the “this.cursor.x” gets the x position of the cursor. This position is then used as the first argument in mapHarmony and determines the position of the generated note within the current note range for the score, or for this object if it has a custom range defined.</p>
<p>Then the note velocity is determined, also based on the cursor x position using the “map” function to scale it from the range of -4 .. 4 to a range of 50 .. 127. If the x position were exactly -4 the velocity would be mapped to 50 (fairly quiet) and if the x position were 4 it would be mapped to 127 (fully loud). Intermediate values are proportionally mapped in between.</p>
<p>Then the note duration is determined by mapping the cursor y position (this.cursor.y) to a range of 100 to 400 milliseconds.</p>
<p>Finally a midi note is sent using the midi.note function.</p>
<p>The Javascript experts among you may be thinking that it wasn’t necessary to assign each part of the message to variables and then use the variables in the midi.note function. It would have been possible to omit the variables and write this as one big complicated statement. However, the clarity gained from this is worth the small processing cost.</p>
<p>For the even more expert among you, you may be thinking that we should declare the variables as local by putting “var” in front of each. (Because otherwise they become global, and bad things will happen!) However, it’s reasonably safe to do this here as long as we are consistent in always giving these helper variables the same name, and know never to use them for anything else. They get redefined every time a message function uses them so there isn’t much likelihood of cross contamination. I omitted the “var” here because I’ve tried to make the standard functions as uncluttered as possible.</p>
<div id="firstmessage">
<div id="repeatmessage">
<h4 id="detecting-the-first-message-or-a-repeat-message">Detecting The First Message or a Repeat Message</h4>
<p>Sometimes you need to do something in a message function the first time an object sends a message and never again. Or, sometimes you need to do something each time a cursor starts on a new cycle around its curve. You can use the following special object properties in message functions to detect these states:</p>
<ul>
<li><strong>firstMessage</strong>: Set to true the first message an object sends.</li>
<li><strong>repeatMessage</strong>: Set to true for curve or cursor objects each time the cursor on the curve starts a new cycle.</li>
</ul>
<p>For an example of using these flags with every possible type of message see sample score “Example of firstMessage and repeatMessage.score”.</p>
<p>Here is an example of one of the message functions from this example script:</p>
<pre><code>function cursorAutoMessage() {
    if (this.firstMessage)
        print(&quot;cursorAutoMessage firstMessage&quot;, this.id);
    else if (this.repeatMessage)
        print(&quot;cursorAutoMessage repeatMessage&quot;, this.id);
    note = 40;
    velocity = 100;
    duration = 100;
    print(&quot;cursor autoMessage note-on&quot;, this.id);    
    midi.note(port,channel,note,velocity,duration);
}</code></pre>
<p>Above you can see that this.firstMessage and this.repeatMessage are being used in “if” statements to carry out actions that will only happen under those conditions. The code in the if statements will be ignored otherwise leaving the message function able to perform its normal actions.</p>
<h3 id="the-harmony-processor">The Harmony Processor</h3>
<h4 id="harmony-properties">Harmony Properties</h4>
<p>At the heart of the harmony processor is a user interface to set a range of harmony-related properties globally for a score, and for objects to inherit them, but with the ability to override some or all score properties selectively in any object. The property system is then integrated into the Javascript environment allowing all sorts in interesting harmony generation and manipulation, developed purely in Javascript, also having access to properties from rhythm processor, and having final control of MIDI note and controller generation.</p>
<p>
<p><strong>Score Harmony</strong> <img src="../Common/img/Score Harmony.png" alt="Score Harmony" style="float:right;width:450px;margin:0 10px 0px 0"></p>
</p>
<div style="clear:both;">

</div>
<p>
<strong>Object Harmony</strong> <img src="../Common/img/Object Harmony.png" alt="Object Harmony" style="float:right;width:450px;margin:0 10px 0px 0">
</p>
<div style="clear:both;">

</div>
<p>The score and every object have an identical set of harmony properties:</p>
<ul>
<li><strong>Tonic</strong>: The starting note of a scale.</li>
<li><strong>Scale</strong>: The currently prevailing scale. Technically a scale is a set note offsets or intervals that define the scale relative to the tonic.</li>
<li><strong>Root</strong>: A note, usually in the current scale, that is used as the root of the chord.</li>
<li><strong>Chord</strong>: The name of the chord or scale. Technically a chord is a set note offsets or intervals that define the chord relative to the root.</li>
<li><strong>Lowest Note</strong>: A popup list of all MIDI note names and note numbers. It defines the lowest note that the <a href="#mapharmony">mapHarmony</a> function will generate be default. For example “C 2 48 means a”C&quot; note in MIDI octave 2, and MIDI note number 48.</li>
<li><strong>Range in Semitones</strong>: This is the size of the range in semitones to map into. For example a if the <strong>Lowest Note</strong> is set to 40 and <strong>Range in Semitones</strong> is set to 36, the mapHarmony function will by default map into note numbers 40 … 76.</li>
<li><strong>Map Notes To</strong>: Whether to map notes to the current Chord or Scale. May have the value “Chord” or “Scale”. If it’s an object property then it may also have the value “Score”.</li>
</ul>
<p>By default all objects inherit each of these properties from the score. You can selectively give any objects their own values that will be used in place of the score settings. The above images show the default values for all the properties. Notice that the default values for all Object Harmony properties are “Score”, or -1 for the Range property. These values cause inheritance from the score.</p>
<p>If you change any object property to something other than the default, the new value is used for that property for that object when it generates notes. Most importantly this happens in the mapHarmony script function which is used to generate notes matching a harmony from the instantaneous score state.</p>
<p>If you stay with using the property inspector user interface and auto-created object message functions which use mapHarmony, then the above is allmost all you need to know to do a lot of interesting work with the harmony system. As you become more proficient at tweaking the auto-generated message function and eventually creating your own you will want to know more about how the harmony system is used in scripting. For this, see <a href="#the-mapharmony-function">The mapHarmony Function</a> and other sections following.</p>
<h4 id="values-of-harmony-properties">Values of Harmony Properties</h4>
<p>The above images show the harmony properties user interface. The fields are mostly popup lists from which you can choose values for each property. Open Geosonix and click on each of the fields in the Score Harmony section. You will the following options are available:</p>
<ul>
<li><p><strong>Score Tonic</strong>: The note names C, Db, D, …. , B, Bb. If you need a # note use the flat equivalent. e.g. C# is the same as Db.</p></li>
<li><p><strong>Score Scale</strong>: A large number of predefined scales are available. The names start with “sc”, as in scMajor so the scipting autocomplete system will display all scales when you type “sc”, and to distinguish the scale scMajor from the chord chMajor.</p></li>
<li><p><strong>Score Root</strong>: A list of the 12 note names starting at the currently chosen Tonic note. The scale degrees are also shown, and the notes that are in the currently chosen scale are highlighted in the list. You can choose any note even if it’s not in the scale</p></li>
<li><p><strong>Score Chord</strong>: A large number of predefined chords. These names start with “ch”. The chords that have all their notes in the currently chosen scale are highlighted. You are free to choose any chord, but those that are fully contained in the current scale would be most harmonious with it.</p></li>
<li><p><strong>Lowest Note</strong>: A list of all 127 possible MIDI note names also showing their octave and note number.</p></li>
<li><p><strong>Range in Semitones</strong>: Any number from 0 to 127 can be entered. The spin box buttons step the value up or down an octave at a time.</p></li>
<li><p><strong>Map Notes To</strong>: Determines whether note mapping should into notes from the current scale or the current chord (and repeated over a range specified by <em>Lowest Note</em> and <em>Size of the Range</em>). It determines the set of notes from which the <em>mapHarmony()</em> scripting function should chose notes. This functions is used to generate notes in all the default message functions.</p></li>
</ul>
<p>Create a blank score and add any object (e.g. a trigger) to the score and select it. This will reveal the Object Harmony properties for that object. Browse these fields.</p>
<p>You will see that the available values are the same as for the score, but if you look carefully you will see the word “Score” at the top of each list, and the value for “Range” is -1. These mean that the object inherits that value from the score. If you choose any other value for any of the properties, note mapping for this object will use those properaties instead of those score properties.</p>
<p>For example you could define an object to have a lower “Lowest Note” and smaller range than most objects in the score, causing it to create a sort of bass part for the composition.</p>
<p>Another example might be to choose the “chFifth” chord which just generates the tonic and 5th of the scale. Other objects may be generating more complex chords by it may be useful to have some objects, maybe sending on a different channel, use a simpler harmony. Again this may be useful in creating a bass accompaniment.</p>
<p>To learn more about harmony open any of the sample scores, play them and try modifying them. Almost all of them use harmony in some way.</p>
<div id="mapHarmony">

<h4 id="the-mapharmony-function">The mapHarmony Function</h4>
<p>The mapHarmony function makes it easy to automatically generate notes matching the current harmony.</p>
<pre><code>mapHarmony(value, lowValue, highValue, rangeLow, range, tonic, root, notes) </code></pre>
<p>This proportionally map the position of an input value assumed to be in a range of lowValue…highValue, into a note constrained to be in a the current harmony. The size of the range mapped into is given in semitones, with lowest note number equal to rangeLow. If mapHarmony is used in an object’s message function it will automatically use the settings for that object but inherit the score setting of any property set to “Score”. Typically most or all objects not have specific harmony properties so you can control the overall harmony of the componsition just by changing the score properties.</p>
<p>The mapHarmony function is almost always used in the form:</p>
<pre><code>mapHarmony(value, lowValue, highValue);</code></pre>
<p>i.e. The arguments of mapHarmony may be omitted starting at the right, and any omitted are replaced with values from the currently prevailing harmony, and we almost always want to use properties set for the score or object. The extra arguments are only needed only for specialized scripting.</p>
<p>The most common use of mapHarmony in a message function omits is something like:</p>
<pre><code>mapHarmony(this.r,0,1);  </code></pre>
<p>This will generate a note using all harmony properties in effect in the score taking into account any overridden in the object, at the moment the function was called. The above mapHarmony in a message function this will map the red component of the pixel behind the object into a note using the object’s current note range, tonic, root and either chord or scale. Note that colors are expressed as a number from 0.0 … 1.0.</p>
<p>Whether notes are chosen from the current chord or scale is determined by the <strong>mapNotesTo</strong> property of the score, which may be overridden by the <strong>mapNotesTo</strong> property of an object. The score’s <strong>mapNotesTo</strong> property can be set to either “Chord” or “Scale”. The <strong>mapNotesTo</strong> for objects may also be set to “Score” meaning to use the score’s <strong>mapNotesTo</strong> property.</p>
<p>Note that chord and scale are defined as an array of integers so you can also directly define your own chord or scale in a call to a harmony function. e.g. [0, 4, 9, 11] would be a definiton of a custom scale (or chord). For example:</p>
<div id="scale">
<div id="chord">
<div id="root">
<div id="rangelow">
<div id="range">
<div id="chordnotes">
<div id="scalenotes">
<div id="notes">
<div id="mapNotesTo">
<div id="objecttonic">
<div id="objectscale">
<div id="objectroot">
<div id="objectchord">
<div id="objectrangeLow">
<div id="objectrange">
<div id="objectMapNotesTo">

<h4 id="using-harmony-properties-in-scripts">Using Harmony Properties in Scripts</h4>
<p>The _score object, and trigger, curve and cursor objects all have the same harmony properties:</p>
<ul>
<li><strong>scale</strong>: The name of the scale as a text string. For objects it could also be set to “Score” meaning it inherits the score scale.</li>
<li><strong>chord</strong>: The name of the chord as a text string. For objects it could also be set to “Score” meaning it inherits the score chord.</li>
<li><strong>root</strong>: The note number of the root as an integer.<br />
</li>
<li><strong>rangeLow</strong>: The note number of the low note as set in the property inspector in Lowest Note.</li>
<li><strong>range</strong>: The size of the range in semitones as set in the property inspector in Range in Semitones.</li>
<li><strong>mapNotesTo</strong>: whether to map notes to the current Chord or Scale. May have the value “Chord” or “Scale”.</li>
</ul>
<p>For the score these properties can be read and written. For objects they are read-only. There are three other properties that are read only for the score and objects:</p>
<ul>
<li><strong>notes</strong>: The notes of the current chord/scale in the form of a Javascript array. Whether chord or scale is determined by the current mapNotesTo property.</li>
<li><strong>chordNotes</strong>: The notes of the current chord in the form of a Javascript array. e.g. A major chord would be [0,4,7].</li>
<li><strong>scaleNotes</strong>: The notes of the current scale in the form of a Javascript array. e.g. A major scale would be [0,2,4,5,7,9,11].</li>
</ul>
<p>Each object by default inherits the score’s properties because all object harmony properties are set to “Score” (or -1 for the Range field). This makes it easy to change the harmony of the score in a coherent way for all objects in a score. because all object inherit this these settings.</p>
<p>You can define some parameters for an object while inheriting others from the score. For example it’s possible to set the object chord while using the score’s tonic and scale. An object might have a different chords but continue to be transposed by changing the score tonic.</p>
<p>Because object harmony properties may actually refer to a score property (if inheritance is happening) we need a different set of property names to guarantee we read or write to the real object properties. These special object properties are:</p>
<ul>
<li><strong>objectTonic</strong>: The scale tonic for the object. May have the value of -1 meaning inherit from score.</li>
<li><strong>objectScale</strong>: The scale name for the object. May have the value of “Score” meaning inherit from score.</li>
<li><strong>objectRoot</strong>: The scale tonic for the object. May have the value of -1 meaning inherit from score.</li>
<li><strong>objectChord</strong>: The chord name for the object. May have the value of “Score” meaning inherit from score.</li>
<li><strong>objectRangeLow</strong>: The scale tonic for the object. May have the value of -1 meaning inherit from score.</li>
<li><strong>objectRange</strong>: The scale tonic for the object. May have the value of -1 meaning inherit from score.</li>
<li><strong>objectMapNotesTo</strong>: Whether to map notes to the current Chord or Scale. For objects may have the value “Chord”, “Scale”, or “Score”.</li>
</ul>
<p>Harmony properties are accessible with the “dot” operator in Javascript. Examples:</p>
<ul>
<li>_score.chord is the name of the current chord for the score</li>
<li>_score.rangeLow is the value of “Lowest Note” for the score</li>
<li>this.rangeLow when used in a message function returns the value of “Lowest Note” for the object calling a message function. This may actually be inherited from the score value if the value of this property for the object is “Score”.</li>
<li>_score.chordNotes returns a list (Javascript array) of the note offsets for the score chord. For a major triad this would return [0,4,7].<br />
</li>
<li>this.scaleNotes when used a message function returns a list (Javascript array) of the note offsets for the object chord. For a major scale this would return [0,2,4,5,7,9,11]. If the object scale is set to “Score” this would actually return the scale as set for the score.</li>
</ul>
<h4 id="setting-the-score-and-object-harmony-properties">Setting the Score and Object Harmony Properties</h4>
<p>You can use one of these script functions</p>
<ul>
<li><a href="#settonic">setTonic</a></li>
<li><a href="#setscale">setScale</a></li>
<li><a href="#setroot">setRoot</a></li>
<li><a href="#setchord">setChord</a></li>
<li><a href="#setrange">setRange</a></li>
<li><a href="#setrangelow">setRangeLow</a></li>
<li><a href="#setmapnotesto">setMapNotesTo</a></li>
</ul>
<p>Or you can directly assign to one of the properties:</p>
<pre><code>_score.tonic = 0;  //Sets the tonic to C
_score.tonic = 1;  //Sets the tonic to C#
_score.tonic = 11;  //Sets the tonic to B (the highest it can be set)
_obj(3).objectChord = scminor; Give object 3 a custom scale property, overriding the score.
_obj(99).objectScale = &quot;Score&quot;; Restore object 99 to inheriting the score scale property.</code></pre>
<p>The script editor autocompleter knows the names of all available scales, chords and scale degrees. To see a list of available scales start typing “sc” and a list of scales will appear. To see chords start typing “ch”. To see scale degrees start typing “deg”.</p>
<h4 id="moving-through-chord-progressions">Moving Through Chord Progressions</h4>
<p>Some of the sample scripts implement a simple means of stepping a score through chord changes that constrain the ongoing mappings of notes to some desired harmony.</p>
<p>The first step is to add to the script an array containing the steps the harmony should go through:</p>
<pre><code>var changes = [
    [degI,chMaj],
    [degVI,chmin],
    [degIV,chMaj],
    [degVI,chmin],
    
    [degIV,chMaj],
    [degI,chMaj],
    [degI,chMaj],
    [degV,chMaj],

    [degI,chMaj],
    [degVI,chmin],
    [degIV,chMaj],
    [degVI,chmin],
    
    [degIV,chMaj],
    [degI,chMaj],
    [degV,chMaj],
    [degI,chMaj]
];</code></pre>
<p>This is in fact an array of two-element arrays, where each of the component arrays holds a scale degree and a chord.</p>
<p>Then we create a curve in the score and add beat points at regular intervals, with at least as many beat points as steps in the harmonic sequence, in our example 16 chord steps and 16 beat points.</p>
<p>Set the “beatInterval” property for the curve to be a reasonably long note so the harmony doesn’t change too quickly, say a quarter note or half note. We then change the name of default message function of the array from “curveMessage” to something else, say “chordMsg”.</p>
<p>Then create a message function in the script with the above name, and at least containing the following code:</p>
<pre><code>function chordMsg() {
    _score.chord = mapList(this.beatNumber,0,this.nBeats-1,changes)[1];
    _score.root = mapList(this.beatNumber,0,this.nBeats-1,changes)[0];
}</code></pre>
<p>The way this works is that each time the cursor on the curve hits a beat point, the chordMsg function is called. The property this.beatNumber is set on each call to the number of the beat point which will step from 0 through 15 for a curve with 16 beat points. This is then used with the <a href="#maplist">maplist</a> library function to map the beat position into the array of harmony steps. The [1] and [0] on the end of each line picks out the chord and root respectively, and these are assigned to the _score.chord and _score.root poperties respectively.</p>
<p>We also need to put some code in the <a href="">onPlay</a> callback:</p>
<pre><code>function onPlay() {
    if (_s.scoreTime==0) {
        _score.chord = mapList(0,0,_o(13).nBeats-1,changes)[1];
        _score.root = mapList(0,0,_o(13).nBeats-1,changes)[0];
    }
}</code></pre>
<p>This ensures that the harmony is properly reset for the first beat if the score is rewound to start at time 0. Note that “_o(13)&quot; refers to object number 13 which is the curve that the cord changing beats are on.</p>
<p>For a complete example see sample score “Dramatic Melody.score”. (Not all harmony changing examples implement this feature in onPlay.)</p>
<p>Much more can be done with the harmony system but these are the only examples I’ve had time to implement so far.</p>
<h4 id="scripting-arpeggiators">Scripting Arpeggiators</h4>
<p>Another type of harmony-related scripting writing arpeggiators that notes matching the current harmony based on some pattern. For an example see sample score “Computed Arpeggiator Crazy Beats.score”. The triggers in the score use automessages to drive an arpeggiator. This one is pretty simple but much more is possible.</p>
<p>More examples will be included in the next update or in the Geosonix forum. It will be interesting to use the new <a href="#mappingnotes">mappingNotes</a> function to supply notes matching the current harmony and to step through them with various algorithms. There is also the possibly for an arpeggiator to use information from both the rhythm processor and the harmony processor to produce notes and determine their timing. This will be an area for future experimentation.</p>
<p>As new capabilities such as this are developed they will be included in the Javascript function library of future releases.</p>
<h3 id="curve-drawing">Curve Drawing</h3>
<h4 id="draw-a-path-of-line-segments">Draw a Path of Line Segments</h4>
<pre><code>    setPointAt( objectID, &lt;index&gt;, x, y, z);</code></pre>
<p>A curve must be defined a sequence of points. The points index starts at point number 0. Note that point coordinates are defined to be relative to the position of the curve object. For more detail, see the section on <a href="script.html#drawingcurves">drawing curves</a> in the scripting section.</p>
<p>If instead of a number the index is entered as “next”, the next number is supplied automatically, making it easier to work with sequences of points. This feature also works with setSmoothPointAt and setBezierPoint At.</p>
<p>The following sequence of commands creates object with ID 99 and sets it at a position of (-1, -1, 0). Then it draws a line from that position to a point 3 up and 3 across from the object location, and then a line to the point 1 up and 5 across.</p>
<pre><code>addCurve(99);
setPosition(99,-1,-1,0);
setPointAt(99,0,0,0,0);
setPointAt(99,1,3,3,0);
setPointAt(99,2,1,5,0);</code></pre>
<p>The following does the same as the example above but the numbers are generated automatically.</p>
<pre><code>addCurve(99);
setPosition( 99, -1, -1, 0 );
setPointAt( 99, &quot;next&quot;, 0, 0, 0 );
setPointAt( 99, &quot;next&quot;, 3, 3, 0 );
setPointAt( 99, &quot;next&quot;, 1, 5, 0 );</code></pre>
<h4 id="draw-a-path-of-lines-with-curved-corners">Draw a Path of Lines With Curved Corners</h4>
<pre><code>setSmoothPointAt(objectID,index,x,y,z);</code></pre>
<p>This command is similar to setPointAt(), but the sharp corners created by setPointAt() are instead curved.</p>
<p>The following sequence of commands creates object with ID 99 and sets it at a position of (-1,-1,0). Then it draws a line from that position to a point 3 up and 3 across from the object location, and then a line to the point 1 up and 5 across. However the corner between the two straight line segments is curved.</p>
<pre><code>addCurve(142);
setPosition(142,-1,-1,0);
setSmoothPointAt(142,0,0,0,0);
setSmoothPointAt(142,1,3,3,0);
setSmoothPointAt(142,2,1,3,0);</code></pre>
<h4 id="draw-a-path-of-bezier-curves">Draw a Path of Bezier Curves</h4>
<pre><code>setPointBezierAt(objectID, index, x, y, z,  dxStart, dyStart, dzStart, 
                                            dxEnd,   dyEnd,   dzEnd);</code></pre>
<p>Bézier curves are formed from curved line segments defined giving the endpoint of each subsequent segment. They can give you graceful curves, with more control of shape and curvature than the setSmoothPointAt() command. The start point of the segment is the end of the previous segmen. The end point of this segment is given by the point (x, y, z). The curvature is defined by providing two additonal “control points” to the <code>setPointAt</code> function. The point (dxStart, dyStart, <dzStart>) is a point defined as an offset from the starting point of this segment that controls the curve’s tangent at its start. The point (dxEnd, dyEnd, dzEnd) is a point defined as an offset from the end point of this segment that controls the tangent to this segment at its end. If the curve is being drawn in just the x-y plane (two dimensional) then all the z coordinates of the points can be omitted. If any are specified then they must all be specified. For a more detailed explanation of drawing bezier curve see the section on <a href="script.html#drawingcurves">drawing curves</a>.</p>
<p>The following sequence of commands draws a curve with some sharp corners and other segments formed of bezier curves.</p>
<pre><code>addCurve(&quot;automatic&quot;);
setPointAt(0,-2,-1,0);
setPointAt( &quot;next&quot;,-2,3,0);
setPointBezierAt( &quot;next&quot;, 2,3,0, 2,2,0, 0,3,0);
setPointAt( &quot;next&quot;, 0,2,1 );
setPointBezierAt( &quot;next&quot;, -2,-1,0, 0,-1,2, 4, 0, 0);</code></pre>
<h4 id="draw-a-path-from-text">Draw a Path From Text</h4>
<pre><code>setPointsTxt( objectID, scaleFactor, font, textString )</code></pre>
<p>Creates a curve in the shape of the characters of a text string. The resulting curve can be rescaled with the scale factor, the font can be defined by specifying the name of any font available on the system surrounded by quotes. The text string to be drawn can be any sequence of characters in the font. A single call to the setPointsTxt command defines a single curve spanning all of the characters. To create a separate curve for each letter used the setPointsTxt command repeatedly.</p>
<p>The following sequence of commands creates a curve shaped like the letter “Hello”:</p>
<pre><code>addCurve(99)
setPointsTxt( 0.1, &quot;Arial&quot;, &quot;Hello&quot;)</code></pre>
<h4 id="resize-a-curve">Resize a Curve</h4>
<pre><code>setCurveSize(objectID, width, height);</code></pre>
<p>The size a curve can be changed by specifying a new height and width.</p>
<p>The following sequence of commands creates an circle (a 1x1 ellipse) at position 0,0,0 and stretches it to 2x5:</p>
<pre><code>addEllipse(99, 1,1, 0,0,0);
setCurveSize(99, 2,5);</code></pre>
<p>See the <a href="messages.html#parameters">parameter list</a> for the score-state variables available for use in curve messages.</p>
<h4 id="format-a-curve-as-a-broken-line-with-dashes-and-spaces">Format a Curve as a Broken Line with Dashes and Spaces</h4>
<pre><code>setLine( objectID, dashStyle, dashPattern);</code></pre>
<p>Sets a style dotted with <code>dash pattern</code> which must be a sequence of 0 and 1, <code>dash style</code> defines the space between each dot.</p>
<p>This example adds a 1x2 ellipse with ID 100 and gives it a pattern of dashes and spaces:</p>
<pre><code>ellipse(100, 1,2, 0,0,0);

setLine(2000, 1);</code></pre>
<h4 id="set-the-thickness-of-a-curve-or-cursor">Set the Thickness of a Curve or Cursor</h4>
<pre><code>setLineThickness( objectID, thickness);</code></pre>
<p>Set line thickness. The maximum is 10 units.</p>
<p>This example adds a circle (i.e. a 1x1 ellipse) with ID 100 and gives it a thickness of 5 units:</p>
<pre><code>ellipse(100, 1,1, 0,0,0);

setLineThickness(100, 5);</code></pre>
<div id="mover">

</div>
<div id="updatemotion">

</div>
<div id="initmotion">
<div id="_mv">

<h4 id="animation">Animation</h4>
<p>You can animate objects by placing code that gradually changes their position inside either the [onPaint] or [onTick] callback functions. If it’s inside onPaint, if you want object motion to stop when the score stops playing you need to protect it with the _score.playing property. It is easier to use onTick to update motion although it’s less efficient because onTick is called more often.</p>
<p>Here is an example from sample score “Pulsating Ellipse With Triggers”:</p>
<p>function onPaint() { _obj(1).x = 3*cos(_doc.scoreTime/3); _obj(1).y = 1*sin(_doc.scoreTime/3); _obj(1).width = 8+7*sin(_doc.scoreTime); _obj(1).height = 5+4*cos(_doc.scoreTime); }</p>
<p>This changes both the position and dimensions of an ellipse as a function of score time. To see it running open and play the sample score.</p>
<p>A more advanced example that creates very interesting motion is to have objects be nudged on each position update in directions and amounts based on the colors of the pixel currently behind the object. This causes semi random looking wandering that is fully repeatable but different with each starting position and with each new image.</p>
<p>This is implemented in a function supplied in the Javascript library. Here is how to use it:</p>
<p>Include the following sort of code in the [onRewind] function:</p>
<pre><code>function onRewind() {
    _mv = [];
    Math.seed = 8;
    new mover(1, [1,2,0], 0.01, 0.005);
    new mover(2, [1,3,0], 0.01, 0.005);
    new mover(3, [1,4,0], 0.01, 0.005);
    new mover(4, [0,3,0], 0.02, 0.002);
    new mover(6, [0,2,0], 0.02, 0.002);    
    initMotion();
}</code></pre>
<p>Insert the id of each object you want to animate into a mover function:</p>
<pre><code>mover(objId, startPos, colorImpulse, maxVel);</code></pre>
<ul>
<li>objId is the Id of a object to be animated. The object must have already been created</li>
<li>startPos is a Javascript array with the x, y, z starting position for the object. e.g. [1,3,0]</li>
<li>colorImpulse defines the amount of “force” applied by the colors in the background image on each animation update. The direction of the impulses from a color (r, g, or b) are determined randomly at the start, inside the mover function. The impulse number scales the amount of force. Small values work best (0.005…0.05).</li>
<li>maxVel sets the highest velocity objects are allowed to achieve. Very small numbers work best.</li>
</ul>
<p>After calling mover() for all desired objects, call initMotion() to complete preparation for animation.</p>
<p>Before calling mover() you also must hve defined an array called _mv to hold the movers. Optionally provide a random number seed. Each value of the seed will initialize the objects to respond to the colors in the image differently.</p>
<p>Also include in your script the following in the [onPaint] callback function:</p>
<pre><code>function onPaint(time) {
    if (_score.playing) 
        updateMotion() ;
}</code></pre>
<p>This repeatedly calls the updateMotion() library function, but only if the score is playing.</p>
<p>Or this in [onTick]:</p>
<pre><code>function onTick(time) {
    updateMotion();
}</code></pre>
<p>onTick is only called when the score is playing. It’s called about eight times as often as onPaint and so results in smoother motion but it more processor intensive for updating.</p>
<p>You al need to supply a backround image to provide the colors that will drive the motion. The easiest way to do this is to drag one from somewhere in you files system and drop it on the score background.</p>
<p>For examples of animation see “Two Wandering Triggers.score”, “Wandering Objects.score”, or “Wandering Object and Chord Changer.score”.</p>
<p>There’s much more that could be done with animation but these are the only examples I’ve implemented so far.</p>
<h3 id="object-colors">Object Colors</h3>
<h4 id="colors-in-the-property-inspector">Colors in the Property Inspector</h4>
<p>
<p><img src="../Common/img/Position Size and Color.png" alt="Position, Size and Color" style="float:right;width:400px;margin:0 10px 10px 0"> In the Property Inspector colors are set in the two Colors fields (see at right) , one for the color used when the object is active and the other for when the object is inactive. By default all objects are active so this is the color you will mostly see.</p>
Colors are set in a dropdown list containing the standard colors used for each type of object. At the bottom there is an option to define a custom color just for this object. You can also use scripting commands <a href="#registercolor">registerColor</a> or <a href="#registercolorhue">registerColorHue</a> to register a name for a particular custom color you can then reuse for multiple objects.
</p>
<div style="clear:both;">

</div>
<h4 id="setting-colors-with-scripting">Setting Colors With Scripting</h4>
<p>In color theory a color can be specified either in terms of Hue, Saturation, Brightess and Alpha (HSBA), or in terms of Red, Green, Blue and Alpha (RGBA), where Alpha is the opacity.</p>
<p>Geosonix has a family of functions for setting colors in terms of RGBA and and another for setting color in terms of HSBA (hue). Which each is should be clear from the function names.</p>
<p>The normal setColor functions take RGB values are numbers ranging from 0 to 255, and HSB values ranging from 0 to 360. Alpha for both RGBA and HSBA is specified as a number ranging from 0 (fully transparent) to 255 (fully opaque).</p>
<p>Remember if you set alpha to zero the object will become invisible!</p>
<p>There is also a family of message functions with identical names but ending in “01” where all arguments can be specified as a number ranging from 0.0 to 1.0, which is often more convenient in scripting.</p>
<p>There are six functions for setting RGBA:</p>
<pre><code>setColorActive( objectID, red, green, blue, alpha );
setColorInactive( objectID, red, green, blue, alpha );
setColor( objectID, red, green, blue, alpha );
setColorActive01( objectID, red, green, blue, alpha );
setColorInactive01( objectID, red, green, blue, alpha );
setColor01( objectID, red, green, blue, alpha );</code></pre>
<p>Similarly there are six functions for setting HSBA:</p>
<pre><code>setColorActiveHue( objectID, hue, saturation, brightness, alpha );
setColorInactiveHue( objectID, hue, saturation, brightness, alpha );
setColorHue( objectID, hue, saturation, brightness, alpha );
setColorActiveHue01( objectID, hue, saturation, brightness, alpha );
setColorInactiveHue01( objectID, hue, saturation, brightness, alpha );
setColorHue01( objectID, hue, saturation, brightness, alpha );</code></pre>
<p>For all these commands the objectID specifies the object. If alpha is omitted a maximum value is assumed, so the color is not transparent.</p>
<p>This example the color of the most recently referred to object is given hue=212, saturation=90, brightness=271 and alpha=255:</p>
<pre><code>setColorHue( 212, 90, 271, 255);</code></pre>
<h4 id="registering-new-named-colors">Registering New Named Colors</h4>
<p>In addition is it possible to defined named colors for convenience in applying the same color to multiple objects. There is one version of defining the name in terms of RGBA and another for HSBA:</p>
<pre><code>registerColor( &quot;colorName&quot;, red, green, blue, alpha );
registerColorHue( &quot;colorName&quot;, hue, saturation, brightness, alpha );
registerColor01( &quot;colorName&quot;, red, green, blue, alpha );
registerColorHue01( &quot;colorName&quot;, hue, saturation, brightness, alpha );</code></pre>
<p>This example defines the color called “myColor” with red=40, green=123, blue=231 and alpha=125, and applies it to objects with ID 98 and 99:</p>
<pre><code>registerColor( &quot;myColor&quot;, 40, 123, 231, 125 );
setColor( 98, &quot;myColor&quot; );
setColor( 99, &quot;myColor&quot; );   </code></pre>
<h3 id="assigning-images-to-objects">Assigning Images to Objects</h3>
<p>An image from a file used to change the appearange of triggers all triggers globally, individually or for group of triggers. If future it will be possible to similarly assign images to cursors.</p>
<p>As for colors, a separate image can be assigned for each of the following types of triggers:</p>
<ul>
<li>Triggers that are active and have at least one message defined</li>
<li>Triggers that are active and have no messages defined</li>
<li>Triggers that are inactive and have at least one message defined</li>
<li>Triggers that are inactive and have no messages defined</li>
</ul>
<h4 id="registering-and-naming-an-image">Registering and Naming an Image</h4>
<pre><code>registerImage(assignTo, xTopLeft, yTopLeft, xBottomRight, yBottomRight, filePath)</code></pre>
<p>AssignTo gives a Geosonix-internal name to assign to the image, xTopLeft through yBottomRight allow resizing the image to meet your requirements, and filePath gives the name and if necessary the path to the image file. If the file is in the current project’s “Geosonix Project Info” folder or the “Geosonix Project Info” in the Geosonix application folder then only the file name is needed. On Macintosh the file may be a jpg or png image. On Windows it must be a png image.</p>
<p>The assignTo parameter may take for following special values to assign the image to specific features of the score:</p>
<ul>
<li>“trigger_active”: Assigns the image to all active triggers in the score without messages.</li>
<li>“trigger_inactive”: Assigns the image to all inactive triggers in the score without messages.</li>
<li>“trigger_active_message”: Assigns the image to all active triggers in the score with messages.</li>
<li>“trigger_inactive_message”: Assigns the image to all inactive triggers in the score with messages.</li>
</ul>
<p>In addition any name other than the above five can be assigned to an image. This allows an image to be referred to by its internal name rather than the name of its file. Names images of this type are also used in the setImage commands described below that allow allow images to be assigned to individual triggers overriding the default or custom global image.</p>
<p>The following example sets the score background to the image in the file “music-image.png” The image is sized to fit a region with upper left corner (-8, 6.5) and lower right corner (13, -8.5):</p>
<pre><code>registerImage(&quot;background&quot;, -8, 6.5, 13, -8.5, &quot;music-image.png&quot;)</code></pre>
<p>The score background can be cleared by assigning an image to it but setting the region to have zero size. Any image can be used, but the image “background.png” is provided with Geosonix so it is convenient to use. For example the following command clears the score background of any previous image:</p>
<pre><code>registerImage(&quot;background&quot;, 0, 0, 0, 0, &quot;background.png&quot;)</code></pre>
<p>Auto-loading the background image: If the name of the background file ends in an exclamation mark, the score background will be refreshed each time the background file is rewritten. For example assume you have loaded the file “shapes!.jpg” as the Geosonix score background. Then if you open the file in an image editor, change it and save over the original file, the background in Geosonix will automatically change. This can be used, for example, to automatically reload the background with images captured at regular intervals with a webcam. It’s also useful for “improvising” using an image editor by changing and repeadedly resaving the background of a score. This assumes the messages use parameters such as cursorRed, triggerHue, etcetera, to affect the musical results. It’s best to keep image files reasonably small so as not to cause the playing score to hesitate when the images are reloaded.</p>
<p>The following command defines an custom named image called “myCustomImage” containing the image in the file “trigger_speaker.png”. The stored image is sized to fill a rectangle with an upper left corner of (-2,2) and a lower right corner of (-2,2):</p>
<pre><code> registerImage( &quot;myCustomImage&quot;, -2, 2, 2, -2, &quot;trigger_speaker.png&quot;)</code></pre>
<h4 id="assigning-a-named-image-to-a-trigger">Assigning a Named Image to a Trigger</h4>
<p>In addition to setting a global image for triggers it is also possible to override the global image and assign images to triggers individually. This is a two step process. First it is necessary to define a named image using the registerImage command, as described above. Then the image can be assigned by name to triggers as required using a setImage command.</p>
<p>As for setting colors, there are five forms of the setImage command as follows:</p>
<pre><code>setImage( assignTo, xTopLeft, yTopLeft, xBottomRight, yBottomRight, filePath )
setImageActive( assignTo, xTopLeft, yTopLeft, xBottomRight, yBottomRight, filePath )
setImageInactive( assignTo, xTopLeft, yTopLeft, xBottomRight, yBottomRight, filePath )</code></pre>
<p>The following sequence of commands assigns the image “trigger_speaker.png” to be the default image for active triggers that have messages. It also defines an custom named image called “myCustomImage” containing the image in the file “trigger_speaker.png”, but this time sized to fill the rectangle with upper left corner (-2,2) and lower right corner (2,-2). This larger image is assigned just to the trigger with id 2.</p>
<pre><code>registerImage( &quot;trigger_active&quot;, -1, 1, 1, -1, &quot;trigger_speaker_1.png&quot;); 
registerImage( &quot;myCustomImage&quot;, -2, 2, 2, -2, &quot;trigger_speaker_2.png&quot;);
addTrigger(1);
setPosition(0,0);
addTrigger(2);
setPosition(3,0);
setimage(1, &quot;myCustomImage&quot;);</code></pre>
<h2 id="geosonics-scripting">Geosonics Scripting</h2>
<h3 id="introduction-to-scripting">Introduction to Scripting</h3>
<p>The scripting language of Geosonix is Javascript. There are also numerous predefined commands, objects and properties for interacting with Geosonix. I’m not going to try teach you Javascript, but if you’ve ever done even basic programming or scripting. If you are resourceful can probably pick up what you need as you go along because there will be lots of examples.</p>
<p>However unless you’re a Javascript expert you’ll find it useful to have a language reference available, on which there are many online. Here’s one <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference">example</a>. In fact Javascript is so widely used that you can probably find any answer you need with an Internet search.</p>
<p>Watch out however that a lot of information on the Internet assumes your Javascript is running in a browser which provides an HTML document object and lot’s of related propertes. There is no HTML document Geosonix, and things like JQuery are also not available (and not needed).</p>
<p>Therefore you should use a pure Javascript reference to learn the Javascript you need, but use this Geosonix documention to learn about the runtime environment and available objects and properties.</p>
<h3 id="the-script-editor">The Script Editor</h3>
<p><img src="../Common/img/Script Editor.png" alt="Script Tab" style="float:right;width:350px;margin:0 10px 10px 0"></p>
<p>Note: There is a tutorial on using the script editor in one of the example scores you downloaded with Geosonix. It will be in the “Geosonix Scores” folder that was created in in your Documents folder the first time you gan Geosonix. Open the score called “Script Editor Tutorial”, click on the Script tab in the Property Inspector, then read the description of the editor below while noticing the parts of the editor as they are mentioned. Then follow the instructions in the sample script for a hands on tutorial of basic use of the editor.</p>
<p>The main parts of the Script Editor are:</p>
<ul>
<li>You edit the script in large area with white-background that occupies most of the space. We also call the contents of the editor the <em>Script Buffer</em> because it contains the entire script for this score. In this example the script is just one trigger message function called triggerMessage. The editor highlights Javascript syntax making it easier understand the parts of the script.</li>
<li>Below the editor near the bottom is the <em>Output Area</em> which in this case contains “ok” which is the result of successfully evaluating the script that produced no other text output.</li>
<li>Below the output area are some buttons:
<ul>
<li>The <em>Selection</em> button evaluates exactly what is selected in the editor (i.e. what is highlighted) even just part of a line.</li>
<li>The <em>Line</em> button evaluates the entire line containing the text cursor</li>
<li>The <em>Function</em> button evaluates the entire function containing the text cursor. Note that this does not <strong>call</strong> the function. What it does is take the text definition in the edit and update the function definition in the live Javascript buffer.</li>
<li>The <em>All</em> button evaluate the entire</li>
<li>The <em>Clear Output</em> button clears the output area.</li>
<li>The <em>Stop Script</em> button forces a script to stop. You should almost never need to use the stop script button unless you create and evaluate something like an infinite loop.</li>
</ul></li>
</ul>
</p>
<div style="clear:both;">

</div>
<h3 id="the-script-runtime-environment">The Script Runtime Environment</h3>
<p>Each score provides its own invisible runtime environment where scripts are executed. The environment contains Javascript itself and a large number of predefined commands, properties and objects for interacting with Geosonix. When you evaluate some or part of a script that is in the editor, the score’s script environment is updated to include any variables, objects and functions defined by your script. A score interacts with these when it’s running.</p>
<p>It’s important to understand that the script you see in the Script Editor <strong>does not become part of the runtime environment until it is evaluted</strong>. Geosonix helps by auto evaluating the script when a score is loaded. It also automatically evaluates message functions defined using the property inspector. However if you edit the script you need to evaluate it again, or at least the part that you changed.</p>
<p>Another important detail is that your script may have a syntax error preventing some part from being evaluated, the items containing the error may not be updated in the runtime environment. A confusing situation can occur where you delete a function from the editor or a syntax error prevents a function from being evaluated. In this case the previous of the function version continues to exist in the runtime environment. Geosonix avoids this situation by deleting the previous version of a function that’s about to be evaluated, and then doing the evaluation, resulting in it being redefined. Thus if you evaluate all or part a script and find some function is no longer defined, this is a clue that your function contained an error. Most of the time errors in evaluation will also be reported in the output buffer, including the line number and possibly other helpful information.</p>
<h3 id="more-on-the-script-editor">More on The Script Editor</h3>
<p>The editor is much like other programming editors you may have used. It has:</p>
<ul>
<li>Context sensitive help. Put the cursor in almost any keyword, press the F1 key, and Geosonix will show the documentation on it in your default web browser. (The user’s manual is online so it can be continually be improved and updated)</li>
<li>Line numbering</li>
<li>Syntax highlighting</li>
<li>Automatic indentation</li>
<li>Highlighting of matching parentheses and other brackets</li>
<li>Cut, Copy and Paste with the usual Command+x, Command+c and Command+v keyboard shortcuts.</li>
<li>Unlimited undo and redo using the keyboard shortcuts Command+z to undo and Command+Shift+z to redo. The focus must be on the editor for undo to work on the script. (Otherwise undo and redo applies to the graphics view)</li>
<li>Keyword completion, both for Javascript keywords and even for Geosonix commands. Matching keywords appear after you’ve typed at least the first two letters of any new word in the editor.</li>
<li>Code-tips that indicate the parameters for functions. These appear after you type a keyword and type a “(” to begin entering any parameters. Note that as in most languages functions in Javascript with no parameters still need to include empty parentheses because this is what indicates that a keyword is a function. <img src="../Common/img/Find Replace.png" alt="Find Replace" style="float:right;width:350px;margin:0 10px 10px 0"></li>
<li>The editor includes commands to find find and find/replace text. Press Command + F to open it with the keyboard. There are fields to enter the text to find and, if any, text to replace it with. The controls are: <strong>&lt;</strong>: find backward (which currently does not work!); <strong>&gt;</strong> find forward ; <strong>x</strong>: close; <strong>Rep</strong>: replace; <strong>Rep&gt;</strong>: replace and find; <strong>All</strong>: replace all instances.<br />
</li>
<li>The editor can automatically convert one or more lines of text into Javascript comments by prefixing the lines with “//” causing them not to be evaluated. For example in the image at the right lines 19 to 22 are commented causing the function onRewind() never to be evaluated. To comment a block of lines, select them and press Command+Option+/ . To uncomment a block of lines, select them and press Command+Option+/ again. For the commenting to be reversed all selected lines must have “//” at the far left. If you comment or uncomment lines remember to re-evaluate the script to cause the change to take effect. Any functions commented out in this way will be deleted from the Javascript global context when the script is re-evaluated. You can also undo and redo commenting added this way.
<div style="clear:both;">

</div></li>
</ul>
<p>The Geosonix editor also has some special features to interact with the score:</p>
<ul>
<li>Any function in the editor that is the message function of at least one object has a small blue triangle added in the left margin. See the above “Script Editor” image for an example.</li>
<li>This triangle turns red for any objects that are selected in the graphical view of the score. (All selected objects are surrounded with a yellow rectangle)</li>
<li>If you place the text cursor in the first line of function that is a message function, all objects that use that message function are highlighted in the graphical view of the score.</li>
<li>The buttons below the output buffer provide smart code evaluation. See above for list of the buttons. There are also useful keyboard shortcuts for the buttons. I stongly advise you to learn these as they they are a nice way of interacting with the editor.<br />
</li>
<li>When you evaluate code in the editor that produces text output, it’s printed below the editor. For a simple example type 2 + 3; on a line in the editor and press the “Line” button. The sum of 5 should appear in the buffer. Note that in Javascript the output of an object is itself. i.e. Type just 3 on a line, evalute the line, and the output will be 3. (No need for a print command) However the result of evaluating of multiple lines of code is only the value of the last line. For example, if you type 2 on one line and 3 on the next, select them and press the evaluate <em>Selection</em> button, only 3 will be printed.</li>
<li><p>It’s not necessary to execute code in the editor in order from top to bottom. For example if you want to peridically check some property of a object, say the local time, you could add a this line anywhere in the editor, place the cursor in the line and execute it as needed with the execute line button or the <em>Command + .</em> keyboard shortcut:</p>
<p>print(_obj(99).localTime); //Print the local time for object with id 99</p>
<p>On each evaluation of the line the local time in the object would be printed in the output buffer, even while the score is playing.</p></li>
</ul>
<p>More tips and tricks on using the editor will be included in the tutorials.</p>
<h3 id="using-object-ids-in-scripting">Using Object IDs in Scripting</h3>
<p>Every score object is assigned a unique id when it is created, integers ranging from 1 to 32767. Ids are used to refer to objects in the script. For example:</p>
<ul>
<li>addTrigger(99,1,-1,0); //Adds a trigger with id 99 at position x=1, y=-1, z=0</li>
<li>addTrigger(100,3,3,0); //Adds another trigger with id 100 at position x=3, y=3, z=0</li>
<li>remove(99); //Removes object with id 99 from the score</li>
<li>_obj(100); //Converts object 100 into a Javascript object so you can use Javascript to refer to its properties</li>
<li>print(_obj(100).x, _obj(100).y); //As above but prints x and y coordinates of the object</li>
<li>_obj(100).x = 2.0; //As above but sets the x position of the object to 2.0, causing to to be reloated in the score</li>
</ul>
<p>Try copying these lines and pasting them into the script editor and evaluating them one at a time from top to bottom using the execute <em>Line</em> button (or try evaluating each with the keyboard “Evaluate Line” shortcut which is Command+. on a Mac).</p>
<p>When you paste these lines into the editor they will wrap to the next line although they are still treated as one “line” of code. If you put the cursor anywhere in a wrapped line and evaluate the “line” the entire line is evaluated. You can drag the edge of the property inspector to the right to to enlarge it if you want to see the lines in unwrapped form.</p>
<p>Ids are normally assigned to objects automatically in increasing order starting at 1 although you can create an object with any id through scripting, and you can change the id of an object in the property inspector. However you are prevented from giving two objects the same id. If an object with a given id exists and another is created with that id it will delete the previous object before creating the new object.</p>
<p>All commands that create objects (that start with “add”) return the id of the added object as the value of the function. This is very useful in creating understandable scripts, and in making reusable code fragments. Example:</p>
<pre><code>//Add an ellipse with id 100.  Assign id to variable myId.
var myId = addEllipse(100, 2,3, 4,4,0);
setLineThickness(myId, 5); //Use the variable myId to set the line thickness.
setColor(myId, 0,0,255);  //Use the variable myId to set the color.</code></pre>
<p>We use the Javascript keyword <em>var</em> to define a variable called <em>myId</em> and assign the added object’s id to it. Then use the variable as the <em>myId</em> in following functions.</p>
<p>Of course we could have directly used 100 as the id in each command but writing the script as above allows you to change the id in the first line and all other lines work automatically. You could for example copy and paste these lines twice and enter a different id into the second addEllipse, giving it a different size, position and color. Code like this could also be put in a loop to create multiple objects, or in a subroutine that you pass the id so the code gets reused.</p>
<div id="all">

</div>
<div id="current">

</div>
<div id="lastcurve">

</div>
<div id="lastcurve">

</div>
<h3 id="special-id-codes">Special ID Codes</h3>
<p>There are predefined keywords you can use as the id in scripting commands to refer to various groups of objects:</p>
<ul>
<li><strong>“all”</strong>: Applies the command to all objects in the score with types compatible with this command.</li>
<li><strong>“current”</strong>: Applies the command to the same object that was referred to in the previously executed scripting command.</li>
<li><strong>“lastcurve”</strong>: Applies the command to the most recently added curve.</li>
<li><strong>“selection”</strong>: Applies the command to all objects selected in the score with types compatible with this command.</li>
<li><strong>The name of a group</strong>: Any object can be assigned to some group in the property inspector or with the <em>setGroup</em> scripting command. The group name can be any text string other than an integer or one of the above keywords. These group names can be used in place of ids in any scripting command.</li>
</ul>
<p>Examples:</p>
<p>Copy these lines and paste them into the editor in Script tab. Then execute one line at a time using the Line button at the bottom of the editor, or preferably the Command+. keyboard shortcut.</p>
<pre><code>addTrigger(99,1,-1,0);  //Add a trigger
setGroup(99, &quot;mygroup&quot;);  //Assign to group &quot;mygroup&quot;
addTrigger(100,1,0,0);  //Add a trigger
setGroup(100, &quot;mygroup&quot;);  //Assign to group &quot;mygroup&quot;
addTrigger(101,1,1,0);  //Add a trigger (not assigned to the group)

setColor(99, 0,0,255);  //Set the color of object 99 to blue
setTriggerSize(&quot;current&quot;,3);  //Set the size of the previously referred to object
setColor(&quot;all&quot;, 255,0,0);  //Set the color of all objects to red
setColor(&quot;mygroup&quot;, 0,255,0);  //Set the color of &quot;mygroup&quot; to green
setColor(&quot;selection&quot;, 255,255,0);  //Set any selected objects to yellow</code></pre>
<h3 id="score-objects-as-javascript-objects">Score Objects as Javascript Objects</h3>
<p>In addition to using scripting commands such as setColor() to access object properties, you can also access score objects as real Javascript objects using the <strong>_obj</strong> command. Then you can use Javascript syntax to get and set their properties. You can also access an object for the current score using the predefied Javascript object <strong>_score</strong>. Direct use of object properties allows you to do some things that aren’t possible with Geosonix functional commands. There are also many methods (specialized functions) that can be called on these objects.</p>
<p>As above, you can copy all these examples into the editor and execute them one line at a time using the Command+. keyboard shortcut.</p>
<pre><code>addTrigger(150,2,-1,0);  //Add a trigger
print(_obj(150).x);   //Print x coordinate to the text output area
_obj(150).x = 3;  //Changes the x coordinate.  The object will be moved.

//Use the short form of _obj to assign the object to a new variable
var savedObject = _o(150);  //avedObject is the object 150 in JS
savedObject.y = 4;  //Change y position using the new variable.

//Use the predefined object _score to print the current global scale.
print(_score.scaleName); 
_score.scaleName = &quot;Minor&quot;;  //Change the scale for the score.</code></pre>
<p>Another important way to directly access score objects in Javascript is with the keyword <strong>this</strong> in message functions. When a message function is triggered by a particular object, the Javascript keyword <strong>this</strong> in the function context is set to to that object. Here’s a brief example that sends a midi note using the port, channel and note properties of the object that triggered the message function, with a velocity of 127 and a duration of 1000 milliseconds:</p>
<pre><code>function triggerMessage() {
    midi.note(this.port, this.channel, this.note, 127, 1000)
}</code></pre>
<p>Note that the keyword <strong>this</strong> only refers to score objects inside message functions and only when they have been called by an object being triggered.</p>
<p>Another useful trick is to use the _obj function to convert newly creatly objects to Javascript objects. You could rewrite the above <a href="#using-object-ids-in-scripting">example</a> as follows:</p>
<pre><code>//Use _obj to convert the ellipse id into variable myObj
var myObj = _obj(addEllipse(100, 2,3, 4,4,0));
myObj.lineThickness = 5; //Assign a value to the lineThickness property of myObj
myObj.label = &quot;Hello World&quot;;   //Assign to the label property of myObj</code></pre>
<p>Using Object IDs in Scripting</p>
<p>All this will be more fully covered in the section on messages and message functions.</p>
<div id="oncreate">

</div>
<div id="onrewind">

</div>
<div id="onplay">

</div>
<div id="onstop">

</div>
<div id="ontick">

</div>
<div id="ondrop">

</div>
<div id="onmessage">

</div>
<div id="onpaint">

</div>
<div id="onload">

</div>
<h3 id="score-callbacks">Score Callbacks</h3>
<p>Callbacks are functions you can define in the script to be called by Geosonix when certain events happen. Use them to carry out custom actions.</p>
<ul>
<li><strong>onRewind()</strong> - Called when the rewind button is pressed. Use onRewind to reset settings in your script that are not automatially reset by Geosonix. For an example see “Chord Changer.score” where onRewind is used to reset the position of the moving objects.</li>
<li><strong>onPlay()</strong> - Called when the play button is pressed. Use onPlay to start actions in your script that are not automatically started by Geosonix.</li>
<li><strong>onStop()</strong> - Called when the stop button is pressed. You might use this to send an “all notes off” midi message to silence external synthesizers.</li>
<li><strong>onPaint()</strong> - Called at start of display refresh, approximately once per 40 milliseconds. Use this to update object properties related to the display such as position or color. For example it could be used for object animation. For an example see sample score “Pulsating Ellipse with Triggers.score”. This is also used in score with drifting objects such as “Chord Changer.score”.</li>
<li><strong>onTick(time)</strong> - Called each tick of master clock, a rate ranging from 5 to 20 milliseconds. Use this to update that affect event generation.</li>
<li><strong>onDrop(droppedObjects)</strong> - Called when object drag/drop or image is dragged in from file. For an example of use see sample score “Drag Drop Changes Rhythm.score”.</li>
</ul>
<p>The following functions are called when Geosonix receives a MIDI or OSC message. More documentation and examples will be added on this topic in the near future.</p>
<ul>
<li>onMessage(protocol, sourceURL, sourcePort, address, value); For OSC protocol = “osc”</li>
<li>onMessage(protocol, notUsed, channel, msgType, param) For MIDI protocol = “midi”</li>
</ul>
<h2 id="scripting-commands">Scripting Commands</h2>
<h5 id="obj">_obj</h5>
<pre><code>_obj(id);</code></pre>
<p>Returns the object with given id. Examples: _obj(5).x, or _obj(99).cursorWidth=4. _o(id) is an abbreviation for _obj(id). For more detail see <a href="#score-objects-as-javascript-objects">Score Objects as Javascript Objects</a>.</p>
<div id="_s">

</div>
<h5 id="score">_score</h5>
<p>This or its shortcut _s are actually functions, but a global object that’s always defined in the scripting envronment that represents the score itself. From this object you can access score properties and methods using the “.” operator.</p>
<p>For example</p>
<pre><code>_score.backgroundFile; //The complete path to the file of the background image
_score.scoreTime; //The current elpased playing time of the score
_s.chordNotes; //A Javascript array of the notes in the current score chord
_s.playing; // Equal to true if the score is currently playing</code></pre>
<p>You can also set properties by assigning to them:</p>
<pre><code>_s.scale = scMinor;  //Set the score scale to minor</code></pre>
<p>Some score properties can only be accessed, not changed. For example:</p>
<pre><code>_score.backgroundSize; can only be accessed in property</code></pre>
<p>Although you can resize the background image with <a href="#setbackground">setBackground</a>.</p>
<p>For a list of score properties see <a href="#properties-of-the-score">Properties of the Score</a>.</p>
<h5 id="this">this</h5>
<p>The keyword <strong>this</strong> is a normal part of Javascript. Here it one good source of complete <a href="http://stackoverflow.com/questions/3127429/how-does-the-this-keyword-work">details</a> of how it’s used. You don’t need to know any of this to make good use of Geosonix although you may want to get to understand it for more advanced scripting.</p>
<p>However, in Geosonix message functions <strong>this</strong> is special in that it holds a reference to the Geosonix object calling the function. Its a very convenient way of accessing and even changing the properties of the calling object. We almost always want to access some properties of the calling object in a message function because this is how the message is able to do something interesting using the exact current state of the object. For example:</p>
<pre><code>this.x;  //In a message function fetches the x position of the object
this.angle;  //In a cursor message function fetches the current angle of the cursor </code></pre>
<p>There are many examples of this in the sample scores and through this documentation. For example see the message function in <a href="#label-and-id-toolbar-buttons">Label and ID Toolbar Buttons</a>. Other examples are in <a href="#object-midi-port-channel-note-and-controller">Object MIDI Port, Channel, Note and Controller</a>. For another example of a message function see <a href="#the-structure-of-message-functions">The Structure of Message Functions</a>.</p>
<p>More than one object can sometimes particpate in a message function being called. For example a trigger might call its message function because a cursor collided with it. The <strong>this</strong> object in the trigger message function will refer to the trigger, but you can still get at the cursor because the colliding cursor has become a property of the trigger. Example:</p>
<pre><code>this.x;  // In a trigger&#39;s message function would get the x position of the trigger
this.cursor.x; //  In a trigger&#39;s message function is the x position of the colliding cursor</code></pre>
<p>Similarly in a curve message function, which would be called when a cursor hits a beat point on the curve:</p>
<pre><code>this.x;  //Gets the position of the beat point
this.cursor.xVelocity; //Gets the x velocity of the cursor when it hit the beat point</code></pre>
<p>You will see this two-step way of referring to objects in some of the sample scores.</p>
<h5 id="setactive">setActive</h5>
<pre><code>setActive(id, active);</code></pre>
<p>To enable or disable an object set active to true or false. Disabling an object prevents it from sending messages. Example;</p>
<pre><code>addTrigger(99);
setActive(99, false);  //Disables the trigger.</code></pre>
<h5 id="setactivebeats">setActiveBeats</h5>
<pre><code>setActiveBeats(curveId, activeBeats)</code></pre>
<p>Define which of the beat points on a curve are active. Only active beats call the curve message function when the cursor collides with them. The activeBeats pattern is a text string of just “x” and “.” characters indicating active and inactive beat positions. The pattern is applied sequentially to all beat points starting with the first on the curve. If the activeBeats string is shorter than the number of beat points, it is recycled as many times as necessary. Example:</p>
<pre><code>setActiveBeats(99, &quot;x.x.xx..x.x.xx..&quot;);</code></pre>
<p>See <a href="#the-rhythm-processor">The Rhythm Processor</a> section for more detail.</p>
<h5 id="addcursor">addCursor</h5>
<pre><code>addCursor(curveId &lt;, cursorId&gt;);</code></pre>
<p>Cursors are not automatically added to curves created by scripting. Added a cursor of needed with the addCursor function. If both curveId and curveId are included then a cursor with cursorId is created and added to a curve with curveId. The curve must already exist.<br />
If cursorId is omitted then the new cursor’s id is automatically assigned and it is added to the curve with id curveId.</p>
<p>This example adds a 2 unit wide by 3 unit tall ellipse at position (1,2,0) with an id of 100. Then it adds a cursor with an id of 101:</p>
<pre><code>ellipseId = addEllipse(100,2,3,1,2,0);   
addCursor(ellipseId,101);</code></pre>
<h5 id="addcurve">addCurve</h5>
<pre><code>addCurve(id,x,y,z);</code></pre>
<p>Add a zero length curve with given id. It will be invisible until the script assigns segments or points to it. Use an id of -1 to choose the next available id.</p>
<p>This example adds a curve with id 1000 at position (0,0,0). Then it adds point number 0 which sets the starting position with respect to the curve position. Then adds another points, and then adds a Bezier curve. Entering “current” as the id in a function assumes the same id as in the previous function. Example:</p>
<pre><code>addCurve(1000);  //Adds a curve with id 1000 at position (0,0,0).
setPosition(1000,3,3,0);
setPointAt(&quot;current&quot;, 0,  -2, 1,0);  //Add point number 0. 
setPointAt(&quot;current&quot;, 1,  -2, 3,0);  //Add another point.
setPointBezierAt(&quot;current&quot;, 2,  2, 3,0,   +2, +2,0,   +0,+3,0 ); //Add Bezier segment
addCursor(1000,101); //Add cursor with id 101 to the curve (which was given id 1000)</code></pre>
<p>See <a href="#setpointat">setPointAt</a> for explanation of adding points to a curve.<br />
See <a href="#addcursor">addCursor</a> for more on adding cursors to curves. See <a href="#curve-drawing">Curve Drawing</a> for a detailed discussion of curve drawing.</p>
<p>Forms of addCurve:</p>
<pre><code>addCurve();  //Add a curve at 0,0,0 with next available id.
addCurve(200);  //Add a curve at x=0, y=0, z=0 with id 200.
addCurve(200,2,3);  //Add a curve at x=2, y=3, z=0 with id 200.
addCurve(200,2,3,-3);  //Add a curve at x=2, y=3, z=-3 with id 200.
addCurve(-1,2,3,-3);  //Add a curve at x=2, y=3, z=-3 with next available id.</code></pre>
<p>All “add” functions return the id of the object created. Example:</p>
<pre><code>crvId = addCurve(200,2,3,-3); //As above and crvId is set to 200.
crvId = addCurve(-1,2,3,-3); //As above and crvId is set to the auto-assigned id.</code></pre>
<h5 id="addellipse">addEllipse</h5>
<pre><code>addEllipse(curveId, width, height, x, y, z);</code></pre>
<p>Add a circle or ellipse with given id at position x, y, z. Use an id of -1 to auto-choose the next available id. If x, y, z are omitted the object is created at (0,0,0);</p>
<p>Forms of addEllipse:</p>
<pre><code>addEllipse(200,1,7); //Add ellipse of height 1, width 7 at 0,0,0, id 200.
addEllipse(200,1,7,2,3); //Add ellipse of height 1, width 7 at 2,3,0, id 200.
addEllipse(200,1,7,2,3,5); //Add ellipse of height 1, width 7 at 2,3,5, id 200.
addEllipse(-1,1,7,2,3,5); //Add ellipse of height 1, width 7 at 2,3,5, auto id.</code></pre>
<p>All “add” functions return the id of the object created. Example:</p>
<pre><code>ellId = addEllipse(200,1,7,2,3); //As above and ellId is set to 200.
ellId = addEllipse(-1,1,7,2,3,5); //As above and ellId is set to the auto-assigned id.</code></pre>
<p>For how to add a cursor to the curve see <a href="#addcursor">addCursor</a>.</p>
<h5 id="addtrigger">addTrigger</h5>
<pre><code>addTrigger(id,x,y,z);</code></pre>
<p>Add a trigger with given id at position x, y, z. Use an id of -1 to auto-choose the next available id. If x, y, z are omitted the trigger is created at (0,0,0); All add functions return the id of the object created.</p>
<p>Forms of addTrigger:</p>
<pre><code>addTrigger();  //Add a trigger at 0,0,0 with next available id.
addTrigger(200);  //Add a trigger at x=0, y=0, z=0 with id 200.
addTrigger(200,2,3);  //Add a trigger at x=2, y=3, z=0 with id 200.
addTrigger(200,2,3,-3);  //Add a trigger at x=2, y=3, z=-3 with id 200.
addTrigger(-1,2,3,-3);  //Add a trigger at x=2, y=3, z=-3 with next available id.</code></pre>
<p>All “add” functions return the id of the object created. Example:</p>
<pre><code>trgId = addTrigger(200,2,3,-3); //As above and trgId is set to 200.
trgId = addTrigger(-1,2,3,-3); //As above and trgId is set to what was the next id.</code></pre>
<h5 id="setautobeatinterval">setAutoBeatInterval</h5>
<pre><code>setAutoBeatInterval(id, ticks)</code></pre>
<p>Set the time interval in ticks between auto-messages. (A quarter note is 96 ticks).</p>
<p>Autocomplete in the editor includes definitons for many note intervals. e.g. noteQtr. Start typing “note” and a list of notes will pop up.</p>
<p>Example to set the autoBeat interval of trigger 212 to an eigth note trill, use:</p>
<p>setBeatInterval(212,note8thTrill);</p>
<h5 id="setpopuplabel">setPopupLabel</h5>
<p>setPopupLabel(id, a, b, c, d, e, f, g, h);</p>
<p>Assign up to eight items to appear when the pointer hovers over the object or the object is selected. Example:</p>
<pre><code>addTrigger(150,2,-1,0);  //Create a trigger
//Add two labels: &quot;Hello World&quot; and the object&#39;s x position:
setPopupLabel(150, &quot;Hello World&quot;,_obj(150).x);  </code></pre>
<p>If you hover the mouse pointer over the trigger or click on it you will see the two part popup label of “Hello World” and the x position of the object. If the data to be displayed is continually changing such as the object position you may want to have the label continually updated which you can do by putting the command in the onPaint() <a href="#score-callbacks">callback</a>. However don’t put any more code than necessary in the callback or it could slow the updating of the score.</p>
<h5 id="autosize">autoSize</h5>
<p>autoSize(doAutosize)</p>
<p>Enable or disable adjusting trigger size for better visiblility as the score is zoomed. Set to true or false.</p>
<h5 id="setbackground">setBackground</h5>
<pre><code>setBackground(filePath, topLeftX, topLeftY, bottomRightX, bottomRightY);</code></pre>
<p>Set background image from image file. Use file=“” to resize current image. Example:</p>
<pre><code>setBackground(&quot;/Users/chrisgr/Pictures/MyPicture.jpg&quot;, -5, 5, 5, -5);</code></pre>
<p>This loads a picture called “MyPicture.jpg” that is in the Pictures folder on my system and sets it as a background image of size with upper left at (-1,5) and lower right at (5,-5). Of course you need to use the path to the picture on your system.</p>
<p>Note that it is easy to change images by dragging and dropping them onto the score background. You can find the file path of the current background image from the backgroundFile property of the _score object. For example the following print statement into the editor and execute the line with Command+. .</p>
<pre><code>print(_score.backgroundFile); </code></pre>
<p>It will print the complete path in the output area. Copy and paste this path as the filePath of the setBackground command and the script will load that same image. Remember to enclose the file path in quotes.</p>
<h5 id="setbeatemphasis">setBeatEmphasis</h5>
<pre><code>setBeatEmphasis(curveId, beatEmphasis)</code></pre>
<p>Define beat emphasis pattern for beats on a curve. e.g. beatEmphasis = “8575”. See <a href="#the-rhythm-processor">The Rhythm Processor</a> section for more detail.</p>
<h5 id="setbeatinterval">setBeatInterval</h5>
<pre><code>setBeatInterval(id, ticks)</code></pre>
<p>Set the time interval in ticks between the beats on a curve. (A quarter note is 96 ticks). See <a href="#the-rhythm-processor">The Rhythm Processor</a> section for more detail.</p>
<p>Autocomplete in the editor includes definitons for many note intervals. e.g. noteQtr. Start typing “note” and a list of notes will pop up.</p>
<p>Example to set the interval of the beat points on curve 99 to eigth notes, use:</p>
<p>setBeatInterval(99,note8th);</p>
<h5 id="setbeatpoints">setBeatPoints</h5>
<pre><code>setBeatPoints(curveId, pattern)</code></pre>
<p>Define pattern of beat points for a curve e.g. Use beatPoints = “b 32 4”, or “e 16 9 0 2”. See <a href="#the-rhythm-processor">The Rhythm Processor</a> section for more detail.</p>
<h5 id="setbeattrigger">setBeatTrigger</h5>
<pre><code>setBeatTrigger(triggerId, curveId, pointNumber) </code></pre>
<p>Attach a trigger to a curve on a given beat point number. See <a href="#the-rhythm-processor">The Rhythm Processor</a> section for more detail.</p>
<h5 id="setbpm">setBPM</h5>
<p>setBPM(speedInBPM);</p>
<p>Set the master playing speed of the score in beats per minute. Example:</p>
<pre><code>setBPM(120);  See the speed in the transport to 120 bpm. </code></pre>
<h5 id="center">center</h5>
<pre><code>center(x, y);</code></pre>
<h5 id="setchord">setChord</h5>
<pre><code>setChord(id,value);</code></pre>
<p>Set the chord for either the score or an object with given id. (e.g. chMinor, chMaj7) Omit the id to refer to the score.</p>
<p>Specify the coordinate to be located in the center of the viewport. Enter center() for x=0, y=0.</p>
<h5 id="clear">clear</h5>
<pre><code>clear();</code></pre>
<p>Remove all objects in the workspace.</p>
<h5 id="clearselection">clearSelection</h5>
<pre><code>clearSelection();</code></pre>
<p>Remove the selection marquee.</p>
<h5 id="setcolor">setColor</h5>
<pre><code>setColor(id, red, green, blue, alpha);</code></pre>
<p>Set the color of an object for all its states. Values of red, green, blue, alpha in range of 0 .. 255. Alpha is optional.</p>
<pre><code>setColor(id, colorName);</code></pre>
<p>Set the color of an object for all its states using the color name. The color name must have been previously defined. Example:</p>
<pre><code>id = addTrigger(1,0,0,0); //Add trigger at 0,0,0
registerColor(&quot;myOrange&quot;,250,130,50,200); //Create a color
setColor(id,&quot;myOrange&quot;);  //Assign it to the trigger</code></pre>
<p>This allows you to change the colors of all objects with the color “myOrange” by using registerColor to define different values for myOrange.</p>
<p>For more detail see <a href="#object-colors">Object Colors</a>.</p>
<h5 id="setcolor01">setColor01</h5>
<pre><code>setColor01(id, red, green, blue, alpha);</code></pre>
<p>Set the color of an object for all its states. Values of red, green, blue, alpha in range of 0 .. 1. Alpha is optional.</p>
<p>For more detail see <a href="#object-colors">Object Colors</a>.</p>
<h5 id="setcoloractive">setColorActive</h5>
<pre><code>setColorActive(id, red, green, blue, alpha); </code></pre>
<p>Set the color of an object for when it is active. Values of red, green, blue, alpha in range of 0 .. 255. Alpha is optional.</p>
<p>For more detail see <a href="#object-colors">Object Colors</a>.</p>
<h5 id="setcoloractivecurve">setColorActiveCurve</h5>
<pre><code>setColorActiveCurve(id, red, green, blue, alpha)</code></pre>
<p>Set color of trigger for when it is attached to a beat-point. Values of red, green, blue, alpha in range of 0 .. 255. Alpha is optional.</p>
<p>For more detail see <a href="#object-colors">Object Colors</a>.</p>
<h5 id="setcoloractivehue">setColorActiveHue</h5>
<pre><code>setColorActiveHue(id, hue, saturation, value, alpha);</code></pre>
<p>Set the color of an object for when it is active. Values of hue, saturation, value, alpha in range of 0 .. 255. Alpha is optional.</p>
<p>For more detail see <a href="#object-colors">Object Colors</a>.</p>
<h5 id="setcolorhue">setColorHue</h5>
<pre><code>setColorHue(id, hue, saturation, value, alpha);</code></pre>
<p>Set the color of an object for all its states. Values of hue, saturation, value, alpha in range of 0 .. 255. Alpha is optional.</p>
<p>For more detail see <a href="#object-colors">Object Colors</a>.</p>
<h5 id="constrain">constrain</h5>
<pre><code>constrain(value, min, max);</code></pre>
<p>Constrain a value to a range by clipping at max and min.</p>
<h5 id="setcursorheight">setCursorHeight</h5>
<pre><code>setCursorHeight(cursorId, height);</code></pre>
<p>Set the size of the cursor in the z dimension. This is most useful if the cursor is on a curve that is above the xy plane and you want to enable it to collide with triggers above or below xy plane. i.e. If either the curve or some triggers have values where their z coordinate is not zero.</p>
<h5 id="setcursorwidth">setCursorWidth</h5>
<pre><code>setCursorWidth(cursorId, widthL, widthR);</code></pre>
<p>Set the size of the left and right side of the cursor.</p>
<h5 id="setcurve">setCurve</h5>
<pre><code>setCurve(cursorId, curveId);</code></pre>
<p>Assign an unattached cursor to a curve.</p>
<h5 id="setcurvesize">setCurveSize</h5>
<pre><code>setCurveSize(curveID, width, height);</code></pre>
<p>Change the size of an existing curve.</p>
<h5 id="setcycles">setCycles</h5>
<pre><code>setCycles(cursorID, cycles);</code></pre>
<p>Define the number of cycles a cursor should operate before stopping. Use -1 for unlimited cycles. After this number of cycles the cursor stops moving and stops triggering messages due to collisions. Its autoMessages also stop. Examples:</p>
<pre><code>setCycles(33,6); //Set cursor 33 to run for six cycles and then stop.
setCycles(33,-1); //Set cursor 33 to run as long as the transport is running.    </code></pre>
<h5 id="dist">dist</h5>
<pre><code>dist(x1, y1, z1, x2, y2, z2);</code></pre>
<p>Distance between two points. Examples:</p>
<pre><code>dist(0,0,0, 3, 4, 0);  //Distance from origin to point (3,4,0).  Returns 5
dist(0,0,0, 2, 2, 2);  //From origin to point (2,2,2).  Returns 3.4641016151377544</code></pre>
<h5 id="setduration">setDuration</h5>
<p>setDuration(cursorId, duration);</p>
<p>Set the time it takes for a cursor to go around its curve.</p>
<h5 id="setgroup">setGroup</h5>
<pre><code>setGroup(id, groupName);</code></pre>
<p>Assign an object to a group. The name of the group is entered as a text string. Example:</p>
<pre><code>triggerId = addTrigger(); //New trigger.  Next available id.  Assign id to triggerId.
setGroup(triggerId, &quot;MyGroup2&quot;); //Assign it to a group called MyGroup2.</code></pre>
<h5 id="sethidden">setHidden</h5>
<pre><code>setHidden(id, hide);</code></pre>
<p>Set an object to be hidden or visible. Set hide to be true or false. Examples:</p>
<pre><code>triggerId = addTrigger(); //New trigger.  Next available id.  Assign id to triggerId.
setHidden(triggerId, true);    //Hide it
setHidden(triggerId, false);    //Reveal it</code></pre>
<h5 id="sethideinactive">setHideInactive</h5>
<pre><code>setHideInactive(id, hideInactive);</code></pre>
<p>Set an object to be hidden if inactive. Use hideInactive = true or false.</p>
<h5 id="setimage">setImage</h5>
<pre><code>setImage(id, imageName);</code></pre>
<p>Assign an image to a trigger. Image must be first registered with registerImage().</p>
<p>See [Assigning Images to an Objects] for more detail.</p>
<h5 id="setimageactive">setImageActive</h5>
<pre><code>setImageActive(id, imageName);</code></pre>
<p>Assign an image to a trigger that is only used when the trigger is active.</p>
<p>See [Assigning Images to an Objects] for more detail.</p>
<h5 id="setimageactivecurve">setImageActiveCurve</h5>
<pre><code>setImageActiveCurve(id, imageName);</code></pre>
<p>Assign an image to a trigger that is only used if on the beat-point of a curve.</p>
<p>See [Assigning Images to an Objects] for more detail.</p>
<h5 id="invert">invert</h5>
<pre><code>invert(scale,inversion);</code></pre>
<p>Musically invert a chord or scale.</p>
<h5 id="itoa">itoa</h5>
<pre><code>itoa(i);</code></pre>
<p>Return the text character with ascii character code i.</p>
<h5 id="setlabel">setLabel</h5>
<pre><code>setLabel(id, label);</code></pre>
<p>Set a text label for an object. (Click the “Abc” toolbar button to see labels.)</p>
<h5 id="setline">setLine</h5>
<pre><code>setLine(id, dashStyle, dashPattern );</code></pre>
<p>Define curve’s line in terms of dash-style and dash-pattern.</p>
<h5 id="setlinethickness">setLineThickness</h5>
<pre><code>setLineThickness(objectId, thickness);</code></pre>
<p>Set the thickness of a curve or cursor.</p>
<h5 id="map">map</h5>
<pre><code>map(value,lowVal,highVal,lowVal2,highVal2);</code></pre>
<p>Rescale val in range lowVal1..highVal1 to range lowVal2..highVal2.</p>
<h5 id="maplist">mapList</h5>
<pre><code>mapList(value, lowValue, highValue, list)</code></pre>
<p>Chooses an item out of a list by proportionally mapping a value’s position in a range into an item in the list. Example:</p>
<pre><code>mapList(0.0, 0, 1, [3,4,5]);  //Would choose 3 from the list
mapList(0.5, 0, 1, [3,4,5]);  //Would choose 4 from the list
mapList(1.0, 0, 1, [3,4,5]);  //Would choose 5 from the list        </code></pre>
<h5 id="mapchord">mapChord</h5>
<pre><code>mapChord(value, low, high, rangeLow, range, tonic, root, chordNotes);</code></pre>
<p>Deprecated. Use <a href="#mapharmony">mapHarmony</a>.</p>
<h5 id="mapharmony">mapHarmony</h5>
<pre><code>mapHarmony(value, lowValue, highValue, rangeLow, range, tonic, root, notes) </code></pre>
<p>Proportionally maps a numeric value to a note chosen to match the current harmony settings: the chord or scale and note range. Whether the chord or scale is mapped-to is determined by the setting of the “mapNotesTo” property. By default this would be this would be the setting for “mapNotesTo” for the score, however for any object you can override this by changing the object’s “mapNotesTo” from “Score” to either “Chord” or “Scale”.</p>
<p>Most often mapHarmony used in the form:</p>
<pre><code>mapHarmony(value, lowValue, highValue);</code></pre>
<p>This results in the note range and harmony information being taken from the current settings for the score, which may also have been overridden by values for the object triggering the message where mapHarmony is used.</p>
<p>The input value to map must be between lowValue and highValue. The mapHarmony function returns a midi note number which is guaranteed to be in the note range set by the score/object properties, and in the current chord or scale depending on the setting of mapNotesTo.</p>
<p>Additional arguments may be supplied to override the score/object settings. Arguments may be omitted starting at the right. Any that remain omitted are replaced with values from the currently prevailing harmony. All arguments to the left of one that is supplied must also be supplied.</p>
<p>Example:</p>
<pre><code>mapHarmony(this.r,0.0,1.0);</code></pre>
<p>In a message function this will map the red component of the pixel behind the object into a note using the object’s current note range, tonic, root and chord (assuming mapNotesTo was set to “Chord”. (colors are expressed as a numbers between 0.0 … 1.0).</p>
<p>The following example is the same but overrides the currently prevailing note mapping range and replaces it with a custom range from note number 30 up to 30+24=54. One use of this would be to define a lower range of notes to be generated by some object that is to provide bass notes to a composition</p>
<pre><code>mapHarmony(this.r,0,1,30,24);</code></pre>
<p>For more information see <a href="#the-harmony-processor">The Harmony Processor</a>.</p>
<h5 id="setmapnotesto">setMapNotesTo</h5>
<pre><code>setMapNotesTo(id,mapOption) </code></pre>
<p>Choose whether to map notes to the “Scale” or the “Chord”. For objects you can also set the mapping to “Score” which means to use the same choice as was made for the entire score. Omit the id to set the property for the score. Enter the id if it is for an object. Set mapOption to be one of the text values “Scale” or “Chord”, or for objects only to “Score”.</p>
<h5 id="mapscale">mapScale</h5>
<pre><code>mapScale(value, low, high, rangeLow, range, tonic, root, scaleNotes);</code></pre>
<p>Deprecated. Use <a href="#mapharmony">mapHarmony</a>.</p>
<h5 id="mappingnotes">mappingNotes</h5>
<pre><code>mappingNotes(value, lowValue, highValue, rangeLow, range, tonic, root, notes);</code></pre>
<p>Returns a Javascript array of the note numbers that match the current harmony settings. This is the set of notes that mapHarmony chooses a value from. The arguments for mappingNotes are the same as for mapHarmony. See <a href="#mapharmony">mapHarmony</a> for details.</p>
<p>The difference between mapHarmony and mappingNotes is that mapHarmony returns a specific note that has been chosen based on the value it has been passed, whereas mappingNotes returns the entire list of notes.</p>
<p>For simple harmony mapping all you need to know is mapHarmony. However you might use mappingNotes for some special purpose such as scripting a custom arpeggiator. See <a href="#scripting-arpeggiators">Scripting Arpeggiators</a>.</p>
<p>For more information see <a href="#the-harmony-processor">The Harmony Processor</a>.</p>
<div id="midi">

</div>
<div id="note">

</div>
<h5 id="midi.note">midi.note</h5>
<pre><code>midi.note(port,channel,noteNumber,velocity,duration&lt;&lt;,minDuration&gt;,monoOption&gt;);</code></pre>
<p>Send a midi note with a duration. A note off is automatically sent after the duration has elapsed unless that score has sent another note note-on with the same note number before the previous note has ended. The arguments are:</p>
<ul>
<li>port: a string containing one of the four virtual port names, “vMidi1” through “vMidi4”. In message functions this.port is often used to refer to that object’s defined port which may be changed in the Property Inspector. The entered property would still be one of “vMidi1” through “vMidi4” but it’s convenient to be able to change the port as if it were an object property.</li>
<li>channel: A number from 1 .. 16. In message functions this.channel is often used to refer to that object’s defined channel which may be changed in the Property Inspector. The entered property would still be in integer from 1 .. 16 but it’s convenient to be able to change the channel as if it were an object property.</li>
<li>noteNumber: An integer in the range 0 .. 127</li>
<li>velocity: An integer in the range 1 .. 127 (0 means note-off)</li>
<li>duration: Duration until a note-off is sent, in milliseconds. The note may last a shorter time than requested if the score sends another note with the same number before the previous note would have ended.</li>
<li>minDuration: Optional. Sets the minimum time this note should last even if the score tries to send another note with this number. If a note with this number is sent within the minDuration the note is ignored.
<div id="curvemono">

</div>
<div id="groupmono">

</div>
<div id="channelmono">

</div></li>
<li>monoOption: Optional but if entered, minDuration must also have been entered. The monoOption is a string that may be one of: “curveMono”, “groupMono”, or “channelMono”. If this option is specified then only one note (no matter what the note number) may be sounding for this category. For example if a “groupMono” was specified when an object in this group started a note then as soon as another object in this group tries to start a note, the previous note is forced off as long as minDuration has passed. Note offs and note ons are overlapped so that the transitions are legato.</li>
</ul>
<p>The minDuration option is a way to thin the number of notes that are sounding at the same time. For example a cursor may sweep across a large number of triggers result in an a large number of notes as short as a few milliseconds, which may or may not be what you want. In this case you could set minDuration to say 100 or 200 milliseconds and note-ons that would have produced note-offs shorter than this would be ignored, which can often sound more musical, or lighten the load on your midi transmission or your synth.</p>
<p>The monoOption feature is another way of dealing with too many notes, in this case by reducing the number of notes that are sounding at the same time. For example you may sending notes with long durations, say for some ambient composition, but under some conditions too many notes may be starting so too many are overlapping, and the sound gets too thick. You can overcome this by for example having cursor message send notes with a curveMono option which results in only one note at a time being allowed for this entire curve.</p>
<p>Another use for mono options is playing a monosynth patch where only one note is intended to be sounding at a time. You might put this patch on a given midi channel and send its notes with “channelMono” and Geosonix will send a note-off of the current note before the next noteo-on.</p>
<p>These things will be covered more completely in a future tutorial.</p>
<div id="noteon">

</div>
<h5 id="midi.noteon">midi.noteOn</h5>
<p>midi.noteOn(port, channel, noteNumber, velocity);</p>
<p>Send note with no scheduled note off. Velocity in range 0..127. This message is useful to start a sustained midi note and then alter the sound with midi controllers. The note will continue to be on until you send a noteOn with a velocity of zero.</p>
<p>For details of the arguments see <a href="#midi.note">midi.note</a>.</p>
<p>Here is how to start a note, pan it with a midi controller and eventually stop it:</p>
<pre><code>midi.noteOn(&quot;vMidi1&quot;, 1, 60, 127);  //Send note number 60, channel 1, velocity 127.
//Repeatedly Send cc 10 (pan) on channel 1 based on the red pixel behind the object
midi.cc01(&quot;vMidi1&quot;, 1, 10, this.r);  //This line must be in a message function
//....Eventually, send note number 60 at velocity 0 to turn note off
midi.noteOn(&quot;vMidi1&quot;, 1, 60, 0);  </code></pre>
<div id="cc">

</div>
<h5 id="midi.cc">midi.cc</h5>
<pre><code>midi.cc(port,channel,ccNumber,value);</code></pre>
<p>Send a midi continuous controller. Value in range 0 .. 127. The arguments are:</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>ccNumber: The MIDI controller number ranging from 0 to 127.</li>
<li>value: The value to send to this controller, ranging from 0 to 127.</li>
</ul>
<p>See sample score “3d henon map with midi cc.score” for an example of sending a controller.</p>
<div id="cc01">

</div>
<h5 id="midi.cc01">midi.cc01</h5>
<pre><code>midi.cc01(port,channel,ccNumber,value);</code></pre>
<p>Send a midi continuous controller. Value in range 0.0 .. 1.0</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>ccNumber: The MIDI controller number ranging from 0 to 127.</li>
<li>value: The value to send to this controller, ranging from 0.0 to 1.0.</li>
</ul>
<div id="bend">

</div>
<h5 id="midi.bend">midi.bend</h5>
<pre><code>midi.bend(port, channel, value);</code></pre>
<p>Send midi bend. Value in range 0 .. 16383. Use 8,192 for no bend.</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>bend: The bend amount ranging from 0 to 16383 with zero bend being 8192.</li>
</ul>
<div id="bend01">

</div>
<h5 id="midi.bend01">midi.bend01</h5>
<pre><code>midi.bend01(port, channel, value);</code></pre>
<p>Value in range -1.0 .. 1.0. Use 0.0 for no bend.</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>bend: The bend amount ranging from -1.0 to 1.0 with zero bend being 0.0. This is more convenient to work with when converting from score parameters to bend amounts.</li>
</ul>
<div id="programchange">

</div>
<h5 id="midi.programchange">midi.programchange</h5>
<pre><code>midi.programchange(port, channel, instrumentNumber);</code></pre>
<p>Send a midi <a href="http://www.blitter.com/~russtopia/MIDI/~jglatt/tech/midispec/pgm.htm">program change</a>.</p>
<p>This is the MIDI message used to specify the “instrument” that should play on a synth. For the meaning of program change for your synthesizers, consult their documentation. If you’re using a General MIDI synth then program numbers refer to specific instruments. For example 57 would select a trumpet on a GM synth.</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>instrumentNumber: A number ranging from 0 to 127.</li>
</ul>
<div id="channelpressure">

</div>
<h5 id="midi.channelpressure">midi.channelpressure</h5>
<p>midi.channelpressure(port, channel, value);</p>
<p>Sends MIDI <a href="http://www.blitter.com/~russtopia/MIDI/~jglatt/tech/midispec/pressure.htm">channel pressure</a>.</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>value: A number ranging from 0 to 127.</li>
</ul>
<div id="channelpressure01">

</div>
<h5 id="midi.channelpressure01">midi.channelpressure01</h5>
<p>midi.channelpressure01(port, channel, value);</p>
<p>Sends MIDI <a href="http://www.blitter.com/~russtopia/MIDI/~jglatt/tech/midispec/pressure.htm">channel pressure</a>.</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>value: A number ranging from 0.0 to 1.0.</li>
</ul>
<div id="aftertouch">

</div>
<h5 id="midi.aftertouch">midi.aftertouch</h5>
<p>Sends MIDI <a href="http://www.blitter.com/~russtopia/MIDI/~jglatt/tech/midispec/aftert.htm">aftertouch</a>.</p>
<p>midi.aftertouch(port, channel, note, value);</p>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>note: The number of the on-note to control with aftertouch.</li>
<li>value: A number ranging from 0 to 127.</li>
</ul>
<div id="aftertouch01">

</div>
<h5 id="midi.aftertouch01">midi.aftertouch01</h5>
<p>Sends MIDI <a href="http://www.blitter.com/~russtopia/MIDI/~jglatt/tech/midispec/aftert.htm">aftertouch</a>.</p>
<pre><code>midi.aftertouch01(port, channel, note, value);</code></pre>
<ul>
<li>port, channel: See <a href="#midi.note">midi.note</a>.</li>
<li>note: The number of the on-note to control with aftertouch.</li>
<li>value: A number ranging from 0.0 to 1.0.</li>
</ul>
<div id="system">

</div>
<h5 id="midi.system">midi.system</h5>
<p>midi.system(port, value1, value2, value3);</p>
<p>All MIDI messages are sent as three numbers ranging from 0 .. 127. By specifying these three numbers midi.system message allows you to send <strong>any</strong> MIDI message. This is an advanced topic. Consult a detailed MIDI <a href="http://www.blitter.com/~russtopia/MIDI/~jglatt/tech/midispec.htm">specification</a>.</p>
<h5 id="setmidiport">setMidiPort</h5>
<pre><code>setMidiPort(id, port);</code></pre>
<p>Set the midi port of of an object. The default port for objects is “vMidi1” so it’s only necessary to specify this if it’s a different port. The port is entered as a quoted string. Example:</p>
<pre><code>setMidiPort(100, &quot;vMidi2&quot;); //Object 100 will use vMidi2</code></pre>
<h5 id="setmidinote">setMidiNote</h5>
<pre><code>setMidiNote(id, note);</code></pre>
<p>Set the midi note number property of an object. This would only have an effect if you are using the note property in the message function. The note number must be in the range 0 .. 127 although notes lower than about 30 or above about 110 may be too low or high to hear.</p>
<h5 id="setmidicontroller">setMidiController</h5>
<pre><code>setMidiController(id, controller);</code></pre>
<p>Set the midi controller number property of an object. This will only have an effect if you are using the controller property in the message function.</p>
<h5 id="setmidichannel">setMidiChannel</h5>
<pre><code>setMidiChannel(id, channel);</code></pre>
<p>Set the midi channel number of an object. This would override the score midi channel. The channel must be in the range 0 .. 16.</p>
<div id="osc">

</div>
<div id="newmsg">

</div>
<h5 id="osc.newmsg">osc.newMsg</h5>
<pre><code>osc.newMsg(QString port, QString address);</code></pre>
<p>Create a new OSC message. e.g. osc.newMsg(“vOsc1”,“/reset”);</p>
<div id="addstring">

</div>
<h5 id="osc.addstring">osc.addString</h5>
<p>osc.addString(QString str);</p>
<p>Append a string to OSC message. e.g. osc.addFloat(“Hello”);</p>
<div id="addfloat">

</div>
<h5 id="osc.addfloat">osc.addFloat</h5>
<pre><code>osc.addFloat(qreal value);</code></pre>
<p>Append a number of the OSC message. e.g. osc.addFloat(1);</p>
<div id="msgsend">

</div>
<h5 id="osc.msgsend">osc.msgSend</h5>
<pre><code>osc.msgSend();</code></pre>
<p>Send a previously prepared OSC message. e.g. osc.msgSend();</p>
<h5 id="monitor">monitor</h5>
<pre><code>monitor(val1,val2, ...);</code></pre>
<p>Print values to the message monition.</p>
<h5 id="nearestinlist">nearestInList</h5>
<pre><code>nearestInList(val, array);</code></pre>
<p>Returns item in array closest to given value.</p>
<h5 id="nearestinscale">nearestInScale</h5>
<pre><code>nearestInScale(note, scaleList, stepsPerOctave);</code></pre>
<p>Round note to nearest note in scale.</p>
<h5 id="newscore">newScore</h5>
<pre><code>newScore(name);</code></pre>
<p>Create a new score with given name. Enter newScore() to use default name.</p>
<h5 id="norm">norm</h5>
<pre><code>norm(val,lowVal,highVal);</code></pre>
<p>Rescale val ranging from lowVal to highVal into range of 0.0 .. 1.0.</p>
<h5 id="setorigin">setOrigin</h5>
<pre><code>setOrigin(x, y, z);</code></pre>
<p>Define an offset to be added to positions defined by setPosition.</p>
<h5 id="setpattern">setPattern</h5>
<pre><code>setPattern(cursorId, pattern);</code></pre>
<p>Set direction and speed of cursor on each cycles e.g. “1 2 4”.</p>
<h5 id="play">play</h5>
<pre><code>play(speed);</code></pre>
<p>Start score at given speed in beats per minute. Enter play() to start with current speed.</p>
<h5 id="plot">plot</h5>
<pre><code>plot(nPts, fX, fY, fZ, iStart, x0, y0, z0);</code></pre>
<p>Plot a parametric 3D curve.</p>
<h5 id="plotpolar">plotPolar</h5>
<pre><code>plotPolar(nPts, fTheta, fR, fPhi, iStart, theta0, r0 ,phi0);</code></pre>
<p>Plot a 3D curve using polar coordinates.</p>
<h5 id="setpointat">setPointAt</h5>
<pre><code>setPointAt(curveId,pointNumber,xCoord,yCoord,zCoord);</code></pre>
<p>Add straight segment to curve. Coordinates are relative to the zero point of this curve (not global score coordinates). Copy this to the script editor and execut it one line at a time:</p>
<pre><code>addCurve(1000);  //Adds a curve with id 1000 at position (0,0,0).
setPosition(1000,3,3,0);
setPointAt(&quot;current&quot;, 0,  2, 1,0);  //Add point number 0. 
setPointAt(&quot;current&quot;, 1,  0, 3,0);  //Add another point.</code></pre>
<p>Point number 0 will not be at score coordinates (2,1,0), but at (5,4,0) which is computed as (3+2, 3+1, 0+0). The global position of point number 1 is (3,6,0) which is (3+0, 3+3, 0+0). If you pasted the and executed the above code in the editor try changing the numbers and re-executing to get a feel for how this works.</p>
<p>See <a href="#curve-drawing">Curve Drawing</a> for a detailed discussion of curve drawing.</p>
<h5 id="setpointbezierat">setPointBezierAt</h5>
<pre><code>setPointBezierAt(curveId, pointNumber,  xCoord, yCoord, zCoord, 
                                        dxStart, dyStart, dzStart, 
                                        dxEnd, dyEnd, dzEnd);</code></pre>
<p>Add a segment to a Bezier curve. For more information see <a href="#draw-a-path-of-bezier-curves">Draw a Path of Bezier Curves</a>.</p>
<p>See <a href="#curve-drawing">Curve Drawing</a> for a detailed discussion of curve drawing.</p>
<h5 id="setpointsellipse">setPointsEllipse</h5>
<pre><code>setPointsEllipse(curveId, width, height);</code></pre>
<p>Convert an existing curve into a circle or ellipse.</p>
<p>See <a href="#curve-drawing">Curve Drawing</a> for a detailed discussion of curve drawing.</p>
<h5 id="setpointstxt">setPointsTxt</h5>
<pre><code>setPointsTxt(curveId, scaleFactor, font, textString);</code></pre>
<p>Convert an existing curve into a path based on a string of text characters.<br />
See <a href="#draw-a-path-from-text">Draw a Path From Text</a> for more information. See <a href="#curve-drawing">Curve Drawing</a> for a detailed discussion of curve drawing.</p>
<h5 id="setposition">setPosition</h5>
<pre><code>setPosition(id, x, y, z);</code></pre>
<p>Sets the position of the an object on the score. Example:</p>
<pre><code>addTrigger(99); //Add a trigger with id 99 at the default location of (0,0,0)
setPosition(99,4,6,1);   //Move it to (4,6,1)
setPosition(99,-4,-1,0);   //Move it again to (-4,-1,0)</code></pre>
<h5 id="print">print</h5>
<pre><code>print(val1,val2, ...);</code></pre>
<p>Print values to console. Any number of items from 1 to 10 can be printed. Examples:</p>
<pre><code>print(&quot;Geosonix is cool!&quot;); // Print the phrase to the console
print(random(2,13));  //Generate a random number from 2..13 and print it.
myTrig = addTrigger(-1,2,5.43); Add trigger, auto id at x=2,y=5.43. Put id in myTrig
myTrgObj = _obj(myTrig);  //Use id in myTrig to make a JS version of the object
print(myTrgObj.id, myTrgObj.x, myTrgObj.y); Print id and position of the trigger</code></pre>
<p>You can also use the print function in message functions. For example this use of print will cause it to output all the midi data for each note that this message function is triggered to send. This is very useful in understanding what message functions are doing:</p>
<pre><code>function cursorAutoMessage() {
  note = mapHarmony(this.r,0,1); //Create a note based on the red pixel behind cursor
  vel = map(this.g,0,1,20,127); //Create velocity mapped from green pixel
  dur = map(this.b,0,1,50,2500); //Create a duration mapped from the blue pixel
  //Print the port, channel, note number, velocity and duration:
  print(this.port,this.channel,note,vel,dur);
  midi.note(this.port,this.channel,note,vel,dur) //Send this midi note
}</code></pre>
<p>However don’t leave frequently called print statements active in your script as outputting text takes considerable CPU resources. You can make print statements inactive by inserting “//” at the start of the line. i.e. Commenting them out as is usual in Javascript. For example change the print statement in the above example to:</p>
<pre><code>//print(this.port,this.channel,note,vel,dur);</code></pre>
<p>Then re-evaluate the function to cause the change to take effect. A quick way to do re-evaluate a singe function is to put the text cursor anywhere in the function and press the “Function” button below script editor or use the Command+’ keyboard shortcut.</p>
<p>A useful shortcut for commenting one or more lines of code is to select them and press Command+Option+/ . To remove the comment marks repeat this. You still need to re-evaluate the code containing the commented lines for the change to take effect.</p>
<p>To restore the ability of a commented-out line to operate remove the “//” and re-evaluate again as above.</p>
<h5 id="random">random</h5>
<pre><code>random(low, high);</code></pre>
<p>Return a random number in the range low to high. Example:</p>
<pre><code>print(random(2,13));  //Generate a random number from 2..13 and print it</code></pre>
<p>Copy the above line to the script editor, put the text cursor in that line and use Command+. to repeatedly evaluate it. Each time it will print a random number chosen from 2..13 in the output console.</p>
<h5 id="rnd">_rnd</h5>
<pre><code>_rnd(max, min)</code></pre>
<p>Generates a repeatable sequence of pseudo random numbers, each number in the range min..max. Precede first call with Math.seed=someValue. A given seed produces the same number sequence on repeated calls for _rnd. Example:</p>
<pre><code>Math.seed = 42;
print(_rnd(0,10));  //Prints 3.82121913580247
print(_rnd(0,10));  //Prints 4.257291666666667
print(_rnd(0,10));  //Prints 1.1679012345678998</code></pre>
<p>If the seed is reset to 42 the same sequence will repeat. Starting with a different number will produce a different sequence.</p>
<p>This is useful if you want a parameter that varies in an apparently random way but is repeatable. For example if you add this to a score it will cause the seed to be reset each time the score is rewound with the transport.</p>
<pre><code>function onRewind() {  //This defines the onRewind callback function
    Math.seed = 42;
}</code></pre>
<p>Now you can use _rnd to produce numbers, say in a message function and every time the score is rewound and played it will sound the same. To seed a different repeatable sequence use any different number.</p>
<h5 id="randomchoose">randomChoose</h5>
<pre><code>randomChoose(probList, valueList);</code></pre>
<p>Randomly choose a value from valueList based on probabilities in probList. The first list is a Javascript array of probabilities, each in the range 0.0…1.0 and must add up to 1.0 for correct results. The second list is an array with a number of Javascript objects equal to the number of probabilities. Any type of Javascript objects can be in the second list. Example:</p>
<pre><code>randomChoose([.1,.4,.5],[&quot;rock&quot;,&quot;paper&quot;,&quot;scissors&quot;]); //Chooses from a list of three words</code></pre>
<p>Paste this line into the script editor and execute it repeatedly. This will print one of the words each time. “rock” will be printed approximately 10% of the time, “paper” 40% of the time, and “scissors” 50% of the time.</p>
<h5 id="range">range</h5>
<pre><code>range(value, lowValue, highValue);</code></pre>
<p>Scale a value of 0..1 into the range lowValue .. highValue. Examples:</p>
<pre><code>range(0.3, 23, 87); //Returns 42.2 which is the number 0.3 of the distance from 23 to 87.</code></pre>
<p>When used in a message function the following example will return a number for output to a midi controller (range 0..127) scaled from the strength of the red component of the pixel behind the object. The “r” refers to object property that is the red component of the pixel of the background image behind the object at the moment this message function was triggered. These color properties are always in the range 0.0 for no color to 1.0 for maximum strength color.</p>
<pre><code>range(this.r,0,127);</code></pre>
<h5 id="rangemid">rangeMid</h5>
<pre><code>rangeMid(value, low, mid, high);</code></pre>
<p>Rescale a value into a range with peak at mid.</p>
<h5 id="registercolor">registerColor</h5>
<pre><code>registerColor(name,red,green,blue,alpha);</code></pre>
<p>Define a named color using the RGBA color system for future reuse. See <a href="#setcolor">setColor</a> for an example of use.</p>
<h5 id="registercolorhue">registerColorHue</h5>
<pre><code>registerColorHue(name,hue,saturation,value,alpha);</code></pre>
<p>Define a named color using the HSVA color system for future use.</p>
<h5 id="registerimage">registerImage</h5>
<pre><code>registerImage(assignTo,xTopLeft,yTopLeft,xBottomRight,yBottomRight,filePath);</code></pre>
<p>Load an image from a file and give it a name or use in assigning it to objects.</p>
<p>See <a href="#registering-and-naming-an-image">Registering and Naming an Image</a>.</p>
<h5 id="remove">remove</h5>
<pre><code>remove(id);</code></pre>
<p>Delete an object from the score.</p>
<h5 id="reverse">reverse</h5>
<pre><code>reverse(list); </code></pre>
<p>Reverse order of notes in list. (Lists can store chords or scales.) Example:</p>
<pre><code>myChord = [0,4,7]; //A major triad
print(reverse(myChord));  //Prints [7,4,0]</code></pre>
<h5 id="rewind">rewind</h5>
<p>rewind();</p>
<p>Reset the playback time to 000:00.000.</p>
<h5 id="rotate">rotate</h5>
<pre><code>rotate(angleAboutXAxis,angleAboutYAxis,angleAboutZAxis);</code></pre>
<p>Change viewing angle of the score. Use rotate() for zero rotation.</p>
<h5 id="setscorespeed">setScoreSpeed</h5>
<pre><code>setScoreSpeed(speed);</code></pre>
<p>Set the master playing speed of the score where 1.0 is 60 bpm, 2.0 is 120 bpm, etc. See <a href="#setbpm">setBPM</a> for the command to set the speed directly in beats per minute.</p>
<h5 id="setrange">setRange</h5>
<pre><code>setRange(id,noteRange);</code></pre>
<p>Set the size of the note range for either the score or an object with given id. Omit the id to refer to the score.</p>
<h5 id="setrangelow">setRangeLow</h5>
<pre><code>setRangeLow(id,lowNote);</code></pre>
<p>Set the lowest note number of the range for either the score or an object with given id. Omit the id to refer to the score.</p>
<h5 id="setroot">setRoot</h5>
<pre><code>setRoot(id,root);</code></pre>
<p>Set the scale degree of the chord root (degI…degVII)for either the score or an object with given id. Omit the id to refer to the score.</p>
<p>Editor autocomplete includes defintions for the degrees of a major scale: degI=0; degII=2; degIII=4; degIV=5; degV=7; degVI=9; and degVII=11. Start typing “deg” in the editor and a list of the degrees will pop up. If you need a sharp or flat degree you can add or subtract one semitone from one of these degrees. Examples: e.g. A minor third would be (degIII-1);</p>
<pre><code>setRoot(degIII);  //Set the root for the score chord to be on the major third of the scale
setRoot(99, degVI-1); //Set the root of chord of object 99 to be on the a minor sixth of the scale</code></pre>
<h5 id="setscale">setScale</h5>
<pre><code>setScale(id,scaleName);</code></pre>
<p>Set the scale for either the score or an object with given id. (e.g. scMinor, scBlues). Omit the id to refer to the score.</p>
<h5 id="setsmoothpointat">setSmoothPointAt</h5>
<pre><code>setSmoothPointAt(id,pointNum,xCoord,yCoord,zCoord);</code></pre>
<p>Add curved segment to curve, tangent to previous segment. See <a href="#draw-a-path-of-lines-with-curved-corners">Draw a Path of Lines With Curved Corners</a> for more information.</p>
<h5 id="setspeedmultiplier">setSpeedMultiplier</h5>
<pre><code>setSpeedMultiplier(cursorId, localSpeed);</code></pre>
<p>Set the speed of a cursor as multiplier times the master transport speed.</p>
<h5 id="stop">stop</h5>
<pre><code>stop();</code></pre>
<p>Stop the score playing</p>
<h5 id="settimelagmultiplier">setTimeLagMultiplier</h5>
<pre><code>setTimeLagMultiplier(id, multiplier);</code></pre>
<p>Set time lag multiplier. Total lag is timeLagMultiplier x timeLagNoteTicks.</p>
<p>See <a href="#object-time-lag">Object Time Lag</a> for a more information on time lagging.</p>
<h5 id="settimelagnoteticks">setTimeLagNoteTicks</h5>
<pre><code>setTimeLagNoteTicks(id, ticks);</code></pre>
<p>Set the length of the note in ticks in which time lag is stated. Note that unlike in the property inspector the scripting command requires the time lag to be set in ticks where a quarter note is 96 ticks. You can easily compute the number of ticks for standard note lengths. The advantage of being able to use ticks here is that you can use any number, not just standard note lengths. For example although a quarter note is 96 ticks you could specify 97 ticks for the interval, or anything else, allowing unusual non rhythmic shifting of note times, and message times in general.</p>
<p>See <a href="#object-time-lag">Object Time Lag</a> for a more information on time lagging.</p>
<p>Autocomplete in the editor includes definitons for many note intervals. e.g. noteQtr. Start typing “note” and a list of notes will pop up.</p>
<p>Example to set the timeLagNoteTicks of object 45 to an quarter note trill, use:</p>
<p>setTimeLagNoteTicks(45,noteQtrTrill);</p>
<h5 id="settonic">setTonic</h5>
<pre><code>setTonic(id,tonic);</code></pre>
<p>Set the tonic note number (0…11) for either the score or an object with given id. Omit the id to refer to the score.</p>
<h5 id="settriggersize">setTriggerSize</h5>
<pre><code>setTriggerSize(triggerId, size);</code></pre>
<p>Set the size of a existing trigger.</p>
<h5 id="settriggersync">setTriggerSync</h5>
<pre><code>setTriggerSync(id, duration)</code></pre>
<p>Set the trigger sync note duration in ticks (A quarter note is 96 ticks). If triggerSync is off, a triggers creates a message instantly when a cursor collides with it. If triggerSync is set to a note type, the triggering of the trigger is delayed until the next even multiple of that interval.</p>
<p>This example sets trigger 33 to delay triggering to align with quarter note oundaries with respect to the master beat:</p>
<pre><code>setTriggerSync(33, 96); </code></pre>
<p>This example sets trigger 37 to delay triggering to align with sixteenth note boundaries with respect to the master beat:</p>
<pre><code>setTriggerSync(37, 24);  //i.e. 4*24=96 and there are 4 sixtenth notes in a qurter note</code></pre>
<p>See “Trigger Sync Example 2.score” and “Varying Intervals for AutoMessage Improvisation.score” for examples of using trigger sync.</p>
<p>Autocomplete in the editor includes definitons for many note intervals. e.g. noteQtr. Start typing “note” and a list of notes will pop up.</p>
<p>Example to set the triggerSync of trigger 45 to an quarter note trill, use:</p>
<pre><code>setTriggerSync(45,noteQtrTrill); </code></pre>
<h5 id="zoom">zoom</h5>
<pre><code>zoom(magnification);</code></pre>
<p>Set the magnification factor for the view. Zoom should be in the range 1.0 to 2000.0. 100 is normal size. Use zoom() without any parameter.</p>
<h3 id="math-functions">Math Functions</h3>
<h5 id="abs">abs</h5>
<pre><code>abs(x);  //Absolute value of x.</code></pre>
<h5 id="acos">acos</h5>
<pre><code>acos(x);  //Arccos of x</code></pre>
<h5 id="asin">asin</h5>
<pre><code>asin(x);  //Arcsin of x</code></pre>
<h5 id="atan">atan</h5>
<pre><code>atan(x);  //Arctan of x</code></pre>
<h5 id="atan2">atan2</h5>
<pre><code>atan2(x,y);  //Arctan function with two arguments</code></pre>
<h5 id="ceil">ceil</h5>
<pre><code>ceil(x);  //Smallest integer greater than or equal x</code></pre>
<h5 id="cos">cos</h5>
<pre><code>cos(x);  //Cosine of x</code></pre>
<h5 id="exp">exp</h5>
<pre><code>exp(x);  //E to the power x</code></pre>
<h5 id="floor">floor</h5>
<pre><code>floor(x);  //Largest integer less than or equal to x</code></pre>
<h5 id="log">log</h5>
<pre><code>log(x);  //Natural logarithm of x</code></pre>
<h5 id="min">min</h5>
<pre><code>min(x,y);  //Minimum of x or y</code></pre>
<h5 id="max">max</h5>
<pre><code>max(x,y);  //Maximum of x or y</code></pre>
<h5 id="pow">pow</h5>
<pre><code>pow(x,y);  //x to the power y</code></pre>
<h5 id="radians">radians</h5>
<pre><code>radians(degrees);  //Convert an angle in degrees to radians</code></pre>
<h5 id="round">round</h5>
<pre><code>round(x);  //x rounded to the nearest integer</code></pre>
<h5 id="sin">sin</h5>
<pre><code>sin(x);  //Sine of x</code></pre>
<h5 id="sqrt">sqrt</h5>
<pre><code>sqrt(x);  //Square root of x</code></pre>
<h5 id="sq">sq</h5>
<pre><code>sq(x);  //x squared</code></pre>
<h5 id="tan">tan</h5>
<pre><code>tan(x);  //Tangent of x</code></pre>
<h5 id="degrees">degrees</h5>
<pre><code>degrees(radians)  //Convert an angle in radians to degrees</code></pre>
<h2 id="object-properties-and-methods">Object Properties and Methods</h2>
<p>These are the properties and methods that can be accessed in scripts using the “.” operator. Many of these can also be set using one of the set… commands documented above, but accessing them as properties is sometimes more convenient. It also allows the current value of properties to be read, which is not possible with the setter functions. There are also many properties that are read-only that are very useful for mapping to musical actions (note numbers, cc values, etc.) in message functions.</p>
<p>Each property includes, first the type of data that it refers to in the c++ code, then the property name, and then whether it can be just READ or can be READ and WRITTEN.</p>
<p>More documentation on these will be added in the future. For now, you can see examples of how to use some of them in the sample scores.</p>
<p>The methods are functions callable on an instance of an object to get it to carry out some action. For example this causes object number 99 to send its message an though it had been triggered. This can be done even outside of a message function. It could even be executed as a single line of code in the editor with the Command+. keyboard shortcut.</p>
<pre><code>_obj(99).sendMessage();</code></pre>
<p>Similarly this line could cause an object to send its automessage function:</p>
<pre><code>_obj(99).sendAutoMessage();</code></pre>
<p>These can be useful for testing and other special purposes.</p>
<h4 id="properties-shared-by-triggers-curves-and-cursors">Properties Shared by Triggers, Curves and Cursors</h4>
<ul>
<li>bool <strong>selected</strong> (READ,WRITE)</li>
<li>quint16 <strong>id</strong> (READ,WRITE)</li>
<li>QString <strong>groupId</strong> (READ,WRITE)</li>
<li>QString <strong>documentId</strong> (READ,WRITE)</li>
<li>QString <strong>label</strong> (READ,WRITE)</li>
<li>QStringList <strong>autoLabel</strong> (READ,WRITE)</li>
<li>QString <strong>posStr</strong> (READ,WRITE)</li>
<li>qreal <strong>x</strong> (READ,WRITE) //Object x position</li>
<li>qreal <strong>y</strong> (READ,WRITE) //Object y position</li>
<li>qreal <strong>z</strong> (READ,WRITE) //Object z position</li>
<li>qreal <strong>x01</strong> (READ) //Object x position scaled in proportion to the background width</li>
<li>qreal <strong>y01</strong> (READ) //Object y position scaled in proportion to the background width</li>
<li>QColor <strong>pix</strong> (READ) //Color of backround pixel</li>
<li>qreal <strong>r</strong> (READ)</li>
<li>qreal <strong>g</strong> (READ)</li>
<li>qreal <strong>b</strong> (READ)</li>
<li>qreal <strong>a</strong> (READ)</li>
<li>qreal <strong>h</strong> (READ)</li>
<li>qreal <strong>s</strong> (READ)</li>
<li>qreal <strong>v</strong> (READ)</li>
<li>quint16 <strong>lineFactor</strong> (READ,WRITE)</li>
<li>quint16 <strong>lineStipple</strong> (READ,WRITE)</li>
<li>bool <strong>active</strong> (READ,WRITE)</li>
<li>bool <strong>hidden</strong> (READ,WRITE)</li>
<li>QString <strong>colorActive</strong> (READ,WRITE)</li>
<li>QString <strong>colorInactive</strong> (READ,WRITE)</li>
<li>QString <strong>colorActiveHue</strong> (READ,WRITE)</li>
<li>QString <strong>colorInactiveHue</strong> (READ,WRITE)</li>
<li>qreal <strong>messageIntervalMs</strong> (READ,WRITE)</li>
<li>qreal <strong>messageIntervalTicks</strong> (READ,WRITE)</li>
<li>QString <strong>beatEmphasisStr</strong> (READ,WRITE)</li>
<li>bool <strong>firstMessage</strong> (READ,WRITE)</li>
<li>bool <strong>repeatMessage</strong> (READ)</li>
<li>qreal <strong>beat</strong> (READ)</li>
<li>QString <strong>type</strong> (READ)</li>
<li>QString <strong>autoMsgFunction</strong> (READ,WRITE)</li>
<li>QString <strong>msgFunction</strong> (READ,WRITE)</li>
<li>qreal <strong>timeLagMultiplier</strong> (READ,WRITE)</li>
<li>qreal <strong>timeLagUnit</strong> (READ,WRITE)</li>
<li>QString <strong>port</strong> (READ,WRITE)</li>
<li>int <strong>channel</strong> (READ,WRITE)</li>
<li>int <strong>controller</strong> (READ,WRITE)</li>
<li>int <strong>note</strong> (READ,WRITE)</li>
</ul>
<p>These object properties implement inheritance from the score. This means that if an object property is set to “Score”, the following properties will not return “Score”, but instead will return the value of that property for the score.</p>
<ul>
<li>int <strong>tonic</strong> (READ) Returns the object tonic</li>
<li>QString <strong>scale</strong> (READ) Returns the object scale</li>
<li>int <strong>root</strong> (READ) Returns the object root</li>
<li>QString <strong>chord</strong> (READ) Returns the object chord</li>
<li>int <strong>rangeLow</strong> (READ) Returns the object’s lowest notes for mapping</li>
<li>int <strong>range</strong> (READ) Returns the size of the range for mapping, in semitones</li>
<li>QString mapNotesTo (READ) Indicates whether note mapping for this object is to the “Chord”, the “Scale”.</li>
<li>QList<int> <strong>chordNotes</strong> (READ) List of notes in this object’s chord</li>
<li>QList<int> <strong>scaleNotes</strong> (READ) List of notes in this object’s scale</li>
<li>QList<int> <strong>notes</strong> (READ) List of notes generated by this object. The notes could be based on the chord or the scale setting, depending on the “mapNotesTo” property.</li>
</ul>
<p>These properties set and get the actual object property values. This means they can set the a property to “Score” which would restore inheritence from the score.</p>
<ul>
<li>int <strong>objectTonic</strong> (READ,WRITE) Sets the object tonic (set to -1 to use the score tonic)</li>
<li>QString <strong>objectScale</strong> (READ,WRITE) Sets the object scale (set to “Score” to use the score scale)</li>
<li>int <strong>objectRoot</strong> (READ,WRITE) Sets the object root (set to -1 to use the score root)</li>
<li>QString <strong>objectChord</strong> (READ,WRITE) Sets the object chord (set to “Score” to use the score chord)</li>
<li>int <strong>objectRangeLow</strong> (READ,WRITE) Sets the object’s lowest notes for mapping (set to -1 to use the score value)</li>
<li>int <strong>objectRange</strong> (READ,WRITE) Sets the size of the range for mapping, in semitones (set to -1 to use the score valse)</li>
<li>QString <strong>objectMapNotesTo</strong> (READ) Sets object note mapping to be to the “Chord”, the “Scale” or to use the same setting as the “Score”.</li>
</ul>
<h4 id="methods-shared-by-triggers-curves-and-cursors">Methods Shared by Triggers, Curves and Cursors</h4>
<ul>
<li>void <strong>sendMessage()</strong> //Trigger the message function of this object</li>
<li>void <strong>sendAutoMessage()</strong> //Trigger the automessage function of this object</li>
</ul>
<h4 id="properties-of-trigger-objects">Properties of Trigger Objects</h4>
<ul>
<li>qreal <strong>triggerSize</strong> (READ,WRITE)</li>
<li>QString <strong>textureActive</strong> (READ,WRITE)</li>
<li>QString <strong>textureInactive</strong> (READ,WRITE)</li>
<li>QString <strong>textureActiveCurve</strong> (READ,WRITE)</li>
<li>QString <strong>textureInactiveCurve</strong> (READ,WRITE)</li>
<li>qreal <strong>triggerDistance</strong> (READ)</li>
<li>qreal <strong>beat</strong> (READ)</li>
<li>QScriptValue <strong>cursor</strong> (READ)</li>
<li>QScriptValue <strong>snapCurve</strong> (READ)</li>
<li>qint32 <strong>snapPoint</strong> (READ)</li>
<li>qreal <strong>triggerSync</strong> (READ, WRITE) Sets the triggerSync note size in ticks (96 ticks = quarter note). Off = -1.</li>
</ul>
<h4 id="properties-curve-objects">Properties Curve Objects</h4>
<ul>
<li>qreal <strong>pathLength</strong> (READ)</li>
<li>CurveType <strong>curveType</strong> (READ)</li>
<li>int <strong>nPoints</strong> (READ)</li>
<li>QString <strong>resizeStr</strong> (READ,WRITE)</li>
<li>qreal <strong>resizeF</strong> (READ,WRITE)</li>
<li>qreal <strong>beat</strong> (READ)</li>
<li>QString <strong>beatPattern</strong> (READ,WRITE)</li>
<li>qreal <strong>beatInterval</strong> (READ,WRITE)</li>
<li>QString <strong>activeBeats</strong> (READ,WRITE)</li>
<li>QScriptValue <strong>cursor</strong> (READ,WRITE)</li>
<li>qreal <strong>height</strong> (READ,WRITE)</li>
<li>qreal <strong>width</strong> (READ,WRITE)</li>
<li>qreal <strong>beatNumber</strong> (READ,WRITE) Returns the value of variable ‘beat’</li>
<li>QString <strong>beatPatternType</strong> (READ,WRITE)</li>
<li>int <strong>nBeats</strong> (READ,WRITE)</li>
<li>int <strong>nActiveBeats</strong> (READ,WRITE)</li>
<li>int <strong>beatShift</strong> (READ,WRITE)</li>
<li>int <strong>nRepeats</strong> (READ,WRITE)</li>
</ul>
<h4 id="methods-of-curve-objects">Methods of Curve Objects</h4>
<ul>
<li>int <strong>addPoint</strong>(int index, qreal x, qreal y, qreal z, bool smooth=false);</li>
<li>int <strong>addPoint</strong>(qreal x, qreal y, qreal z, bool smooth=false);</li>
<li>inline QScriptValue <strong>getCursor</strong>(int index)</li>
</ul>
<h4 id="properties-of-cursor-objects">Properties of Cursor Objects</h4>
<ul>
<li>QString <strong>repeatPattern</strong> R(READ,WRITE)</li>
<li>qreal <strong>duration</strong> (READ,WRITE)</li>
<li>qreal <strong>speedMultiplier</strong> (READ,WRITE)</li>
<li>qreal <strong>speedMultiplierRT</strong> (READ,WRITE)</li>
<li>qreal <strong>cursorWidth1</strong> (READ,WRITE)</li>
<li>qreal <strong>cursorWidth2</strong> (READ,WRITE)</li>
<li>qreal <strong>cursorHeight</strong> (READ,WRITE)</li>
<li>quint16 <strong>nbLoop</strong> (READ)</li>
<li>qreal <strong>cycles</strong> (READ,WRITE)</li>
<li>qreal <strong>timeLocal</strong> (READ,WRITE)</li>
<li>qreal <strong>x</strong> (READ,WRITE)</li>
<li>qreal <strong>y</strong> (READ,WRITE)</li>
<li>qreal <strong>z</strong> (READ,WRITE)</li>
<li>qreal <strong>r</strong> (READ)</li>
<li>qreal <strong>g</strong> (READ)</li>
<li>qreal <strong>b</strong> (READ)</li>
<li>qreal <strong>a</strong> (READ)</li>
<li>qreal <strong>h</strong> (READ)</li>
<li>qreal <strong>s</strong> (READ)</li>
<li>qreal <strong>v</strong> (READ)</li>
<li>qreal <strong>xOffset</strong> (READ)</li>
<li>qreal <strong>yOffset</strong> (READ)</li>
<li>qreal <strong>zOffset</strong> (READ)</li>
<li>qreal <strong>xVelocity</strong> (READ)</li>
<li>qreal <strong>yVelocity</strong> (READ)</li>
<li>qreal <strong>zVelocity</strong> (READ)</li>
<li>qreal <strong>localTime</strong> (READ)</li>
<li>qreal <strong>localTime01</strong> (READ)</li>
<li>qreal <strong>angle</strong> (READ)</li>
<li>qreal <strong>beat</strong> (READ)</li>
<li>QScriptValue <strong>curve</strong> (READ)</li>
<li>QScriptValue <strong>trigger</strong> (READ)</li>
</ul>
<h4 id="properties-of-the-score">Properties of the Score</h4>
<p>These are accessed from the _score object that is automatically defined in each Javascript global context. A shortcut name called _s is also defined for the same object. For example you might print the score scale name like this:</p>
<pre><code>print(_score.scaleName);</code></pre>
<ul>
<li>int <strong>currentId</strong> (READ) The id number of the most recently accessed object.</li>
<li>int <strong>currentCurveId</strong> (READ) The id number of the most recently accessed curve.</li>
<li>QList<int> <strong>backgroundSize</strong> (READ) Backround image position and size as a four element array. [upperLeftX,upperLeftY,lowerRightX, lowerRightY] e.g. [-14,10,14,-10]</li>
<li>QString <strong>backgroundFile</strong> (READ) Background file complete path as a string.</li>
<li>qreal <strong>bpm</strong> (READ,WRITE) Score beats per minute.</li>
<li>bool <strong>playing</strong> (READ,WRITE) True if the transport is running.</li>
<li>QString <strong>timeSig</strong> (READ,WRITE) The time signature as a string. e.g. “4/4”</li>
<li>bool <strong>hasBackgroundImage</strong> (READ) True if the score has a non blank background image.</li>
<li>QString <strong>scoreName</strong> (READ) The name of the score file.</li>
<li>qreal <strong>scoreTime</strong> (READ) The elapsed time for the score in seconds.</li>
<li>int <strong>tonic</strong> (READ,WRITE) Score tonic as a note number from 0 … 11</li>
<li>QString <strong>scale</strong> (READ,WRITE) Score scale name as a string.</li>
<li>QString <strong>chord</strong> (READ,WRITE) Score chord name as a string.</li>
<li>QList<int> <strong>chordNotes</strong> (READ) Score scale notes as a Javascript array</li>
<li>QList<int> <strong>scaleNotes</strong> (READ) Score chord notes as a Javascript array</li>
<li>int <strong>root</strong> (READ,WRITE) Score chord root in scale scale step number</li>
<li>int <strong>rangeLow</strong> (READ,WRITE) Lowest note of mapping range as a note number.</li>
<li>int <strong>range</strong> (READ,WRITE) Size of mapping range in semitones.</li>
</ul>
<p>Harmony Properites of the Score:</p>
<ul>
<li>int <strong>tonic</strong> (READ,WRITE)</li>
<li>QString <strong>scale</strong> (READ,WRITE)</li>
<li>int <strong>root</strong> (READ,WRITE)</li>
<li>QString <strong>chord</strong> (READ,WRITE)</li>
<li>int <strong>rangeLow</strong> (READ,WRITE)</li>
<li>int <strong>range</strong> (READ,WRITE)</li>
<li>QString mapNotesTo (READ,WRITE) Set mapNotesTo to “Chord” or “Scale” to select mapping of notes into the current chord or scale.</li>
<li>QList<int> <strong>chordNotes</strong> (READ) Returns a list of notes in the score chord</li>
<li>QList<int> <strong>scaleNotes</strong> (READ) Returns a list of notes in the score scale</li>
<li>QList<int> <strong>notes</strong> (READ) List of notes generated by this object. The notes may be based on the chord or the scale. setting, depending on the “mapNotesTo” property.</li>
</ul>
<h4 id="methods-of-the-score">Methods of the Score</h4>
<p>Most of these have function style commands that do the same thing. It is not recommended that you use them, at least for now.</p>
<ul>
<li>QScriptValue <strong>obj</strong>(int id); Returns the object with given id. Used in implementing _obj.</li>
<li>QList<int> <strong>objectList</strong>(QString val); Returns a list of ids for object matching certain criteria.</li>
<li>int <strong>nextAvailableId</strong>(quint16 minimum); Returns the next unused id higher than a given minimum.</li>
<li>int <strong>addTrigger</strong>(int id); Adds a trigger.</li>
<li>int <strong>addTrigger</strong>(int id, qreal x, qreal y, qreal z); Adds a trigger at a position.</li>
<li>int <strong>addCurve</strong>(int id); Adds a curve.</li>
<li>int <strong>addCursor</strong>(int id); Adds a cursor.</li>
<li>int <strong>addCursor</strong>(int id, int curveId); Adds a cursor and attaches it to a curve.</li>
<li>int <strong>ellipse</strong>(int id, qreal w, qreal h, qreal x, qreal y, qreal z=0, bool addCursor = true); Adds an ellipse.</li>
<li>int <strong>del</strong>(int id); Deletes an object.</li>
<li>void <strong>delList</strong>(QList<int>); Deletes a list of objects.</li>
<li>QString <strong>background</strong>(QString filePath, int xTopLeft, int yTopLeft, int xBottomRight, int yBottomRight); Loads an image file as a background image.</li>
<li>QString <strong>registerImage</strong>(QString filePath, QString name);</li>
<li>qreal <strong>zoom</strong>(qreal amount = 100);</li>
<li>qreal <strong>rotate</strong>();</li>
<li>qreal <strong>rotate</strong>(qreal zAngle);</li>
<li>qreal <strong>rotate</strong>(qreal zAngle, qreal xAngle, qreal yAngle);</li>
<li>void <strong>origin</strong>(qreal x, qreal y, qreal z=0);</li>
<li>void <strong>center</strong>(qreal x, qreal y);</li>
<li>void <strong>center</strong>();</li>
<li>qreal <strong>play</strong>(qreal speed);</li>
<li>qreal <strong>play</strong>();</li>
<li>qreal <strong>stop</strong>();</li>
<li>qreal <strong>rewind</strong>();</li>
<li>QList<int> <strong>select</strong>(QString filter);</li>
<li>QVariant <strong>print</strong>(QVariant arg1, QVariant arg2=“”, QVariant arg3=“”, QVariant arg4=“”, QVariant arg5=“”, QVariant arg6=“”, QVariant arg7=“”, QVariant arg8=“”);</li>
<li>QVariant <strong>p</strong>(QVariant arg1, QVariant arg2=“”, QVariant arg3=“”, QVariant arg4=“”, QVariant arg5=“”, QVariant arg6=“”, QVariant arg7=“”, QVariant arg8=“”);</li>
<li>void clearScore();</li>
<li>QString <strong>pop</strong>(QString name); Pust</li>
<li>void <strong>pop</strong>();</li>
<li>QString <strong>push</strong>(QString name);</li>
<li>void <strong>push</strong>();</li>
<li>qreal <strong>speed</strong>(qreal speed);</li>
<li>qreal <strong>speed</strong>();</li>
</ul>
<h2 id="licenses-and-copyrights">Licenses and Copyrights</h2>
<h3 id="geosonix-license">Geosonix License</h3>
<p>Copyright (C) 2015,2016 Christopher Graham (chrisgr99@Geosonix.com)</p>
<pre><code>This file is part of Geosonix.

Geosonix is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License version 3
as published by the Free Software Foundation, or (at your option)
any later version.

You should have received a copy of the GNU General Public License
along with Geosonix.  If not, see http://www.gnu.org/licenses/.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF
CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</code></pre>
<h3 id="iannix">IanniX</h3>
<pre><code>Geosonix is a fork from the open source project, IanniX:
http://www.iannix.org/
The IanniX web site states &quot;IanniX is licensed under GPL 3, free and
cross-platform.</code></pre>
<h3 id="qscintilla-license">QScintilla License</h3>
<pre><code>The Geosonix script editor is based on the QScintilla library

License for Scintilla and SciTE

Copyright 1998-2003 by Neil Hodgson &lt;neilh@scintilla.org&gt;

All Rights Reserved 

Permission to use, copy, modify, and distribute this software and its 
documentation for any purpose and without fee is hereby granted, 
provided that the above copyright notice appear in all copies and that 
both that copyright notice and this permission notice appear in 
supporting documentation. 

NEIL HODGSON DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS 
SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY 
AND FITNESS, IN NO EVENT SHALL NEIL HODGSON BE LIABLE FOR ANY 
SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES 
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, 
WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER 
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE 
OR PERFORMANCE OF THIS SOFTWARE. </code></pre>
<h3 id="rtmidi-license">RtMidi License</h3>
<pre><code>Geosonix MIDI Communication is based on the RtMidi library.

RtMidi: realtime MIDI i/o C++ classes&lt;BR&gt;
Copyright (c) 2003-2016 Gary P. Scavone

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation files
(the &quot;Software&quot;), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software,
and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

Any person wishing to distribute modifications to the Software is
asked to send the modifications to the original developer so that
they can be incorporated into the canonical version.  This is,
however, not a binding provision of this license.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF
CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</code></pre>
<div id="footer">
  &copy; 2016 <a href="http://geosonix.com/">Christopher Graham</a>
</div>
</body>
</html>
